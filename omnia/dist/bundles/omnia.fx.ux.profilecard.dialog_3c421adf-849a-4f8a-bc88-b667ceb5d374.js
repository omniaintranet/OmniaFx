if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["3c421adf-849a-4f8a-bc88-b667ceb5d374"])throw new Error("Error, already loaded manifest 3c421adf-849a-4f8a-bc88-b667ceb5d374 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["3c421adf-849a-4f8a-bc88-b667ceb5d374"]=function(){(()=>{var e={"./client/fx/ux/profilecard/profilecarddialog.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProfileCardDialogComponent:()=>v});var s,o=r("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","3c421adf-849a-4f8a-bc88-b667ceb5d374"),i=r("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","3c421adf-849a-4f8a-bc88-b667ceb5d374"),a=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=r("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),l=r("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),d=(r("./client/tooling/vue/tasks/materials/dummy-vue-tsx-support-enable-check.js"),r("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"));(s||(s={})).namespace="Omnia.Ux.Profilecard";r("./client/fx/ux/profilecard/profilecard.css.js");var c=r("5e618f4d-d014-414e-a681-89e34cbeda0f"),b=r("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),h=r("eebfcd2f-b987-4725-8165-2955befcf8e1"),m=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),p=Object.defineProperty,u=Object.getOwnPropertyDescriptor,f=(e,t,r,s)=>{for(var o,i=s>1?void 0:s?u(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s?o(t,r,i):o(i))||i);return s&&i&&p(t,r,i),i};let v=class extends i.VueComponentBase{constructor(){super(...arguments),this.profilecardStyles=i.StyleFlow.use(i.ProfilecardStyles),this.currentUser=null,this.isReady=!1,this.showDialog=!0,this.userInformation=null,this.omniaCtxUserUid=null,this.editPersonProfileHandler=null,this.editUserProfileElement=null,this.enableTeamsPresence=!1,this.loadingUsersPresence=!0,this.dialogRenderer=null,this.tabs=[],this.activeTab=0,this.orgTreeSettings=null,this.showMySubscription={show:!1}}created(){this.enableTeamsPresence=this.featureStore.getters.isAllFeaturesActivated([a.Constants.featureIds.showTeamsPresence]);const e=this.removeClaim(this.userName);this.userInformation=null,this.profileCardStore.actions.loadUser.dispatch(e).then((e=>{if(this.currentUser=e,this.enableTeamsPresence&&this.currentUser){this.userStore.getters.resolvedPresenceUser(this.currentUser.id)?this.loadingUsersPresence=!1:this.userStore.actions.ensureUsersPresence.dispatch([this.currentUser.id]).then((()=>{this.loadingUsersPresence=!1}))}const t=o.Utils.isOnPrem(this.omniaCtx.environment.backendRuntime)?e.accountName:e.userPrincipalName;this.orgTreeSettings?this.orgTreeSettings.userLoginName=t:this.orgTreeSettings={startFromCurrentUser:!1,userLoginName:t,linkToProfilecard:!1},this.initUserInformationByCurrentUser(),this.isReady=!0})),this.omniaCtx.user.then((e=>{this.omniaCtxUserUid=e.uid})),o.Extend.fx.ux.userProfile.actionHandlerRegistration.then((e=>{if(e){let t=null;e.getAllEditUserProfileHandlerRegistrations().forEach((e=>{null===t?(this.editPersonProfileHandler=e,t=0):e.weight&&e.weight>t&&(this.editPersonProfileHandler=e,t=e.weight)}))}})),o.Extend.fx.ux.mySubscription.provider.then((e=>{e.getRendererCallback().then((e=>{this.serviceContainerContext.createInstance(e).render(((e,t)=>{this.dialogRenderer=(0,l.h)(e,{domProps:Object.assign({},t)})}),this.showMySubscription)}))}))}beforeDestroy(){}mounted(){o.WebComponentBootstrapper.registerElementInstance(this,this.$el)}initUserInformationByCurrentUser(){this.profileCardStore.actions.loadUserProperties.dispatch(this.currentUser.userPrincipalName).then((e=>{this.userInformation=e}))}onNewUserHandler(e){this.currentUser=e.currentUser,this.initUserInformationByCurrentUser()}onCloseDialog(){this.currentUser=null,this.showDialog=!1,this.isReady=!1,this.removeElementAfterClosing&&this.$el.parentElement?.remove()}removeClaim(e){let t=e;const r=e.split("|");return r.length>1&&(t=r[r.length-1]),t}getPicture(){let e="";return e=o.Utils.isOnPrem(this.omniaCtx.environment.backendRuntime)?this.currentUser.accountName:this.currentUser.id,`${this.azureAdService.getUserAvatarSrc(e)}&size=120x120`}handleSendMessageToUser(){this.userInformation&&(h.MicrosoftTeamsSdkLoader.runningInMicrosoftTeams()?h.MicrosoftTeamsSdkLoader.getApi().then((e=>{e.initialize(),e.executeDeepLink(a.Constants.microsoftTeamsDeepLinkApi.chatBaseUrl+encodeURIComponent(this.userInformation.userName))})):window.location.href="sip:"+(this.userInformation.sipAddress||this.userInformation.workEmail))}renderUserPresence(e){const t=this.userStore.getters.resolvedPresenceUser(e);if(!t)return null;const r=this.userStore.getUserPresenceIconName(t.availability,t.activity),s=this.userStore.getUserPresenceIconColor(t.availability,t.activity),o=this.userStore.getUserPresenceStatusName(t.activity);return(0,l.h)("div",{class:this.profilecardStyles.largeBadge},[(0,l.h)("v-badge",{attrs:{avatar:!0,title:o,bordered:!0,bottom:!0,overlap:!0,color:s,icon:r,"offset-x":"25","offset-y":"0"}},[(0,l.h)("v-avatar")])])}renderMySubscriptions(){return this.showMySubscription?this.dialogRenderer:null}render(){return this.userName&&this.currentUser&&this.showDialog?(0,l.h)("div",[(0,l.h)("v-dialog",{attrs:{value:this.showDialog,width:900,scrollable:!0,fullscreen:this.breakpoint.xsOnly},on:{input:e=>{this.showDialog=e,e||this.onCloseDialog()}}},[this.renderCardMarkup()]),this.showMySubscription.show&&this.renderMySubscriptions()]):null}renderEditUserPropertyButton(){let e=null;return e=!this.editPersonProfileHandler||this.omniaCtx.tenant.propertyBag.getModel(a.TenantPeopleInformation)&&!1===this.omniaCtx.tenant.propertyBag.getModel(a.TenantPeopleInformation).enableEditUserProfile?null:(0,l.h)("omfx-button",{attrs:{disabled:!this.userInformation,text:this.locService.transform(this.editPersonProfileHandler.title),contentClass:this.profilecardStyles.messageBtn},domProps:{onClick:()=>{const e=this.getElementNameByManifestId(this.editPersonProfileHandler.handlerManifestId);e&&(this.editUserProfileElement=(0,l.h)(e,{domProps:{onCompleted:()=>{this.editUserProfileElement=null}}}))},mode:a.ButtonModes.flat,icon:{iconType:this.editPersonProfileHandler.icon?this.editPersonProfileHandler.icon:new a.FontAwesomeIcon("fal fa-user"),small:!0}}}),e}ensureMatchUidWithUserPrincipalName(){let e=!0;return(o.Utils.isNullOrEmpty(this.currentUser.userPrincipalName)||o.Utils.isNullOrEmpty(this.omniaCtxUserUid))&&(e=!1),this.currentUser.userPrincipalName.toLocaleLowerCase()!=this.omniaCtxUserUid.toLocaleLowerCase()&&(e=!1),e}renderCardMarkup(){this.tabs=this.profileCardStore.getters.getProfileCardDialogTabs();const e=this.ensureMatchUidWithUserPrincipalName();return(0,l.h)("v-card",{class:"v-application",attrs:{"data-omfx":!0}},[this.isReady&&(0,l.h)("v-card-title",[(0,l.h)("div",{class:[this.profilecardStyles.dialogTitle,"d-flex flex-wrap"]},[(0,l.h)("v-avatar",{attrs:{size:100}},[(0,l.h)("v-img",{attrs:{width:"100px",height:"100px",tabindex:0,src:this.getPicture()}})]),this.enableTeamsPresence&&this.currentUser&&!this.loadingUsersPresence?this.renderUserPresence(this.currentUser.id):null,(0,l.h)("div",[(0,l.h)("v-list-tile",{attrs:{"two-line":!0}},[(0,l.h)("v-list-tile-content",{class:this.profilecardStyles.header},[(0,l.h)("span",{class:this.profilecardStyles.name},[this.currentUser.displayName]),(0,l.h)("span",{class:[this.profilecardStyles.details]},[this.currentUser.jobTitle," ",this.currentUser.jobTitle&&this.currentUser.department?"-":null," ",this.currentUser.department])])]),(0,l.h)("div",{class:"d-flex ml-1 flex-wrap"},[e?this.renderEditUserPropertyButton():[(0,l.h)("omfx-button",{attrs:{disabled:!this.userInformation||!this.userInformation.workEmail,text:this.loc.sendEmail,contentClass:this.profilecardStyles.messageBtn},domProps:{onClick:()=>{window.location.href="mailto:"+this.userInformation.workEmail},mode:a.ButtonModes.flat,icon:{iconType:new a.FabricIcon("ms-Icon ms-Icon--Mail"),small:!0}}}),(0,l.h)("omfx-button",{attrs:{disabled:!this.userInformation,text:this.loc.startChat,contentClass:this.profilecardStyles.messageBtn},domProps:{onClick:()=>{this.handleSendMessageToUser()},mode:a.ButtonModes.flat,icon:{iconType:new a.FabricIcon("ms-Icon ms-Icon--Chat"),small:!0}}})],this.omniaCtx.tenant.propertyBag.getModel(a.TenantPeopleInformation)&&this.omniaCtx.tenant.propertyBag.getModel(a.TenantPeopleInformation).showLinkToDelve?(0,l.h)("omfx-button",{attrs:{disabled:!this.currentUser,text:this.loc.goToDelve,contentClass:this.profilecardStyles.messageBtn},domProps:{onClick:()=>{const e=o.Utils.isOnline(this.omniaCtx.environment.backendRuntime)?this.currentUser.id:this.currentUser.accountName,t=o.Utils.getProfileUrl(e);window.open(t,"_blank")},mode:a.ButtonModes.flat,icon:{iconType:o.Utils.isOnline(this.omniaCtx.environment.backendRuntime)?new a.FabricIcon("ms-Icon ms-Icon--DelveLogo"):new a.FabricIcon("ms-Icon ms-Icon--ContactLink"),small:!0}}}):null,this.omniaCtx.tenant.propertyBag.getModel(a.TenantPeopleInformation)&&this.omniaCtx.tenant.propertyBag.getModel(a.TenantPeopleInformation).showMySubscriptions?(0,l.h)("omfx-button",{attrs:{disabled:!this.currentUser,text:this.loc.mySubscriptions,contentClass:this.profilecardStyles.messageBtn},domProps:{onClick:()=>{this.showMySubscription.show=!0},mode:a.ButtonModes.flat,icon:{iconType:new a.FontAwesomeIcon("fal fa-bell"),small:!0}}}):null])]),(0,l.h)("v-tabs",{attrs:{color:"primary"},on:{change:e=>{this.$set(this,"activeTab",e)}},class:this.profilecardStyles.tabsWrapper,model:{value:this.activeTab,callback:e=>{this.activeTab=e}}},[this.tabs.map(((e,t)=>(0,l.h)("v-tab",{class:this.profilecardStyles.tab,key:t},[e])))]),(0,l.h)("div",{class:this.profilecardStyles.dialogCloseBtn},[(0,l.h)("v-btn",{attrs:{"aria-label":this.loc.closeText,icon:!0},on:{click:this.onCloseDialog}},[(0,l.h)("v-icon",{attrs:{size:"16"}},["fas fa-times"])])])])]),(0,l.h)("v-card-text",[this.isReady?(0,l.h)("v-tabs-items",{attrs:{value:this.activeTab},class:this.profilecardStyles.tabItemsWrapper},[(0,l.h)("v-tab-item",{attrs:{value:0}},[(0,l.h)("omfx-aboutuser",{attrs:{userName:this.currentUser.userPrincipalName}})]),(0,l.h)("v-tab-item",{attrs:{value:1}},[(0,l.h)("omfx-organizationtree",{domProps:{valueBind:this.orgTreeSettings,onNewUserSelected:this.onNewUserHandler}})])]):(0,l.h)("v-skeleton-loader",{class:"mx-auto my-4",attrs:{type:"list-item-avatar-two-line, list-item-three-line"}}),this.editUserProfileElement]),(0,l.h)("v-card-actions",[(0,l.h)("v-spacer"),(0,l.h)("v-btn",{attrs:{light:!this.omniaTheming.promoted.body.dark,text:!0,"aria-label":this.loc.closeText,right:!0},on:{click:this.onCloseDialog}},[this.loc.closeText])])])}};f([(0,d.Prop)()],v.prototype,"userName",2),f([(0,d.Prop)()],v.prototype,"removeElementAfterClosing",2),f([(0,o.Inject)(i.OmniaTheming)],v.prototype,"omniaTheming",2),f([(0,o.Inject)(c.UserStore)],v.prototype,"userStore",2),f([(0,o.Inject)(c.FeatureStore)],v.prototype,"featureStore",2),f([(0,o.Inject)(c.ProfileCardStore)],v.prototype,"profileCardStore",2),f([(0,o.Inject)(o.OmniaContext)],v.prototype,"omniaCtx",2),f([(0,o.Inject)(b.AzureAdService)],v.prototype,"azureAdService",2),f([(0,o.Inject)(b.LocalizationService)],v.prototype,"locService",2),f([(0,o.Inject)(m.ServiceContainerContext)],v.prototype,"serviceContainerContext",2),f([(0,o.Localize)(s.namespace)],v.prototype,"loc",2),v=f([n.default],v),o.WebComponentBootstrapper.registerElement((e=>{(0,o.vueCustomElement)(e.elementName,v)}))},"./client/fx/ux/profilecard/profilecard.css.js":(e,t,r)=>{e.exports=r("dll-reference md44")("./client/fx/ux/profilecard/profilecard.css.js")},"./client/tooling/vue/tasks/materials/dummy-vue-tsx-support-enable-check.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./client/tooling/vue/tasks/materials/dummy-vue-tsx-support-enable-check.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,r)=>{e.exports=r("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,r)=>{e.exports=r("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,r)=>{e.exports=r("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,r)=>{e.exports=r("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,r)=>{e.exports=r("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,r)=>{e.exports=r("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"eebfcd2f-b987-4725-8165-2955befcf8e1":(e,t,r)=>{e.exports=r("dll-reference md13")("eebfcd2f-b987-4725-8165-2955befcf8e1")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md44":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["adc72d40-413d-4a19-9452-8270c27f794f"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]},"dll-reference md13":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["ee16aba9-229e-43f0-8559-d913b3aa85d4"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["3c421adf-849a-4f8a-bc88-b667ceb5d374"])throw new Error("Error, already loaded manifest 3c421adf-849a-4f8a-bc88-b667ceb5d374 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["3c421adf-849a-4f8a-bc88-b667ceb5d374"]=r;var t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};r("./client/fx/ux/profilecard/profilecarddialog.tsx")})()};