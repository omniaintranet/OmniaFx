if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["de36ccd3-a306-4b0e-a8f5-865e65521e41"])throw new Error("Error, already loaded manifest de36ccd3-a306-4b0e-a8f5-865e65521e41 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["de36ccd3-a306-4b0e-a8f5-865e65521e41"]=function(){(()=>{var e={"./client/fx/sp/ux/appwithspaliasinput/appwithsharepointaliasinput.tsx":(e,i,t)=>{"use strict";t.r(i),t.d(i,{AppWithSharePointAliasInput:()=>m});var a=t("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),s=t("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),o=t("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),n=t("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),l=t("eff19cad-5557-434b-a477-1e1e2a70a2a0"),r=t("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","de36ccd3-a306-4b0e-a8f5-865e65521e41"),d=t("97786ea9-4861-48bd-8a57-eae9bbdb4892"),p=t("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","de36ccd3-a306-4b0e-a8f5-865e65521e41"),b=t("./client/fx/sp/services/index.js"),c=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u=(e,i,t,a)=>{for(var s,o=a>1?void 0:a?h(i,t):i,n=e.length-1;n>=0;n--)(s=e[n])&&(o=(a?s(i,t,o):s(o))||o);return a&&o&&c(i,t,o),o};let m=class extends p.VueComponentBase{constructor(){super(...arguments),this.internalValues={prefix:"",suffix:"",value:""},this.isFocus=!1,this.validating=!1,this.pendingValidation=!1,this.isValid=!1,this.validationMessage="",this.isInputDirty=!1,this.timewatchId=d.Utils.generateGuid(),this.latestTimewatchState="",this.isRootRouteExist=!1,this.ready=!1,this.styles=p.StyleFlow.use(p.WizardStyles),this.internalUseOmniaRootRoute=!1}created(){this.parseInternalValue(this.alias),this.internalUseOmniaRootRoute=this.useOmniaRootRoute||!1,this.checkRootRouteAvailitity().then((()=>{this.ready=!0,this.validateAliasWithTimeWatch(0),this.subcribePolicyValidationStateChanged(),this.subscribeAppTitleChanged()}))}mounted(){r.WebComponentBootstrapper.registerElementInstance(this,this.$el),this.useValidator.register(this)}subcribePolicyValidationStateChanged(){this.appNamingPolicyValidationState.validationState&&this.subscriptionHandler.add(this.appNamingPolicyValidationState.onValidationStateChanged.subscribe((()=>{this.handleValidationStateChanged()})))}subscribeAppTitleChanged(){this.subscriptionHandler.add(d.Topics.onAppTitleChanged.subscribe((e=>{if(e?.title){const i=this.appNamingPolicyValidationState.validationState?this.appNamingPolicyValidationState.validationState.generateAliasByTitle(e.title):d.Utils.makeFriendlyUrl(e.title);this.parseInternalValue(i),this.validateAliasWithTimeWatch(0)}})))}checkRootRouteAvailitity(){return this.appRouteService.validateRoute({alias:"",routePrefix:"",ignoreFromAppId:this.ignoreFromAppId}).then((e=>{this.isRootRouteExist=e.isValid,this.isRootRouteExist||(this.internalUseOmniaRootRoute=!1)}))}handleValidationStateChanged(){this.parseInternalValue(this.internalValues.value),this.validateAliasWithTimeWatch()}getFullInternalAlias(){return this.internalValues.prefix+this.internalValues.value+this.internalValues.suffix}parseInternalValue(e){if(e=e?.replace(/\/$/,"")||"",this.appNamingPolicyValidationState.validationState){const i=this.appNamingPolicyValidationState.parseAlias(e);this.internalValues={prefix:i.prefix,suffix:i.suffix,value:i.value}}else this.internalValues.value=e}handleSiteAliasValidationResult(e){if(e.isInputAliasValid){const e=this.appNamingPolicyValidationState.getExistingBlockWord(this.internalValues.value);e?this.validationMessage=this.omniaUxLoc.Apps.NamingPolicies.BlockedWordMessage.replace("{0}",e):this.isValid=!0}else e.reservedAliasValidationResult?.isReserved?this.validationMessage=this.omniaUxLoc.Apps.Messages.SPAliasReserved:e.suggestedAlias?this.validationMessage=this.omniaUxLoc.Apps.Messages.SPAliasExists:this.validationMessage=this.omniaUxLoc.Apps.Messages.SPAliasInvalid}handleRouteValidationResult(e){if(e.isValid){const e=this.appNamingPolicyValidationState.getExistingBlockWord(this.internalValues.value);e?this.validationMessage=this.omniaUxLoc.Apps.NamingPolicies.BlockedWordMessage.replace("{0}",e):this.isValid=!0}else e.isReserved?this.validationMessage=this.omniaUxLoc.Apps.Messages.OmniaAliasReserved:e.isExist?this.validationMessage=this.omniaUxLoc.Apps.Messages.OmniaAliasExists:this.validationMessage=this.omniaUxLoc.Apps.Messages.OmniaAliasInvalid}updateUseRootRoute(e){this.internalUseOmniaRootRoute=e,this.onChanged(this.getFullInternalAlias(),this.internalUseOmniaRootRoute)}validateAlias(e){return new Promise(((i,t)=>{const a={alias:this.getFullInternalAlias(),reservedAliasValidationOption:this.ignoreFromAppId?{enable:!0,ignoreFromAppId:this.ignoreFromAppId}:null},s={alias:this.getFullInternalAlias(),ignoreFromAppId:this.ignoreFromAppId,routePrefix:this.omniaRoutePrefix};Promise.all([this.internalUseOmniaRootRoute?Promise.resolve(null):this.appRouteService.validateRoute(s),this.siteService.validateSiteAlias(a)]).then((([a,s])=>{!e||e()?(this.handleSiteAliasValidationResult(s),this.isValid&&a&&(this.isValid=!1,this.handleRouteValidationResult(a)),this.onChanged(this.getFullInternalAlias(),this.internalUseOmniaRootRoute),i()):t("validating a new state")}))}))}validateAliasWithTimeWatch(e=500){this.isValid=!1,this.validating=!1,this.pendingValidation=!1,this.validationMessage="";const i=d.Utils.generateGuid();this.latestTimewatchState=i;const t=this.getFullInternalAlias();t&&!1===/^[0-9a-zA-Z\-]+$/.test(t)?this.validationMessage=this.omniaUxLoc.Apps.IllegalCharacterMessage:t?(this.pendingValidation=!0,d.Utils.timewatch(this.timewatchId,(()=>{this.pendingValidation=!1,this.validating=!0,this.validateAlias((()=>this.latestTimewatchState===i)).then((()=>{this.validating=!1})).catch((()=>{}))}),e)):this.onChanged(t,this.internalUseOmniaRootRoute)}render(){if(!this.ready)return null;const e=this.pendingValidation||this.validating,i=this.internalValues.value&&this.isValid;let t=this.internalValues.prefix,s=this.internalValues.suffix,o=this.internalValues.value;return i&&!this.isFocus&&(o=t+o+s,t="",s=""),(0,a.h)("div",{class:this.styles.textFieldStyles},[this.isRootRouteExist&&(0,a.h)("v-checkbox",{attrs:{color:this.theming.colors.primary.base,label:this.omniaUxLoc.Apps.UseRootRoute,"input-value":this.internalUseOmniaRootRoute},on:{change:e=>{this.updateUseRootRoute(e)}}}),(0,a.h)("v-text-field",{attrs:{dark:this.dark,filled:!0,placeholder:" ",prefix:t,suffix:s,rules:(new p.FieldValueValidation).IsRequired().RegExMatch(/^[0-9a-zA-Z\-]+$/,this.omniaUxLoc.Apps.IllegalCharacterMessage).CustomFunction((()=>e||this.isValid),this.validationMessage).getRules(),error:this.isInputDirty&&!this.isValid&&!e,"error-messages":this.validationMessage,value:o,label:this.omniaUxLoc.Apps.Alias},on:{focus:()=>{this.isFocus=!0},blur:()=>{this.isFocus=!1},input:e=>{this.internalValues.value=e.toLowerCase(),this.isInputDirty=!0,this.validateAliasWithTimeWatch()}}},[i&&(0,a.h)("v-icon",{slot:"append",attrs:{small:!0,color:"green darken-2"},class:"mt-1"},["fa fa-check-circle"]),this.validating&&(0,a.h)("v-progress-circular",{class:"mt-1",slot:"append",attrs:{indeterminate:!0,size:"13",color:"primary"}})]),(0,a.h)("div",{class:"d-none"},[(0,a.h)("omfx-field-validation",{domProps:{useValidator:this.useValidator,checkValue:e,rules:(new p.FieldValueValidation).CustomFunction((()=>!e)," ").getRules()}})])])}};u([(0,n.Prop)()],m.prototype,"alias",2),u([(0,n.Prop)()],m.prototype,"useOmniaRootRoute",2),u([(0,n.Prop)()],m.prototype,"onChanged",2),u([(0,n.Prop)()],m.prototype,"omniaRoutePrefix",2),u([(0,n.Prop)()],m.prototype,"ignoreFromAppId",2),u([(0,n.Prop)()],m.prototype,"dark",2),u([(0,r.Localize)(p.OmniaUxLocalizationNamespace)],m.prototype,"omniaUxLoc",2),u([(0,d.Inject)(b.SiteService)],m.prototype,"siteService",2),u([(0,d.Inject)(l.AppNamingPolicyValidationState)],m.prototype,"appNamingPolicyValidationState",2),u([(0,d.Inject)(d.SubscriptionHandler)],m.prototype,"subscriptionHandler",2),u([(0,d.Inject)(s.AppRouteService)],m.prototype,"appRouteService",2),m=u([o.default],m),r.WebComponentBootstrapper.registerElement((e=>{(0,r.vueCustomElement)(e.elementName,m)}))},"./client/fx/sp/services/index.js":(e,i,t)=>{e.exports=t("dll-reference md20")("./client/fx/sp/services/index.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,i,t)=>{e.exports=t("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,i,t)=>{e.exports=t("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,i,t)=>{e.exports=t("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,i,t)=>{e.exports=t("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,i,t)=>{e.exports=t("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,i,t)=>{e.exports=t("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,i,t)=>{e.exports=t("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"eff19cad-5557-434b-a477-1e1e2a70a2a0":(e,i,t)=>{e.exports=t("dll-reference md20")("eff19cad-5557-434b-a477-1e1e2a70a2a0")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]},"dll-reference md20":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["de36ccd3-a306-4b0e-a8f5-865e65521e41"])throw new Error("Error, already loaded manifest de36ccd3-a306-4b0e-a8f5-865e65521e41 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["de36ccd3-a306-4b0e-a8f5-865e65521e41"]=t;var i={};function t(a){var s=i[a];if(void 0!==s)return s.exports;var o=i[a]={exports:{}};return e[a](o,o.exports,t),o.exports}t.d=(e,i)=>{for(var a in i)t.o(i,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:i[a]})},t.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};t("./client/fx/sp/ux/appwithspaliasinput/appwithsharepointaliasinput.tsx")})()};