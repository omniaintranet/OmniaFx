if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["fc7e7933-28e6-4088-ab1b-37b8f89e8693"])throw new Error("Error, already loaded manifest fc7e7933-28e6-4088-ab1b-37b8f89e8693 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["fc7e7933-28e6-4088-ab1b-37b8f89e8693"]=function(){(()=>{var e={"./client/fx/ux/mediapickerproviders/bingprovider/bingprovider.tsx":(e,t,i)=>{"use strict";i.r(t),i.d(t,{BingProviderComponent:()=>g});var s=i("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),o=i("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),a=i("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","fc7e7933-28e6-4088-ab1b-37b8f89e8693"),r=i("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),l=Object.defineProperty,n=Object.getOwnPropertyDescriptor,d=(e,t,i,s)=>{for(var o,a=s>1?void 0:s?n(t,i):t,r=e.length-1;r>=0;r--)(o=e[r])&&(a=(s?o(t,i,a):o(a))||a);return s&&a&&l(t,i,a),a};let b=class{constructor(){this.search=(e,t,i,s,o,a=0,r=20)=>new Promise(((l,n)=>{const d={q:e,offset:a,count:r,size:t,aspect:i,imageType:s,safeSearch:"Strict",license:"Public"};this.commonHttpClient.get("https://www.bingapis.com/api/v7/images/search?appid=D41D8CD98F00B204E9800998ECF8427E06193A4E",{params:d}).then((e=>{const t=e.data;if("Images"==t._type)if(t.totalEstimatedMatches>a){const e=this.getBingImages(t.value,o);l(e)}else l([]);else l([])}))}))}getBingImages(e,t){return e.map((e=>{const t=e.contentUrl,i=t.split("/").pop().split("."),s=(e.encodingFormat?e.encodingFormat:i[1].split("?").shift()).toLowerCase(),o=i[0]+"."+s;return{mediaType:r.MediaPickerEnums.OmniaMediaTypes.Image,imageUrl:t,encodingFormat:s,height:e.height,width:e.width,contentSize:parseInt(e.contentSize),thumbnailUrl:e.thumbnailUrl,fileName:o}}))}};d([(0,a.Inject)(a.HttpClient,{configPromise:a.HttpClient.createOmniaServiceRequestConfig()})],b.prototype,"httpClient",2),d([(0,a.Inject)(a.HttpClient)],b.prototype,"commonHttpClient",2),b=d([(0,a.Injectable)({lifetime:r.InstanceLifetimes.Transient})],b);var c=i("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","fc7e7933-28e6-4088-ab1b-37b8f89e8693"),h=i("1682f669-2a99-45e6-aa8b-7ed3d4e538d5"),m=Object.defineProperty,p=Object.getOwnPropertyDescriptor,u=(e,t,i,s)=>{for(var o,a=s>1?void 0:s?p(t,i):t,r=e.length-1;r>=0;r--)(o=e[r])&&(a=(s?o(t,i,a):o(a))||a);return s&&a&&m(t,i,a),a};let g=class extends h.GridViewMediaProviderComponent{constructor(){super(),this.scale="0",this.size="All",this.aspect="All",this.type="All",this.sizeFilters=[],this.aspectFilters=[],this.typeFilters=[],this.bingVideoResult=null,this.isGettingResults=!1,this.searchKeyword=null,this.onBeforeSavedResolvablePromise=null,this.gridViewSlots={mediaSelectionTop:this.renderBingImageFilter,mediaGridItemHover:this.renderImageDetail,customSlot:null}}beforeSaved(e){return this.onBeforeSavedResolvablePromise=new r.Future(null),e.mediaType==r.MediaPickerEnums.OmniaMediaTypes.Video?(this.providerSlots.bottom=this.renderSelectedBingVideoButtons,this.gridViewSlots.customSlot=this.renderSelectedBingVideo):this.onBeforeSavedResolvablePromise.resolve(e),this.onBeforeSavedResolvablePromise}getMediaItems(e){return this.searchKeyword=e,this.enableLoadMoreButton=!1,new Promise(((e,t)=>{this.searchKeyword?this.bingImageService.search(this.searchKeyword,this.size,this.aspect,this.type,150+parseInt(this.scale),0,300).then((t=>{this.enableLoadMoreButton=t&&t.length>0,e(t)})).catch(t):e([])}))}getMoreMediaItems(e){return new Promise(((e,t)=>{e(null)}))}getMediaInfo(e){return new Promise(((t,i)=>{if(e.mediaType==r.MediaPickerEnums.OmniaMediaTypes.Image)this.toggleLoadingUI(!0,r.MediaPickerEnums.LoadingStyle.overlay),this.webImageService.download(e.imageUrl).then((i=>{const s={mediaType:r.MediaPickerEnums.OmniaMediaTypes.Image,sizeInBytes:e.contentSize,base64:i,sourceUrl:e.imageUrl,fileName:e.fileName};t(s)})).catch((()=>{this.toggleLoadingUI(!1),i()}));else{const i={mediaType:r.MediaPickerEnums.OmniaMediaTypes.Video,videoUrl:e.videoUrl,thumbnailUrl:e.thumbnailUrl};t(i)}}))}created(){if(this.initData(),this.preSelectedMedia&&this.preSelectedMedia.omniaMediaType==r.MediaPickerEnums.OmniaMediaTypes.Video){this.bingVideoResult=this.preSelectedMedia;const e={mediaType:r.MediaPickerEnums.OmniaMediaTypes.Video,videoUrl:this.preSelectedMedia.videoUrl,thumbnailUrl:this.preSelectedMedia.thumbnailUrl};this.selectGridItem(e)}}mounted(){a.WebComponentBootstrapper.registerElementInstance(this,this.$el)}renderImageDetail(e){return(0,s.h)("div",{class:"subtitle-1 font-weight-light px-5 py-2"},[`${e.width} x ${e.height} `+c.MediaPickerImageHandler.convertByteToString(e.contentSize)])}initData(){this.sizeFilters=[{title:this.bingLoc.SizeFilter.Small,value:"Small"},{title:this.bingLoc.SizeFilter.Medium,value:"Medium"},{title:this.bingLoc.SizeFilter.Large,value:"Large"},{title:this.bingLoc.SizeFilter.Wallpaper,value:"Wallpaper"},{title:this.bingLoc.All,value:"All"}],this.aspectFilters=[{title:this.bingLoc.AspectFilter.Square,value:"Square"},{title:this.bingLoc.AspectFilter.Wide,value:"Wide"},{title:this.bingLoc.AspectFilter.Tall,value:"Tall"},{title:this.bingLoc.All,value:"All"}],this.typeFilters=[{title:this.bingLoc.TypeFilter.Clipart,value:"Clipart"},{title:this.bingLoc.TypeFilter.Line,value:"Line"},{title:this.bingLoc.TypeFilter.Photo,value:"Photo"},{title:this.bingLoc.All,value:"All"}]}onFilterResults(){this.isGettingResults=!0,this.toggleLoadingUI(!0,r.MediaPickerEnums.LoadingStyle.noOverlay),this.getMediaItems(this.searchKeyword).then((e=>{this.setAllItems(e),this.isGettingResults=!1,this.toggleLoadingUI(!1)})).catch((()=>{this.isGettingResults=!1,this.toggleLoadingUI(!1)}))}onChangeSizeFilter(e){this.size=e,this.searchKeyword&&this.onFilterResults()}onChangeAspectFilter(e){this.aspect=e,this.searchKeyword&&this.onFilterResults()}onChangeTypeFilter(e){this.type=e,this.searchKeyword&&this.onFilterResults()}renderBingImageFilter(){return(0,s.h)("v-row",[(0,s.h)("v-col",{attrs:{md:"4",sm:"12"}},[(0,s.h)("v-select",{attrs:{filled:!0,disabled:this.isGettingResults,label:this.bingLoc.SizeFilter.Title,"item-value":"value","item-text":"title",items:this.sizeFilters,"hide-details":!0},on:{change:this.onChangeSizeFilter},model:{value:this.size,callback:e=>{this.size=e}}})]),(0,s.h)("v-col",{attrs:{md:"4",sm:"12"}},[(0,s.h)("v-select",{attrs:{filled:!0,disabled:this.isGettingResults,label:this.bingLoc.AspectFilter.Title,"item-value":"value","item-text":"title",items:this.aspectFilters,"hide-details":!0},on:{change:this.onChangeAspectFilter},model:{value:this.aspect,callback:e=>{this.aspect=e}}})]),(0,s.h)("v-col",{attrs:{md:"4",sm:"12"}},[(0,s.h)("v-select",{attrs:{filled:!0,disabled:this.isGettingResults,label:this.bingLoc.TypeFilter.Title,"item-value":"value","item-text":"title",items:this.typeFilters,"hide-details":!0},on:{change:this.onChangeTypeFilter},model:{value:this.type,callback:e=>{this.type=e}}})])])}renderSelectedBingVideo(){return(0,s.h)("div",[(0,s.h)("h2",["Bing video settings"]),(0,s.h)("div",["Selected Video: ",this.bingVideoResult.videoUrl]),(0,s.h)("v-text-field",{attrs:{label:"Bing video custom property"},model:{value:this.bingVideoResult.bingCustomProperty,callback:e=>{this.$set(this.bingVideoResult,"bingCustomProperty",e)}}}),(0,s.h)("div",["Video HTML:"]),(0,s.h)("div",{domProps:{innerHTML:this.bingVideoResult.html}})])}renderSelectedBingVideoButtons(){const e=[];return e.push((0,s.h)("omfx-button",{attrs:{dark:this.theming.body.bg.dark,text:this.uxLoc.Common.Buttons.Back},domProps:{onClick:()=>{this.providerSlots.bottom=null,this.gridViewSlots.customSlot=null,this.bingVideoResult=null},mode:r.ButtonModes.flat,icon:{iconType:new r.FontAwesomeIcon("arrow_back"),position:r.ButtonIconPosition.Left}}})),e.push((0,s.h)("v-spacer")),e.push((0,s.h)("omfx-button",{attrs:{dark:!0,text:this.uxLoc.Common.Buttons.Ok},domProps:{styles:{bgColor:this.theming.colors.primary.base},onClick:()=>{this.onBeforeSavedResolvablePromise.resolve(this.bingVideoResult)},mode:r.ButtonModes.raised}})),e.push((0,s.h)("omfx-button",{attrs:{dark:this.theming.body.bg.dark,text:this.uxLoc.Common.Buttons.Close},domProps:{onClick:()=>{this.closed?.()},mode:r.ButtonModes.flat}})),e}render(){return this.renderGridViewProvider()}};u([(0,a.Inject)(b)],g.prototype,"bingImageService",2),u([(0,a.Localize)(c.BingProviderLocalization.namespace)],g.prototype,"bingLoc",2),g=u([o.default],g),a.WebComponentBootstrapper.registerElement((e=>{(0,a.vueCustomElement)(e.elementName,g)}))},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,i)=>{e.exports=i("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"1682f669-2a99-45e6-aa8b-7ed3d4e538d5":(e,t,i)=>{e.exports=i("dll-reference md66")("1682f669-2a99-45e6-aa8b-7ed3d4e538d5")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,i)=>{e.exports=i("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,i)=>{e.exports=i("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fc7e7933-28e6-4088-ab1b-37b8f89e8693"])throw new Error("Error, already loaded manifest fc7e7933-28e6-4088-ab1b-37b8f89e8693 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fc7e7933-28e6-4088-ab1b-37b8f89e8693"]=i;var t={};function i(s){var o=t[s];if(void 0!==o)return o.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,i),a.exports}i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};i("./client/fx/ux/mediapickerproviders/bingprovider/bingprovider.tsx")})()};