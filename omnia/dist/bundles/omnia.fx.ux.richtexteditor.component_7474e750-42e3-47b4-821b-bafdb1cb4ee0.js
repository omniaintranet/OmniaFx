if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["7474e750-42e3-47b4-821b-bafdb1cb4ee0"])throw new Error("Error, already loaded manifest 7474e750-42e3-47b4-821b-bafdb1cb4ee0 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["7474e750-42e3-47b4-821b-bafdb1cb4ee0"]=function(){(()=>{var e={"./client/fx/ux/richtexteditor/richtexteditor.tsx":(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>S});var i=o("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),s=o("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),n=o("./node_modules/tiptap/dist/tiptap.esm.js"),r=o("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","7474e750-42e3-47b4-821b-bafdb1cb4ee0"),d=o("./client/fx/ux/styleflow.js"),a=o("./client/fx/ux/models/index.js"),l=o("./node_modules/csx/lib.es2015/index.js");d.StyleFlow.define(a.RichTextEditorStyles,{selectedNode:e=>({$nest:{"& .ProseMirror-selectednode":{outline:`2px solid ${e}`}}}),subToolBar:{marginTop:"5px",borderTop:"1px solid #d6d4d4",paddingTop:"5px"},menubar:{$nest:{"&.v-sheet.v-card":{borderBottomRightRadius:0,borderBottomLeftRadius:0},".menubar":{background:"inherit"},"& .v-select":{marginTop:"0 !important",paddingTop:"0 !important"}}},menubarDark:{borderBottom:"1px solid rgba(255,255,255,0.10)"},menubarLight:{borderBottom:"1px solid rgba(0,0,0,0.10)"},menubarLanguagePicker:{paddingRight:"42px",$nest:{".language-picker":{position:"absolute",top:"8px",right:"2px"}}},hiddenToolsBlock:{display:"none"},editorContent:{padding:"15px 15px 15px 15px",flex:"0 1 auto",$nest:{"p.is-empty":{$nest:{"&:first-child":{$nest:{"&::before":{content:"attr(data-empty-text)",float:"left",color:"#aaa",pointerEvents:"none",height:0}}}}},"div.ProseMirror":{minHeight:"30px",overflow:"hidden",whiteSpace:"normal"},"& .ProseMirror":{outline:"0px solid transparent"},"& .ProseMirror .tableWrapper":{overflowX:"auto"},"& .ProseMirror table":{borderCollapse:"collapse",tableLayout:"fixed",width:"100%",overflow:"hidden"},"& .ProseMirror td, .ProseMirror th":{verticalAlign:"top",boxSizing:"border-box",position:"relative"},"& .ProseMirror .column-resize-handle":{position:"absolute",right:"-2px; top: 0; bottom: 0",width:"4px",zIndex:20,backgroundColor:"#adf",pointerEvents:"none"},"& .ProseMirror.resize-cursor":{cursor:"ew-resize"},"& .ProseMirror .selectedCell:after":{zIndex:2,position:"absolute",content:"",left:0,right:0,top:0,bottom:0,background:"gba(200, 200, 255, 0.4)",pointerEvents:"none"},"& .ProseMirror .tableWrapper .dottedBorder td":{border:"2px dotted #ddd"},"& .ProseMirror hr":{marginBottom:"16px"}}},editor:{position:"relative",marginBottom:"1px"},bubbleMenu:{position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.5)",visibility:"hidden",opacity:0,marginBottom:"0.5rem",borderRadius:"3px",zIndex:3,display:"flex",transform:"translateX(-50%)","-webkit-transform":"translateX(-50%)",$nest:{"&.is-active":{visibility:"visible",opacity:1},".v-icon":{fontSize:(0,l.important)("24px")}}},stickyMenu:(e,t)=>({zIndex:2,top:e,width:t+"px",position:"fixed"}),genericExtensionElementStyle:e=>{const t=(e,t)=>{const o=e.replace("#","");return`rgba(${parseInt(o.substring(0,2),16)},${parseInt(o.substring(2,4),16)},${parseInt(o.substring(4,6),16)},${t/100})`},o={borderColor:"#000"},i={backgroundColor:"#000"},s={backgroundColor:e.colors.primary.base},n={backgroundColor:t(e.colors.primary.base,10)},r={backgroundColor:t(e.colors.primary.base,30)},d={borderColor:e.colors.primary.base},a={borderStyle:"solid",borderWidth:"1px",borderCollapse:"collapse"},b={padding:"5px"};return{position:"relative",zIndex:1,$nest:{blockquote:{position:"relative",padding:"20px 0px 10px 0px",textAlign:"center",fontStyle:"italic",color:`${e.colors.primary.base}`,display:"flex",flexDirection:"column",$nest:{"&::before":{fontFamily:"'Font Awesome 5 Pro'",content:"'\\f10d'",position:"absolute",top:"-5px",left:"50%",transform:"translateX(-50%)",color:`${e.colors.primary.base}`,fontSize:"18px",fontWeight:"bold"},"> *:last-child":{marginBottom:"0"}}},table:{borderCollapse:"collapse",width:"100%"},".ProseMirror table.rtfSimpleTableStyle":{...a,...o,$nest:{tr:{...a,...o,$nest:{td:{...a,...b,...o}}}}},".ProseMirror table.rtfBorderHeaderTableStyle":{...a,...o,$nest:{tr:{...a,...o,$nest:{"&:first-child":{borderBottomWidth:"3px",...o,$nest:{td:{fontWeight:700}}},td:{...a,...b,...o}}}}},".ProseMirror table.rtfFilledHeaderTableStyle":{...a,...o,$nest:{tr:{...a,...o,$nest:{"&:first-child":{...i,...o,$nest:{td:{color:"#fff",fontWeight:700}}},td:{...a,...b,...o}}}}},".ProseMirror table.rtfBandedRowTableStyle":{...a,$nest:{tr:{...a,...o,$nest:{"&:first-child":{...i,$nest:{td:{color:"#fff",fontWeight:700}}},"&:nth-child(2n)":{backgroundColor:"#e1dfdd"},td:{...a,...b}}}}},".ProseMirror table.rtfBandedRowColumnTableStyle":{...a,...o,$nest:{tr:{...a,...o,$nest:{"&:first-child":{...i,$nest:{td:{color:"#fff",fontWeight:700}}},"&:nth-child(2n)":{backgroundColor:"#e1dfdd"},"&:not(:first-child)":{$nest:{"td:first-child":{backgroundColor:"#c8c6c4"}}},td:{...a,...b,...o}}}}},".ProseMirror table.rtfSimpleTableStyleTheme":{...a,...d,$nest:{tr:{...a,...d,$nest:{td:{...a,...b,...d}}}}},".ProseMirror table.rtfBorderHeaderTableStyleTheme":{...a,...d,$nest:{tr:{...a,...d,$nest:{"&:first-child":{borderBottomWidth:"3px",...d,$nest:{td:{fontWeight:700}}},td:{...a,...b,...d}}}}},".ProseMirror table.rtfFilledHeaderTableStyleTheme":{...a,...d,$nest:{tr:{...a,...d,$nest:{"&:first-child":{...s,...d,$nest:{td:{color:"#fff",fontWeight:700}}},td:{...a,...b,...d}}}}},".ProseMirror table.rtfBandedRowTableStyleTheme":{...a,...d,$nest:{tr:{...a,...d,$nest:{"&:first-child":{...s,$nest:{td:{color:"#fff",fontWeight:700}}},"&:nth-child(2n)":{...n},td:{...a,...b,...d}}}}},".ProseMirror table.rftBandedRowColumnTableStyleTheme":{...a,...d,$nest:{tr:{...a,...d,$nest:{"&:first-child":{...s,$nest:{td:{color:"#fff",fontWeight:700}}},"&:nth-child(2n)":{...n},"&:not(:first-child)":{$nest:{"td:first-child":{...r}}},td:{...a,...b,...d}}}}},"li > p":{minHeight:"1.5em",marginBottom:(0,l.important)("8px")}}}}});var b=o("./node_modules/typestyle/umd/typestyle.js"),h=o("./node_modules/tiptap-extensions/dist/extensions.esm.js"),c=o("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),p=o("./client/fx/ux/richtexteditor/extensions/index.js"),u=o("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),m=o("f37916a5-b801-4e3a-a1be-30a009bd2df2"),f=o("97786ea9-4861-48bd-8a57-eae9bbdb4892"),g=o("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","7474e750-42e3-47b4-821b-bafdb1cb4ee0"),x=o("./client/fx/ux/uxdefaultrichtextstyle.js"),y=o("5e618f4d-d014-414e-a681-89e34cbeda0f"),C=Object.defineProperty,E=Object.getOwnPropertyDescriptor,v=(e,t,o,i)=>{for(var s,n=i>1?void 0:i?E(t,o):t,r=e.length-1;r>=0;r--)(s=e[r])&&(n=(i?s(t,o,n):s(n))||n);return i&&n&&C(t,o,n),n};const T=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;let S=class extends g.VueComponentBase{constructor(){super(...arguments),this.editorClasses=d.StyleFlow.use(a.RichTextEditorStyles),this.editorDefaultStyle=d.StyleFlow.use(x.DefaultRichtextStyles),this.updateToolbar=!1,this.paddingTop=0,this.lastScrollTop=0,this.selectionDebounce=!1,this.content="",this.isLoading=!1,this.nodes=[],this.toolbarItems=[],this.isShowToolbar=!1,this.data={},this.contentHelper=new m.RichTextContentHelper(this.data),this.bubbleMenuItems=[],this.pastedMenuItem=[],this.pastedPosition={top:0,left:0,active:!1},this.isSticky=!1,this.parentScrollOffset={top:0},this.stickyElmScrollableParent=null,this.uniqueEditorId=f.Utils.generateGuid(),this.extensions=[],this.allExtensions=[],this.isRightToLeft=!1,this.hasLanguagePicker=!1,this.currentEmitedContent=null}onTopicIdChange(e,t){e&&this.editor&&this.editor.setContent("")}created(){this.content=this.initialContent||"",this.styles&&(this.editorClasses=d.StyleFlow.use(a.RichTextEditorStyles,this.styles)),this.initSubscribedExtensions(),this.isRightToLeft=this.directionStore.getters.getDirectionRule()===c.DirectionRules.rtl}mounted(){r.WebComponentBootstrapper.registerElementInstance(this,this.$el),this.onInstanceCreated&&this.onInstanceCreated(this),this.disabled||this.registerScrollEvent()}updateContent(e){this.onContentChangedFromToolbar(e)}initSubscribedExtensions(){this.isLoading=!0,omniaApi.fx.ux.richTextEditor.helper.then((e=>{0!=this.extensions.length?this.initExtensions():this.settingsService.getValue(c.Constants.ux.components.richTextEditor.settingsKey).then((t=>{if(t){let o=[];o=this.mode==c.RichTextModes.Full?0!=t.extensions.length?t.extensions:e.getDefaultRTFExtensionRegistrations():0!=t.limitedExtensions.length?t.limitedExtensions:e.getDefaultLimitedRTFExtensionRegistrations(),this.loadFromExtensionRegistrations(o).then((t=>{this.extensions=t,this.onConfigureExtensions&&(this.extensions=this.onConfigureExtensions(this.extensions,this.registrationResolver,e).filter((e=>!!e))),this.initExtensions()}))}else this.extensions=this.mode==c.RichTextModes.Full?e.getDefaultRTFExtensions():e.getDefaultLimitedRTFExtensions(),this.onConfigureExtensions&&(this.extensions=this.onConfigureExtensions(this.extensions)),this.initExtensions()}))}))}registrationResolver(e){let t=null;const o=this.allExtensions.find((t=>t.id==e.id));return o&&(t=e.settings?o.instance(e.settings):o.instance),t}loadFromExtensionRegistrations(e){return new Promise(((t,o)=>{const i=[];e.forEach((e=>{i.push(r.ManifestResourceLoader.loadResource(e.manifestId,e.serviceId))})),omniaApi.fx.ux.richTextEditor.registration.then((s=>{this.allExtensions=s.getAllExtensions(),Promise.all(i).then((()=>{t(this.buildExtensionList(e))})).catch(o)})).catch(o)}))}buildExtensionList(e){const t=[];for(let o=0;o<e.length;o++){const i=this.allExtensions.filter((t=>t.id==e[o].id));0!==i.length&&t.push(e[o].settings?i[0].instance(e[o].settings):i[0].instance)}return t}initExtensions(){this.placeholder&&this.nodes.push(new h.Placeholder({emptyClass:this.placeholder.emptyClass,emptyNodeText:this.placeholder.emptyNodeText,showOnlyWhenEditable:this.placeholder.showOnlyWhenEditable})),this.extensions.push(new p.ExtendedElementsEditorExtension({allowStyle:!0,allowHardBreak:!0,allowDivision:!0,allowIframe:!0,allowTrailingParagraph:!0,allowLink:!0})),this.extensions.push(new p.RemovingFormattingEditorExtension);const e=[];this.extensions.forEach((t=>{if(t){const o=t.getDefition({onEditorUpdated:this.onEditorUpdated});e.push(o)}})),Promise.all(e).then((e=>{e.forEach((e=>{e.nodes.forEach((e=>{this.nodes.push(e)})),e.toolbarItems&&(this.toolbarItems=this.toolbarItems.concat(e.toolbarItems)),e.bubbleMenuItems&&e.bubbleMenuItems.forEach((e=>{e.showOnPasted?this.pastedMenuItem.push(e):this.bubbleMenuItems.push(e)}))})),this.nodes=this.nodes.map((e=>(e.priority||(e.priority=0),e))),this.nodes=this.nodes.sort(((e,t)=>e.priority<t.priority?-1:e.priority>t.priority?1:0)),this.toolbarItems.find((e=>!e.hidden))?this.isShowToolbar=!0:this.isShowToolbar=!1,this.isLoading=!1})),this.hasLanguagePicker=null!=this.extensions.find((e=>e.constructor.name==(new p.LanguagePickerEditorExtension).constructor.name))}setupEditor(){if(!this.editor){const e={extensions:[new p.Paragraph,...this.nodes,...this.builtInExtensions],content:this.content,useBuiltInExtensions:!1,editable:!this.disabled,autoFocus:this.autoFocus,editorProps:{handleKeyDown:(e,t)=>!(!T||32!==t.keyCode)&&(e.dispatch(e.state.tr.insertText(" ",e.state.selection.anchor)),!0),handleClick:(e,t,o)=>(this.hideBubbleMenu(),!1),handlePaste:(e,t,o)=>{const i=this.getBrowerSupport(),s=i.ie&&i.ie_version<15||i.ios&&i.webkit_version<604?null:t.clipboardData,n=s?s.getData("text/plain"):"",r=s?s.getData("text/html"):"";return this.pastedContext={text:n,html:r,from:e.state.selection.from,to:parseInt(e.state.selection.from)+parseInt(o.content.size)-1},""===n&&""===r||setTimeout((()=>{const t=this.updatePosition(e);this.pastedPosition={active:!0,left:t.left,top:t.top-50}}),100),!1}},parseOptions:{preserveWhitespace:"full"},onFocus:({view:e})=>{document.addEventListener("selectionchange",this.onSelectionChange)},onBlur:({event:e,view:t})=>{this.pastedPosition.active&&(setTimeout((()=>{const e=this.updatePosition(t);this.pastedPosition={active:!0,left:e.left,top:e.top-50}}),100),this.pastedPosition={...this.pastedPosition}),this.onEditorUpdated(),document.removeEventListener("selectionchange",this.onSelectionChange)},onUpdate:()=>{this.onEditorUpdated()}};this.editor=new n.Editor(e)}}onEditorUpdated(e,t){if(this.editor&&this.onContentChange){const e=this.editor.getHTML();this.currentEmitedContent!=e&&setTimeout((()=>{const t=this.editor.getHTML();e==t&&(this.currentEmitedContent=t,this.onContentChange(t))}),100)}setTimeout((()=>{e&&this.onContentDataChange&&(this.data[e]=t,this.onContentDataChange(this.contentHelper))}),100)}onContentChangedFromToolbar(e,t,o){this.editor&&(this.editor.setContent(e),this.content=e,this.onContentChange&&this.onContentChange(this.content),t&&this.onContentDataChange&&(this.data[t]=o,this.onContentDataChange(this.contentHelper)))}get builtInExtensions(){return[new p.Doc,new p.Text,...p.ExtendedElementsEditorExtension.getNodes()]}get elementWidth(){return $(this.$el).width()}beforeDestroy(){this.editor&&(this.editor.destroy(),this.editor=null),document.removeEventListener("selectionchange",this.onSelectionChange),this.stickyElmScrollableParent&&this.stickyElmScrollableParent.removeEventListener("scroll",this.scrollCallback)}render(){let e=null;return this.outlined&&(e=this.theming.body.bg.dark?"rgba(255, 255, 255, 0.10)":"rgba(0,0,0,0.10)"),(0,s.h)("v-card",{class:[this.editorClasses.editor,this.isRightToLeft&&"v-application--is-rtl"],attrs:{color:"rgba(0,0,0,0)",outlined:this.outlined,elevation:this.outlined?0:null},style:{paddingTop:`${this.isSticky?this.paddingTop:0}px`,"border-color":e}},[this.renderEditor()])}renderEditor(){if(this.isLoading)return(0,s.h)("div",{attrs:{id:this.uniqueEditorId},style:{minHeight:"80px"}});this.setupEditor();const e=this.toolbarItems.filter((e=>e.isSubToolBar));return(0,s.h)("div",{attrs:{id:this.uniqueEditorId}},[(0,s.h)("v-card",{attrs:{dark:this.theming.body.bg.dark},class:[this.editorClasses.menubar,this.theming.body.bg.dark?this.editorClasses.menubarDark:this.editorClasses.menubarLight]},[!this.disabled&&this.toolbarItems.length>0?(0,s.h)(n.EditorMenuBar,{class:(0,b.classes)("pl-2 menubar",this.updateToolbar?"toolbar":"",this.hasLanguagePicker&&this.editorClasses.menubarLanguagePicker,this.isShowToolbar?"":this.editorClasses.hiddenToolsBlock,this.isSticky&&this.editorClasses.stickyMenu(this.parentScrollOffset.top,this.elementWidth)),attrs:{editor:this.editor},scopedSlots:{default:t=>(0,s.h)("div",[(0,s.h)("div",[this.toolbarItems.filter((e=>!e.isSubToolBar)).map((e=>this.renderToolbarItem(t,e)))]),(0,s.h)("div",[e.map((e=>this.renderToolbarItem(t,e)))])])}}):null,!this.disabled&&this.bubbleMenuItems.length>0?(0,s.h)(n.EditorMenuBubble,{attrs:{editor:this.editor},scopedSlots:{default:e=>{e.commands,e.isActive,e.getMarkAttrs;const t=e.menu,o=t.isActive;return(0,s.h)("div",{class:[this.editorClasses.bubbleMenu,"menububble",o?"is-active":""],style:{left:t.left+"px",bottom:t.bottom+"px"}},[this.bubbleMenuItems.map((t=>this.renderBubbleMenuToolbarItem(e,t)))])}}}):null,!this.disabled&&this.pastedMenuItem.length>0?(0,s.h)(n.EditorMenuBubble,{attrs:{editor:this.editor},scopedSlots:{default:e=>{e.commands,e.isActive,e.getMarkAttrs;const t=e.menu.isActive;return(0,s.h)("div",{class:[this.editorClasses.bubbleMenu,"menububble",this.pastedPosition.active&&!t?"is-active":""],style:{left:this.pastedPosition.left+"px",top:this.pastedPosition.top+"px"}},[this.pastedMenuItem.map((t=>this.renderPastedBubbleMenuToolbarItem(e,t)))])}}}):null]),(0,s.h)(n.EditorContent,{class:[this.editorClasses.genericExtensionElementStyle(this.theming),this.editorDefaultStyle.defaultStyle,this.editorDefaultStyle.mediaPickerStyle,this.editorClasses.editorContent,this.editorClasses.selectedNode(this.theming.body.bg.color),this.bodyClass,c.Constants.ux.components.richTextEditor.RTEClass],attrs:{editor:this.editor}})])}renderToolbarItem(e,t){const o=t.configuration,i={};return o&&Object.keys(o).forEach(((e,t)=>{i[e]=o[e]})),i.menubar||(i.menubar=e),i.editor||(i.editor=this.editor),i.onContentChanged=this.onContentChangedFromToolbar,i.content=this.content,i.editorId=this.uniqueEditorId,this.editor.omniaRTFId=this.uniqueEditorId,(0,s.h)(t.toolbar,{props:i})}renderBubbleMenuToolbarItem(e,t){const o=t.configuration,i={};return o&&Object.keys(o).forEach(((e,t)=>{i[e]=o[e]})),i.menubar||(i.menubar=e),i.editor||(i.editor=this.editor),i.onContentChanged=this.onContentChangedFromToolbar,i.content=this.content,i.pastedContext=this.pastedContext,i.editorId=this.uniqueEditorId,this.editor.omniaRTFId=this.uniqueEditorId,(0,s.h)(t.menuItem,{props:i})}renderPastedBubbleMenuToolbarItem(e,t){const o=t.configuration,i={};return o&&Object.keys(o).forEach(((e,t)=>{i[e]=o[e]})),i.menubar||(i.menubar=e),i.editor||(i.editor=this.editor),i.onContentChanged=this.onContentChangedFromToolbar,i.content=this.content,i.pastedContext=this.pastedContext,i.editorId=this.uniqueEditorId,this.editor.omniaRTFId=this.uniqueEditorId,(0,s.h)(t.menuItem,{props:i})}onSelectionChange(){!1===this.selectionDebounce&&(this.selectionDebounce=!0,setTimeout((()=>{this.editor&&(this.content=this.editor.getHTML(),this.onContentChange&&this.onContentChange(this.content),this.updateToolbar=!this.updateToolbar,this.selectionDebounce=!1)}),200))}hideBubbleMenu(){this.pastedPosition.active=!1}getBrowerSupport(){const e={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){const t=/Edge\/(\d+)/.exec(navigator.userAgent),o=/MSIE \d/.test(navigator.userAgent),i=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);e.mac=/Mac/.test(navigator.platform);const s=e.ie=!!(o||i||t);e.ie_version=o?document.documentMode||6:i?+i[1]:t?+t[1]:null,e.gecko=!s&&/gecko\/(\d+)/i.test(navigator.userAgent),e.gecko_version=e.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];const n=!s&&/Chrome\/(\d+)/.exec(navigator.userAgent);e.chrome=!!n,e.chrome_version=n&&+n[1],e.ios=!s&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),e.android=/Android \d/.test(navigator.userAgent),e.webkit=!s&&"WebkitAppearance"in document.documentElement.style,e.safari=/Apple Computer/.test(navigator.vendor),e.webkit_version=e.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}return e}updatePosition(e){const{state:t}=e;if(e.composing)return;const{from:o,to:i}=t.selection,s=this.coordsAtPos(e,o),n=this.coordsAtPos(e,i,!0),r=this.$el;if(!r)return void this.hideBubbleMenu();const d=r.getBoundingClientRect(),a=(s.left+n.left)/2-d.left;return{left:Math.round(a),bottom:Math.round(d.bottom-s.top),top:Math.round(n.bottom-d.top)}}registerScrollEvent(){this.getMenuBarElement().then((e=>{this.$nextTick((()=>{this.stickyElmScrollableParent=f.Utils.getScrollParent(this.$el),this.parentScrollOffset.top=$(this.stickyElmScrollableParent).offset().top;this.scrollCallback=f.Utils.throttle(this.checkSticky,100,null),this.stickyElmScrollableParent.addEventListener("scroll",this.scrollCallback)}))}))}checkSticky(){const e=this.$el.querySelector(".menubar"),t=$(e).height();this.parentScrollOffset.top=$(this.stickyElmScrollableParent).offset().top;const o=$(this.stickyElmScrollableParent).scrollTop();if(Math.abs(this.lastScrollTop-o)<t)return;const i=$(this.$el).offset().top,s=($(this.$el).height(),$(this.$el).offset().top+$(this.$el).offset().height),n=i-this.parentScrollOffset.top,r=s-this.parentScrollOffset.top-t;n>=-5||r<=0?(this.paddingTop=0,this.isSticky=!1):(n<0||r>0)&&(this.paddingTop=t,this.isSticky=!0),this.lastScrollTop=o}getMenuBarElement(){return new Promise(((e,t)=>{let o=null;const i=setInterval((()=>{o=this.$el.querySelector(".menubar"),o&&(e(o),clearInterval(i))}),500)}))}coordsAtPos(e,t,o=!1){const{node:i,offset:s}=e.docView.domFromPos(t);let n,r;if(3===i.nodeType)o&&s<i.nodeValue.length?(r=this.singleRect(this.textRange(i,s-1,s),-1),n="right"):s<i.nodeValue.length&&(r=this.singleRect(this.textRange(i,s,s+1),-1),n="left");else if(i.firstChild){if(s<i.childNodes.length){const e=i.childNodes[s];r=this.singleRect(3===e.nodeType?this.textRange(e,null,null):e,-1),n="left"}if((!r||r.top===r.bottom)&&s){const e=i.childNodes[s-1];r=this.singleRect(3===e.nodeType?this.textRange(e,null,null):e,1),n="right"}}else r=i.getBoundingClientRect(),n="left";const d=r[n];return{top:r.top,bottom:r.bottom,left:d,right:d}}textRange(e,t,o){const i=document.createRange();return i.setEnd(e,null==o?e.nodeValue.length:o),i.setStart(e,t||0),i}singleRect(e,t){const o=e.getClientRects();return o.length?o[t<0?0:o.length-1]:e.getBoundingClientRect()}};v([(0,i.Prop)()],S.prototype,"initialContent",2),v([(0,i.Prop)()],S.prototype,"onContentChange",2),v([(0,i.Prop)()],S.prototype,"onContentDataChange",2),v([(0,i.Prop)()],S.prototype,"onInstanceCreated",2),v([(0,i.Prop)()],S.prototype,"placeholder",2),v([(0,i.Prop)()],S.prototype,"styles",2),v([(0,i.Prop)()],S.prototype,"disabled",2),v([(0,i.Prop)()],S.prototype,"outlined",2),v([(0,i.Prop)()],S.prototype,"bodyClass",2),v([(0,i.Prop)()],S.prototype,"resetContent",2),v([(0,i.Prop)({default:!1})],S.prototype,"autoFocus",2),v([(0,i.Prop)({default:c.RichTextModes.Full})],S.prototype,"mode",2),v([(0,i.Prop)()],S.prototype,"onConfigureExtensions",2),v([(0,i.Prop)()],S.prototype,"onConfiguredExtensions",2),v([(0,r.Inject)(r.OmniaContext)],S.prototype,"omniaCtx",2),v([(0,r.Inject)(u.SettingsService)],S.prototype,"settingsService",2),v([(0,r.Inject)(y.DirectionRuleStore)],S.prototype,"directionStore",2),v([(0,i.Watch)("resetContent",{immediate:!1})],S.prototype,"onTopicIdChange",1),S=v([i.Component],S),r.WebComponentBootstrapper.registerElement((e=>{(0,r.vueCustomElement)(e.elementName,S)})),omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["b46f7161-e941-4240-b573-a9cd83e9d132"]("./node_modules/prosemirror-model/dist/index.js").DOMSerializer.renderSpec=function(e,t){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};let o,i=null;const s=t[1];let n=1;const r=s&&"object"==typeof s&&null==s.nodeType&&!Array.isArray(s),d=r?s.xmlns:null;if(o="image"===t[0]||d?e.createElementNS(d||"http://www.w3.org/2000/svg",t[0]):e.createElement(t[0]),r){n=2;for(const e in s)null!=s[e]&&("xlink:href"===e?o.setAttributeNS("http://www.w3.org/1999/xlink","href",s[e]):("alt"!==e||"alt"===e&&""!==s[e])&&o.setAttribute(e,s[e]))}for(let s=n;s<t.length;s++){const r=t[s];if(0===r){if(s<t.length-1||s>n)throw new RangeError("Content hole must be the only child of its parent node");return{dom:o,contentDOM:o}}{const t=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["b46f7161-e941-4240-b573-a9cd83e9d132"]("./node_modules/prosemirror-model/dist/index.js").DOMSerializer.renderSpec(e,r),s=t.dom,n=t.contentDOM;if(o.appendChild(s),n){if(i)throw new RangeError("Multiple content holes");i=n}}}return{dom:o,contentDOM:i}}},"./client/fx/ux/models/index.js":(e,t,o)=>{e.exports=o("dll-reference md66")("./client/fx/ux/models/index.js")},"./client/fx/ux/richtexteditor/extensions/index.js":(e,t,o)=>{e.exports=o("dll-reference md60")("./client/fx/ux/richtexteditor/extensions/index.js")},"./client/fx/ux/styleflow.js":(e,t,o)=>{e.exports=o("dll-reference md66")("./client/fx/ux/styleflow.js")},"./client/fx/ux/uxdefaultrichtextstyle.js":(e,t,o)=>{e.exports=o("dll-reference md66")("./client/fx/ux/uxdefaultrichtextstyle.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/csx/lib.es2015/index.js":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/csx/lib.es2015/index.js")},"./node_modules/tiptap-extensions/dist/extensions.esm.js":(e,t,o)=>{e.exports=o("dll-reference md60")("./node_modules/tiptap-extensions/dist/extensions.esm.js")},"./node_modules/tiptap/dist/tiptap.esm.js":(e,t,o)=>{e.exports=o("dll-reference md60")("./node_modules/tiptap/dist/tiptap.esm.js")},"./node_modules/typestyle/umd/typestyle.js":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/typestyle/umd/typestyle.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,o)=>{e.exports=o("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,o)=>{e.exports=o("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,o)=>{e.exports=o("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,o)=>{e.exports=o("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,o)=>{e.exports=o("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,o)=>{e.exports=o("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"f37916a5-b801-4e3a-a1be-30a009bd2df2":(e,t,o)=>{e.exports=o("dll-reference md60")("f37916a5-b801-4e3a-a1be-30a009bd2df2")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md60":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["b46f7161-e941-4240-b573-a9cd83e9d132"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["7474e750-42e3-47b4-821b-bafdb1cb4ee0"])throw new Error("Error, already loaded manifest 7474e750-42e3-47b4-821b-bafdb1cb4ee0 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["7474e750-42e3-47b4-821b-bafdb1cb4ee0"]=o;var t={};function o(i){var s=t[i];if(void 0!==s)return s.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};o("./client/fx/ux/richtexteditor/richtexteditor.tsx")})()};