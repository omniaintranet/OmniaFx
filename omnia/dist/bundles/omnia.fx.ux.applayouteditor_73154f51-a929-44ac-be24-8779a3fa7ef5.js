if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["73154f51-a929-44ac-be24-8779a3fa7ef5"])throw new Error("Error, already loaded manifest 73154f51-a929-44ac-be24-8779a3fa7ef5 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["73154f51-a929-44ac-be24-8779a3fa7ef5"]=function(){(()=>{var e={"./client/fx/ux/applayout/editor/applayouteditor.tsx":(e,t,o)=>{"use strict";o.r(t),o.d(t,{AppLayoutEditor:()=>O});var r=o("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),i=o("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","73154f51-a929-44ac-be24-8779a3fa7ef5"),s=o("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=o("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","73154f51-a929-44ac-be24-8779a3fa7ef5"),n=o("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),d=o("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),l=o("./client/fx/ux/applayout/index.js"),p=o("97786ea9-4861-48bd-8a57-eae9bbdb4892"),c=o("5e618f4d-d014-414e-a681-89e34cbeda0f"),h=o("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),m=o("./node_modules/csx/lib.es2015/index.js");const b={};a.StyleFlow.define(b,{container:{paddingBottom:(0,m.important)("0px"),minHeight:"48px"},timelineWrapper:{width:"100%"},link:{color:"inherit",display:"inline-block",textDecoration:"none !important",$nest:{"&:hover":{textDecoration:"underline !important"}}},version:{cursor:"pointer"},smallDot:{$nest:{".v-timeline-item__dot":{height:"10px !important",width:"10px !important",marginTop:"7px !important"}}}});var u=o("./node_modules/dayjs/dayjs.min.js"),y=o.n(u),f=Object.defineProperty,v=Object.getOwnPropertyDescriptor,g=(e,t,o,r)=>{for(var i,s=r>1?void 0:r?v(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r?i(t,o,s):i(s))||s);return r&&s&&f(t,o,s),s};let x=class extends a.VueComponentBase{constructor(){super(...arguments),this.versionPanelStyles=a.StyleFlow.use(b),this.model={user:null}}created(){this.azureAdService.resolveUsersByPrincipalNames([this.modifiedBy.uid]).then((e=>{e.length>0&&(this.model.user=e[0])}))}beforeDestroy(){}renderDateTime(e){let t="";try{t=y()(e).format("MMMM DD YYYY hh:mm")}catch(e){}return t}render(){if(this.model.user)return(0,r.h)("v-row",{attrs:{"no-gutter":!0}},[(0,r.h)("v-col",{attrs:{cols:"2"},class:"px-0"},[(0,r.h)("v-avatar",{attrs:{size:"40"},class:"mr-2"},[(0,r.h)("v-img",{attrs:{src:this.model.user.avatar}})])]),(0,r.h)("v-col",{attrs:{cols:"10"}},[(0,r.h)("v-row",{attrs:{"no-gutter":!0}},[(0,r.h)("v-col",{attrs:{cols:"12"},class:"py-0"},[(0,r.h)("a",{class:[this.versionPanelStyles.link,"body-2",this.theming.body.text.css],attrs:{target:"_blank",href:this.model.user.profileUrl}},[this.model.user.displayName])]),(0,r.h)("v-col",{attrs:{cols:"12"},class:["py-0 caption",this.theming.body.text.css]},[this.renderDateTime(this.modifiedAt)])])])])}};g([(0,d.Prop)()],x.prototype,"modifiedBy",2),g([(0,d.Prop)()],x.prototype,"modifiedAt",2),g([(0,i.Inject)(h.AzureAdService)],x.prototype,"azureAdService",2),x=g([n.default],x);var S=Object.defineProperty,I=Object.getOwnPropertyDescriptor,j=(e,t,o,r)=>{for(var i,s=r>1?void 0:r?I(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r?i(t,o,s):i(s))||s);return r&&s&&S(t,o,s),s};let L=class extends a.VueComponentBase{constructor(){super(...arguments),this.versionPanelStyles=a.StyleFlow.use(b),this.versions=null,this.pagingModel={page:0,pageSize:20,versions:[]},this.originalVersion=null,this.selectedVersion=null,this.actionButtons=[{type:s.ActionItemType.Button,loading:!1,actionCallback:()=>{this.revert()},highLighted:!1,icon:"update",title:()=>this.loc.AppInstanceLayout.Revert}]}get item(){return this.editorChromeStore.item.state}created(){this.originalVersion=this.item.versionedData,this.selectedVersion=this.originalVersion,this.appLayoutService.getLayoutVersionInformation(this.originalVersion).then((e=>{const t=e[0];this.versions=e.filter((e=>e.majorVersion===t.majorVersion||0===e.minorVersion)),this.loadNextPage()})),this.editorChromeStore.mutations.registerTemporaryActionButtons.commit(this.actionButtons)}beforeDestroy(){this.editorChromeStore.mutations.removeTemporaryActionButtons.commit(this.actionButtons),this.appLayoutEditorStore.mutations.setVersionPanel.commit(!1)}revert(){this.selectedVersion&&this.appInstanceLayoutStore.actions.ensureLoadDefinition.dispatch(this.selectedVersion).then((()=>{const e=this.appInstanceLayoutStore.getters.getLayoutDefinition(this.selectedVersion);e&&this.appInstanceLayoutStore.actions.checkOutDefinition.dispatch(this.originalVersion).then((t=>{const o={checkedOutBy:t.checkedOutBy,dataId:t.dataId,dataTypeId:t.dataTypeId,majorVersion:t.majorVersion,minorVersion:t.minorVersion,omniaServiceId:t.omniaServiceId,versionId:t.versionId,data:i.Utils.clone(e.data),modifiedAt:t.modifiedAt,modifiedBy:t.modifiedBy};this.appInstanceLayoutStore.actions.updateDefinition.dispatch(o).then((e=>{this.item.setNewEditorItem(e),this.onClose(!1)}))}))}))}onClose(e){this.appLayoutEditorStore.mutations.setVersionPanel.commit(!1),e&&this.item.setNewEditorItem(this.originalVersion)}onSelectVersion(e){this.selectedVersion=e,this.appInstanceLayoutStore.actions.ensureLoadDefinition.dispatch(e).then((()=>{const t=this.appInstanceLayoutStore.getters.getLayoutDefinition(e);t&&this.item.setNewEditorItem(t)}))}loadNextPage(){this.pagingModel.page++;const e=this.pagingModel.page*this.pagingModel.pageSize;this.pagingModel.versions=this.versions.slice(0,e)}renderTimeLineItem(e,t,o){const s=this.selectedVersion?.versionId===e.versionId,a=0!=e.minorVersion?this.versionPanelStyles.smallDot:"",n=s?t:o;return(0,r.h)("v-timeline-item",{attrs:{color:n,small:!0,"fill-dot":!0},class:[this.versionPanelStyles.container,a]},[(0,r.h)("div",{class:this.theming.body.bg.css},[(0,r.h)("div",{style:{color:s?t:"black"},class:[this.versionPanelStyles.version,this.theming.body.text.css],on:{click:()=>{this.onSelectVersion(e)}},attrs:{"expand-icon":""}},[(0,r.h)("span",{class:"body-1"},[e.majorVersion,".",e.minorVersion]),(0,r.h)("span",{class:"body-1 ml-4"},[i.Utils.getSocialDate(e.modifiedAt)])]),s&&(0,r.h)("div",{class:"pt-2 pb-4"},[(0,r.h)(x,{attrs:{modifiedAt:e.modifiedAt,modifiedBy:e.modifiedBy}})])])])}renderTimeline(){const e=this.theming.chrome.bg.color.base,t=this.theming.chrome.bg.dark?this.theming.chrome.bg.color.lighten1:this.theming.chrome.bg.color.darken1;return(0,r.h)("v-card",{attrs:{dark:this.theming.body.bg.dark,color:this.theming.body.bg.color.base,flat:!0,tile:!0}},[(0,r.h)("v-card-text",{class:["pa-0"]},[(0,r.h)("v-timeline",{class:this.versionPanelStyles.timelineWrapper,attrs:{dark:this.theming.body.bg.dark,"align-top":!0,dense:!0}},[this.pagingModel.versions.map((o=>[this.renderTimeLineItem(o,e,t)]))]),this.pagingModel.versions.length<this.versions.length&&(0,r.h)("div",{class:"pb-5 pl-5 pt-2"},[(0,r.h)("a",{on:{click:()=>{this.loadNextPage()}}},["older versions"])])])])}render(){const e=null===this.versions;return(0,r.h)("div",{class:this.theming.body.bg.css},[(0,r.h)("v-toolbar",{attrs:{color:this.theming.chrome.bg.color.base,flat:!0,dark:this.theming.chrome.bg.dark,tabs:!0}},[(0,r.h)("v-toolbar-title",["Version History"]),(0,r.h)("v-spacer"),(0,r.h)("omfx-button",{attrs:{dark:this.theming.chrome.bg.dark},domProps:{onClick:()=>{this.onClose(!0)},preset:a.ButtonPresets.icons.close}})]),(0,r.h)("v-skeleton-loader",{attrs:{loading:e,height:"100%",type:"list-item-avatar,list-item-avatar,list-item-avatar,list-item-avatar,list-item-avatar,list-item-avatar"},class:this.theming.body.components.skeletonLoader.css},[(0,r.h)("div",[!e&&this.renderTimeline()])])])}};j([(0,i.Inject)(h.AppLayoutService)],L.prototype,"appLayoutService",2),j([(0,i.Inject)(a.EditorChromeStore)],L.prototype,"editorChromeStore",2),j([(0,i.Inject)(c.AppLayoutStore)],L.prototype,"appInstanceLayoutStore",2),j([(0,i.Inject)(l.AppLayoutEditorStore)],L.prototype,"appLayoutEditorStore",2),j([(0,i.Localize)(a.OmniaUxLocalizationNamespace)],L.prototype,"loc",2),L=j([n.default],L);const w={};a.StyleFlow.define(w,{wrapper:{maxHeight:(0,m.important)("calc(100% - 48px - 50px)")}});var P=o("./client/fx/ux/styleflow.js"),C=Object.defineProperty,k=Object.getOwnPropertyDescriptor,E=(e,t,o,r)=>{for(var i,s=r>1?void 0:r?k(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r?i(t,o,s):i(s))||s);return r&&s&&C(t,o,s),s};let D=class extends a.VueComponentBase{constructor(){super(...arguments),this.styles=P.StyleFlow.use(w)}renderHistoryPanel(e){const t=this.appLayoutEditorStore.getters.openVersionPanel();return(0,r.h)("v-navigation-drawer",{attrs:{app:!0,float:!0,right:!0,clipped:!0,dark:this.theming.body.bg.dark,width:"340",temporary:!1,"disable-resize-watcher":!0,"hide-overlay":!0,value:t},class:[this.theming.body.bg.css,this.styles.wrapper]},[t&&(0,r.h)(L,{attrs:{themeTargetId:s.Constants.ux.themeTargetIds.editor.toString()}})])}render(){const e=this.editorChromeStore.item.state;return e&&e instanceof l.AppLayoutDefinitionEditorItem?(0,r.h)("div",{key:e.appInstanceLayout.id},[this.renderHistoryPanel(e)]):null}};E([(0,i.Inject)(a.EditorChromeStore)],D.prototype,"editorChromeStore",2),E([(0,i.Inject)(l.AppLayoutEditorStore)],D.prototype,"appLayoutEditorStore",2),D=E([n.default],D);var V=Object.defineProperty,A=Object.getOwnPropertyDescriptor,B=(e,t,o,r)=>{for(var i,s=r>1?void 0:r?A(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r?i(t,o,s):i(s))||s);return r&&s&&V(t,o,s),s};let O=class extends a.VueComponentBase{constructor(){super(...arguments),this.ready=new s.Future(null)}created(){this.appInstanceId?this.appContextProvider.updateContextByAppInstanceId(this.appInstanceId).then(this.ready.resolve):this.ready.resolve(),this.handleEditorItemMutating(),this.handleEditorItemMutated(),this.getApi&&this.getApi(this)}mounted(){i.WebComponentBootstrapper.registerElementInstance(this,this.$el)}handleEditorItemMutating(){this.subscriptionHandler.add(this.editorChromeStore.item.onMutating((e=>{this.handleResetEditorState(e.oldState,e.newState)})))}handleEditorItemMutated(){this.subscriptionHandler.add(this.editorChromeStore.item.onMutated((e=>{e.newState instanceof l.AppLayoutDefinitionEditorItem&&(this.handleCheckedOutByOtherUserMessage(e.newState),this.handleCloseFunc(e.newState))})))}handleResetEditorState(e,t){let o=!0;e instanceof l.AppLayoutDefinitionEditorItem&&t instanceof l.AppLayoutDefinitionEditorItem&&e.appInstanceLayout.id===t.appInstanceLayout.id&&(o=!1),o&&(this.appLayoutEditorStore.mutations.closeAllPanel.commit(),this.appLayoutEditorStore.mutations.resetBreakpointState.commit())}handleCloseFunc(e){e.closeFunc=this.closeEditor}handleCheckedOutByOtherUserMessage(e){this.userStore.current.then((t=>{const o=e.versionedData.checkedOutBy;o&&o.uid.toLowerCase()!==t.uid.toLowerCase()&&this.editorChromeStore.mutations.showMessage.commit({message:"",customElementName:"omfx-app-layout-checked-out-by-other-message"})}))}render(){return this.ready.resolved&&(0,r.h)("div",[(0,r.h)("omfx-editor-chrome",{attrs:{navigationDrawerTitle:this.navigationDrawerTitle,renderNavigationDrawer:this.renderNavigationDrawer,renderNavigationDrawerBottom:this.renderNavigationDrawerBottom,closeEditor:this.closeEditor}}),(0,r.h)(D)])}};B([(0,d.Prop)()],O.prototype,"getApi",2),B([(0,d.Prop)()],O.prototype,"appInstanceId",2),B([(0,d.Prop)()],O.prototype,"navigationDrawerTitle",2),B([(0,d.Prop)()],O.prototype,"renderNavigationDrawer",2),B([(0,d.Prop)()],O.prototype,"closeEditor",2),B([(0,d.Prop)()],O.prototype,"renderNavigationDrawerBottom",2),B([(0,i.Provide)(i.ServiceContainerContext)],O.prototype,"serviceContainerContext",2),B([(0,i.Inject)(l.AppLayoutEditorStore)],O.prototype,"appLayoutEditorStore",2),B([(0,i.Inject)(a.EditorChromeStore)],O.prototype,"editorChromeStore",2),B([(0,i.Inject)(a.AppContextProvider)],O.prototype,"appContextProvider",2),B([(0,i.Inject)(p.SubscriptionHandler)],O.prototype,"subscriptionHandler",2),B([(0,i.Inject)(c.UserStore)],O.prototype,"userStore",2),O=B([n.default],O),i.WebComponentBootstrapper.registerElement((e=>{(0,i.vueCustomElement)(e.elementName,O)}))},"./client/fx/ux/applayout/index.js":(e,t,o)=>{e.exports=o("dll-reference md66")("./client/fx/ux/applayout/index.js")},"./client/fx/ux/styleflow.js":(e,t,o)=>{e.exports=o("dll-reference md66")("./client/fx/ux/styleflow.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/csx/lib.es2015/index.js":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/csx/lib.es2015/index.js")},"./node_modules/dayjs/dayjs.min.js":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/dayjs/dayjs.min.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,o)=>{e.exports=o("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,o)=>{e.exports=o("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,o)=>{e.exports=o("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,o)=>{e.exports=o("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,o)=>{e.exports=o("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,o)=>{e.exports=o("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,o)=>{e.exports=o("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["73154f51-a929-44ac-be24-8779a3fa7ef5"])throw new Error("Error, already loaded manifest 73154f51-a929-44ac-be24-8779a3fa7ef5 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["73154f51-a929-44ac-be24-8779a3fa7ef5"]=o;var t={};function o(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,o),s.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};o("./client/fx/ux/applayout/editor/applayouteditor.tsx")})()};