if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["8cac4134-eacf-4089-89fc-a797cf7589b2"])throw new Error("Error, already loaded manifest 8cac4134-eacf-4089-89fc-a797cf7589b2 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["8cac4134-eacf-4089-89fc-a797cf7589b2"]=function(){(()=>{var e={"./client/fx/ux/app/builders/blades/apptemplatebladebuilder.tsx":(e,t,i)=>{"use strict";i.r(t);var s=i("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),a=i("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),o=i("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","8cac4134-eacf-4089-89fc-a797cf7589b2"),p=i("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","8cac4134-eacf-4089-89fc-a797cf7589b2"),r=i("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),n=i("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),l=i("./client/fx/ux/app/builders/core/index.js"),d=i("5e618f4d-d014-414e-a681-89e34cbeda0f"),h=Object.defineProperty,c=Object.getOwnPropertyDescriptor,m=(e,t,i,s)=>{for(var a,o=s>1?void 0:s?c(t,i):t,p=e.length-1;p>=0;p--)(a=e[p])&&(o=(s?a(t,i,o):a(o))||o);return s&&o&&h(t,i,o),o};let u=class extends p.VueComponentBase{constructor(){super(...arguments),this.isSaving=!1,this.approversIdentities=[],this.appTemplate=null,this.errorMessage=""}created(){this.formValidator=new p.FormValidator(this),this.appTemplate=this.appStore.editingAppTemplate.state,this.appTemplate.title?this.isCreateTemplate=!1:(this.appTemplate.title=null,this.appTemplate.description=null,this.isCreateTemplate=!0),this.appTemplate.properties&&this.appTemplate.properties.approvers&&(this.approversIdentities=this.appTemplate.properties.approvers.map((e=>o.Utils.getIdentityId(e)))),this.appTemplate.properties.userAvailability||(this.appTemplate.properties.userAvailability={availability:n.UserAppTemplateAvailabilityOptions.AdminOnly,targetingFilter:null})}onPermissionLevelChange(e){this.appTemplate.properties.permissionLevel=e,this.$forceUpdate()}onUserAvailabilityChange(e){this.appTemplate.properties.userAvailability.availability=e,this.$forceUpdate()}updateApprovers(e){this.approversIdentities=e,this.appTemplate.properties.approvers=e.map((e=>e.uid))}onSave(){this.formValidator.validateAll()&&(this.isSaving=!0,this.settings.validator?this.settings.validator(this.appTemplate).then((e=>{e.isValid?this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()})):(this.errorMessage=e.message,this.isSaving=!1)})):this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()})))}render(){const e=this.omniaTheming.promoted.body.dark;return(0,s.h)("div",[(0,s.h)("omfx-blade-header",{attrs:{journey:this.journey,title:this.loc.General}}),(0,s.h)("v-container",{attrs:{fluid:!0}},[(0,s.h)("v-row",{attrs:{align:"center","no-gutters":!0}},[this.settings?.gerneralMenuItem?.prependElement&&(0,s.h)("v-col",{attrs:{cols:"12"}},[this.settings.gerneralMenuItem.prependElement(this.appTemplate,this)]),(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("omfx-multilingual-input",{attrs:{label:this.omniaUxLoc.Common.Title},domProps:{valueBind:this.appTemplate.title,onValueChanged:e=>{this.appTemplate.title=e},requiredWithValidator:this.formValidator}})]),(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("omfx-multilingual-input",{attrs:{multipleLines:!0,label:this.omniaUxLoc.Common.Description},domProps:{valueBind:this.appTemplate.description,onValueChanged:e=>{this.appTemplate.description=e}}})]),(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("omfx-icon-picker",{attrs:{dark:e},domProps:{valueBind:this.appTemplate.icons[0]}})]),(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("v-radio-group",{attrs:{label:"Available To"},on:{change:this.onUserAvailabilityChange},model:{value:this.appTemplate.properties.userAvailability.availability,callback:e=>{this.$set(this.appTemplate.properties.userAvailability,"availability",e)}}},[(0,s.h)("v-radio",{attrs:{color:this.omniaTheming.promoted.body.onComponent.base,value:n.UserAppTemplateAvailabilityOptions.All,label:"All Users"}}),(0,s.h)("v-radio",{attrs:{color:this.omniaTheming.promoted.body.onComponent.base,value:n.UserAppTemplateAvailabilityOptions.SpecificUser,label:"Specific Users"}}),this.appTemplate.properties.userAvailability.availability===n.UserAppTemplateAvailabilityOptions.SpecificUser&&(0,s.h)("omfx-targeting-filter",{attrs:{dark:this.theming.body.bg.dark},domProps:{onFilterChanged:e=>{this.appTemplate.properties.userAvailability.targetingFilter=e},filter:this.appTemplate.properties.userAvailability.targetingFilter,fullWidth:!0}}),(0,s.h)("v-radio",{attrs:{color:this.omniaTheming.promoted.body.onComponent.base,value:n.UserAppTemplateAvailabilityOptions.AdminOnly,label:"Admins only"}})])]),(0,s.h)("v-col",{attrs:{cols:"12"}}),(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("v-radio-group",{attrs:{label:"Site Creation Mode"},on:{change:this.onPermissionLevelChange},model:{value:this.appTemplate.properties.permissionLevel,callback:e=>{this.$set(this.appTemplate.properties,"permissionLevel",e)}}},[(0,s.h)("v-radio",{attrs:{color:this.omniaTheming.promoted.body.onComponent.base,value:n.AppTemplatePermissionLevel.SeftService,label:"Self-Service"}}),(0,s.h)("v-radio",{attrs:{color:this.omniaTheming.promoted.body.onComponent.base,value:n.AppTemplatePermissionLevel.Approval,label:"Approval"}})])]),this.appTemplate.properties.permissionLevel===n.AppTemplatePermissionLevel.Approval&&(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("omfx-people-picker",{attrs:{multiple:!0,dark:this.omniaTheming.promoted.body.dark,label:"Approvers",required:!0},domProps:{principalType:n.AzureAdObjectPrincipalTypes.Member,valueBind:this.approversIdentities,onValueChanged:e=>{this.updateApprovers(e)},useValidator:this.formValidator}})]),(0,s.h)("span",{style:{color:"rgba(255,0,0)"}},[this.errorMessage]),(0,s.h)("v-col",{attrs:{cols:"12"},class:"text-right"},[(0,s.h)("omfx-button",{attrs:{contentClass:"shrink ml-2",dark:this.omniaTheming.promoted.body.dark,loading:this.isSaving,text:this.omniaUxLoc.Common.Buttons.Save},domProps:{mode:n.ButtonModes.flat,onClick:this.onSave}})])])])])}};m([(0,r.Prop)()],u.prototype,"journey",2),m([(0,r.Prop)()],u.prototype,"settings",2),m([(0,o.Inject)(p.OmniaTheming)],u.prototype,"omniaTheming",2),m([(0,o.Inject)(d.AppStore)],u.prototype,"appStore",2),m([(0,o.Localize)(l.AppBladeBuilderLocalization.namespace)],u.prototype,"loc",2),m([(0,o.Localize)("Omnia.Ux")],u.prototype,"omniaUxLoc",2),u=m([a.default],u);var g=Object.defineProperty,b=Object.getOwnPropertyDescriptor,f=(e,t,i,s)=>{for(var a,o=s>1?void 0:s?b(t,i):t,p=e.length-1;p>=0;p--)(a=e[p])&&(o=(s?a(t,i,o):a(o))||o);return s&&o&&g(t,i,o),o};let y=class extends p.VueComponentBase{constructor(){super(...arguments),this.isSaving=!1,this.isLoading=!1,this.appTemplate=null,this.appDefinition=null,this.errorMessage=""}created(){this.isLoading=!0,this.appStore.actions.loadAppDefinitions.dispatch().then((()=>{this.appTemplate=this.appStore.editingAppTemplate.state,this.appDefinition=this.appStore.getters.getAppDefinition(this.appTemplate.appDefinitionId),null==this.appTemplate.features&&(this.appTemplate.features=[]),this.featureStore.actions.loadFeatureDefinitions.dispatch().then((e=>{this.filterAvailableFeatures(e),this.$forceUpdate()}))}))}filterAvailableFeatures(e){e=e.filter((e=>!e.hidden&&e.targetResolverType===n.TargetResolverTypes.AppInstance));const t=[n.Parameters.BusinessProfileId.toLowerCase(),n.Parameters.AppInstanceId.toLowerCase()],i=this.appDefinition.parameters?this.appDefinition.parameters:[],s=this.appDefinition.providedParameters?this.appDefinition.providedParameters:[];let a=[];if(s.length>0){const o=this.getParamsObj(i),p=this.getParamsObj(s);a=e.filter((e=>{let i=!0;for(const s of e.parameters){const e=s.name.toLowerCase();(s.isRequired||s.isRequiredToBuildTarget)&&null==p[e]&&t.indexOf(e)<0&&(null==o[e]||!o[e].isRequired)&&(i=!1)}return i}))}this.groupFeaturesByCategory(a),this.isLoading=!1}groupFeaturesByCategory(e){this.features={};for(const t of e){const e=t.category.toLowerCase();null==this.features[e]&&(this.features[e]=[]),this.appTemplate.features.indexOf(t.id)>=0?t.checked=!0:t.checked=!1,this.features[e].push(t)}}getParamsObj(e){const t={};for(const i of e)t[i.name.toLowerCase()]=i;return t}renderFeatureCategory(){const e=[];this.hasAvailableFeatures()||e.push((0,s.h)("v-col",{attrs:{cols:"12"}},["There are no available features that can be activated on this app definition"]));for(const t in this.features)e.push((0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("v-subheader",[this.features[t][0].category]),this.renderFeatures(this.features[t])]));return e}renderFeatures(e){const t=[];for(const i of e)t.push((0,s.h)("v-col",{attrs:{cols:"6"}},[(0,s.h)("v-checkbox",{attrs:{label:i.title,"input-value":i.checked},on:{change:()=>{this.onFeatureCheckedChange(i)}}})]));return t}onFeatureCheckedChange(e){e.checked=!e.checked;const t=this.appTemplate.features.indexOf(e.id);e.checked?t<0&&this.appTemplate.features.push(e.id):t>=0&&this.appTemplate.features.splice(t,1)}hasAvailableFeatures(){for(const e in this.features)if(this.features.hasOwnProperty(e)&&this.features[e].length>0)return!0;return!1}onSave(){this.isSaving=!0,this.settings.validator?this.settings.validator(this.appTemplate).then((e=>{e.isValid?this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()})):(this.errorMessage=e.message,this.isSaving=!1)})):this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()}))}render(){return(0,s.h)("div",[(0,s.h)("omfx-blade-header",{attrs:{journey:this.journey,title:this.loc.Features}}),(0,s.h)("v-container",{attrs:{fluid:!0}},[this.isLoading?(0,s.h)("div",{class:"text-center"},[(0,s.h)("v-progress-circular",{attrs:{indeterminate:!0}})]):(0,s.h)("v-row",{attrs:{"no-gutters":!0}},[this.renderFeatureCategory(),(0,s.h)("span",{style:{color:"rgba(255,0,0)"}},[this.errorMessage]),(0,s.h)("v-col",{attrs:{cols:"12"},class:"text-right"},[(0,s.h)("omfx-button",{attrs:{contentClass:"shrink ml-2",dark:this.omniaTheming.promoted.body.dark,loading:this.isSaving,text:this.omniaUxLoc.Common.Buttons.Save},domProps:{mode:n.ButtonModes.flat,onClick:()=>{this.onSave()}}})])])])])}};f([(0,r.Prop)()],y.prototype,"journey",2),f([(0,r.Prop)()],y.prototype,"settings",2),f([(0,o.Localize)("Omnia.Ux")],y.prototype,"omniaUxLoc",2),f([(0,o.Localize)(l.AppBladeBuilderLocalization.namespace)],y.prototype,"loc",2),f([(0,o.Inject)(d.AppStore)],y.prototype,"appStore",2),f([(0,o.Inject)(d.FeatureStore)],y.prototype,"featureStore",2),f([(0,o.Inject)(p.OmniaTheming)],y.prototype,"omniaTheming",2),y=f([a.default],y);var v,T=i("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac");(v||(v={})).namespace="Omnia.Ux.Template.Properties.Selection";var S=Object.defineProperty,P=Object.getOwnPropertyDescriptor,A=(e,t,i,s)=>{for(var a,o=s>1?void 0:s?P(t,i):t,p=e.length-1;p>=0;p--)(a=e[p])&&(o=(s?a(t,i,o):a(o))||o);return s&&o&&S(t,i,o),o};let I=class extends p.VueComponentBase{constructor(){super(...arguments),this.isSaving=!1,this.errorMessage="",this.templateProperties=[],this.propertiesToRender=[],this.targetingProperties=[],this.selectionOption=[],this.currentUserOption={title:"Current User",value:n.OptionValue.CurrentUser},this.todayOption={title:"Today",value:n.OptionValue.Today},this.booleanOption=[],this.timeUnit=[],this.defaultPropertySetValue={}}created(){this.appTemplate=Object.assign({},this.appStore.editingAppTemplate.state),null!==this.appTemplate.properties.defaultEnterprisePropertySetValues&&void 0!==this.appTemplate.properties.defaultEnterprisePropertySetValues||(this.appTemplate.properties.defaultEnterprisePropertySetValues={}),this.appTemplate.properties.enterprisePropertySetId&&(this.defaultPropertySetValue[this.appTemplate.properties.enterprisePropertySetId.toString()]=o.Utils.clone(this.appTemplate.properties.defaultEnterprisePropertySetValues)),this.ensurePropertiesOfSet(),this.targetingPropertyStore.actions.ensureLoadData.dispatch().then((()=>{this.targetingProperties=this.targetingPropertyStore.targetingProperties.state})),this.initOptionsForSelection()}initOptionsForSelection(){this.selectionOption=[{title:this.propertiesSelectionLoc.NoDefault,value:n.OptionValue.None},{title:this.propertiesSelectionLoc.Fixed,value:n.OptionValue.Fixed}],this.currentUserOption={title:this.propertiesSelectionLoc.CurrentUser,value:n.OptionValue.CurrentUser},this.todayOption={title:this.propertiesSelectionLoc.Calculated,value:n.OptionValue.Today},this.booleanOption=[{title:this.propertiesSelectionLoc.Yes,value:n.OptionValue.BooleanYes},{title:this.propertiesSelectionLoc.No,value:n.OptionValue.BooleanNo}],this.timeUnit=[{title:this.propertiesSelectionLoc.Days.toLowerCase(),value:n.TimeUnit.Days},{title:this.propertiesSelectionLoc.Months.toLowerCase(),value:n.TimeUnit.Months},{title:this.propertiesSelectionLoc.Years.toLowerCase(),value:n.TimeUnit.Years}]}getProperties(){const e=this.enterprisePropertyStore.getters.enterprisePropertyDefinitions();let t=null;return o.Utils.isArrayNullOrEmpty(this.templateProperties)||(t=[],this.templateProperties.forEach((i=>{if(!o.Utils.isNullOrEmpty(i.id)){const s=e.find((e=>e.id===i.id));if(s&&s.enterprisePropertyDataType&&s.enterprisePropertyDataType.uiOptions){const e={type:i.type,id:s.id,internalName:s.internalName,title:s.title,editElement:s.enterprisePropertyDataType.uiOptions.editModeElementName||"",contentProperty:s,selectedOption:this.getDefaultSelectedOption(i.type,s.internalName)};t.push(e)}}}))),t}getDefaultSelectedOption(e,t){const i=this.appTemplate.properties.defaultEnterprisePropertySetValues[t];if(i)switch(e){case n.PropertyIndexedType.Boolean:return i;case n.PropertyIndexedType.DateTime:return n.OptionValue.Today;case n.PropertyIndexedType.Person:case n.PropertyIndexedType.Taxonomy:return i===n.OptionValue.CurrentUser?n.OptionValue.CurrentUser:i.length>0?n.OptionValue.Fixed:n.OptionValue.None;default:return n.OptionValue.Fixed}return n.OptionValue.None}ensurePropertiesOfSet(){o.Utils.isNullOrEmpty(this.appTemplate.properties.enterprisePropertySetId)?(this.propertiesToRender=[],this.templateProperties=[]):this.propertySetService.getEnterprisePropertySetById(this.appTemplate.properties.enterprisePropertySetId).then((e=>{this.templateProperties=e.settings.items,this.propertiesToRender=this.getProperties()}))}onSave(){this.isSaving=!0,this.defaultPropertySetValue[this.appTemplate.properties.enterprisePropertySetId.toString()]=this.appTemplate.properties.defaultEnterprisePropertySetValues,this.settings.validator?this.settings.validator(this.appTemplate).then((e=>{e.isValid?this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()})):(this.errorMessage=e.message,this.isSaving=!1)})):this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()}))}initEmptyValue(e){switch(e.type){case n.PropertyIndexedType.DateTime:case n.PropertyIndexedType.Text:this.appTemplate.properties.defaultEnterprisePropertySetValues[e.internalName]="";break;case n.PropertyIndexedType.Taxonomy:case n.PropertyIndexedType.Person:this.appTemplate.properties.defaultEnterprisePropertySetValues[e.internalName]=[];break;case n.PropertyIndexedType.Boolean:this.appTemplate.properties.defaultEnterprisePropertySetValues[e.internalName]=null}}onChangeSelection(e,t){const i=this.defaultPropertySetValue[this.appTemplate.properties.enterprisePropertySetId.toString()];switch(e){case n.OptionValue.None:this.initEmptyValue(t);break;case n.OptionValue.CurrentUser:this.appTemplate.properties.defaultEnterprisePropertySetValues[t.internalName]=e;break;case n.OptionValue.Today:this.appTemplate.properties.defaultEnterprisePropertySetValues[t.internalName]=i[t.internalName]||[];break;case n.OptionValue.Fixed:this.appTemplate.properties.defaultEnterprisePropertySetValues[t.internalName]===n.OptionValue.CurrentUser?i[t.internalName]!==n.OptionValue.CurrentUser?this.appTemplate.properties.defaultEnterprisePropertySetValues[t.internalName]=i[t.internalName]:this.initEmptyValue(t):this.appTemplate.properties.defaultEnterprisePropertySetValues[t.internalName]=i[t.internalName]||this.initEmptyValue(t);break;case n.OptionValue.BooleanNo:case n.OptionValue.BooleanYes:this.appTemplate.properties.defaultEnterprisePropertySetValues[t.internalName]=e}}renderSelection(e){const t=o.Utils.clone(this.selectionOption);switch(e.type){case n.PropertyIndexedType.Text:break;case n.PropertyIndexedType.DateTime:t.pop(),t.push(this.todayOption);break;case n.PropertyIndexedType.Person:t.push(this.currentUserOption);break;case n.PropertyIndexedType.Taxonomy:this.targetingProperties.find((t=>t.enterprisePropertyDefinitionId===e.contentProperty.id))&&t.push(this.currentUserOption);break;case n.PropertyIndexedType.Boolean:t.pop(),t.push(...this.booleanOption);break;default:t.pop()}return(0,s.h)("div",[(0,s.h)("v-select",{style:{marginBottom:"43px"},attrs:{items:t,"item-value":"value","item-text":"title","hide-details":!0,filled:!0},on:{change:t=>{this.onChangeSelection(t,e)}},model:{value:e.selectedOption,callback:t=>{this.$set(e,"selectedOption",t)}}})])}renderProperty(e){return[(0,s.h)("v-col",{attrs:{cols:4}},[this.multilingualStore.getters.stringValue(e.title)]),(0,s.h)("v-col",{attrs:{cols:8},class:"px-1"},[this.renderSelection(e)]),(0,s.h)("v-col",{attrs:{cols:4}}),(0,s.h)("v-col",{attrs:{cols:8},class:"px-1"},[(e.selectedOption===n.OptionValue.Fixed||e.selectedOption===n.OptionValue.Today)&&this.renderManualInputField(e)])]}renderManualInputField(e){const t=e.contentProperty;let i=null;const a=this.templateProperties.find((t=>t.id==e.id));return i={model:this.appTemplate.properties.defaultEnterprisePropertySetValues,disabled:!1,property:t,settings:a,useValidator:this.useValidator},e.type===n.PropertyIndexedType.DateTime?this.renderDateIncrementInput(s.h,e):(0,s.h)(t.enterprisePropertyDataType.uiOptions.editModeElementName,{domProps:i})}onChangeTimeUnitOrIncrement(e,t,i){const s={increment:e,timeUnit:t};this.appTemplate.properties.defaultEnterprisePropertySetValues[i]=s}renderDateIncrementInput(e,t){const i=this.appTemplate.properties.defaultEnterprisePropertySetValues[t.internalName];return i&&void 0!==i?(t.increment=i.increment,t.timeUnit=i.timeUnit):(t.increment=0,t.timeUnit=n.TimeUnit.Days),(0,s.h)("div",{class:"d-flex align-center"},[(0,s.h)("div",{class:"pb-6",style:{width:"50%"}},[this.propertiesSelectionLoc.Today," ",(0,s.h)("span",{class:"pl-3"},["+"])," "]),(0,s.h)("v-text-field",{style:{marginBottom:"43px"},attrs:{"hide-details":!0,"single-line":!0,width:"20%",type:"number",filled:!0},on:{change:e=>{this.onChangeTimeUnitOrIncrement(e,t.timeUnit,t.internalName)}},class:"px-1",model:{value:t.increment,callback:e=>{this.$set(t,"increment",e)}}}),(0,s.h)("v-select",{style:{marginBottom:"43px"},attrs:{"hide-details":!0,width:"30%",items:this.timeUnit,"item-value":"value","item-text":"title",filled:!0},on:{change:e=>{this.onChangeTimeUnitOrIncrement(t.increment,e,t.internalName)}},model:{value:t.timeUnit,callback:e=>{this.$set(t,"timeUnit",e)}}})])}render(){this.omniaTheming.promoted.body.dark;return(0,s.h)("div",[(0,s.h)("omfx-blade-header",{attrs:{journey:this.journey,title:this.loc.Properties}}),(0,s.h)("v-container",{attrs:{fluid:!0}},[(0,s.h)("v-row",{attrs:{align:"center","no-gutters":!0}},[(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("omfx-enterprisepropertyset-picker",{attrs:{label:"Property Set"},domProps:{preSelectedPropertySetId:this.appTemplate.properties.enterprisePropertySetId,onChange:e=>{this.appTemplate.properties.enterprisePropertySetId=e,this.appTemplate.properties.defaultEnterprisePropertySetValues={},this.defaultPropertySetValue[e.toString()]&&(this.appTemplate.properties.defaultEnterprisePropertySetValues=this.defaultPropertySetValue[e.toString()]),this.ensurePropertiesOfSet()}}})]),this.propertiesToRender.map((e=>this.renderProperty(e))),(0,s.h)("span",{style:{color:"rgba(255,0,0)"}},[this.errorMessage]),(0,s.h)("v-col",{attrs:{cols:"12"},class:"text-right"},[(0,s.h)("omfx-button",{attrs:{contentClass:"shrink ml-2",dark:this.omniaTheming.promoted.body.dark,loading:this.isSaving,text:this.omniaUxLoc.Common.Buttons.Save},domProps:{mode:n.ButtonModes.flat,onClick:()=>{this.onSave()}}})])])])])}};A([(0,r.Prop)()],I.prototype,"journey",2),A([(0,r.Prop)()],I.prototype,"settings",2),A([(0,o.Inject)(p.OmniaTheming)],I.prototype,"omniaTheming",2),A([(0,o.Localize)("Omnia.Ux")],I.prototype,"omniaUxLoc",2),A([(0,o.Inject)(d.AppStore)],I.prototype,"appStore",2),A([(0,o.Inject)(T.EnterprisePropertySetService)],I.prototype,"propertySetService",2),A([(0,o.Inject)(d.EnterprisePropertyStore)],I.prototype,"enterprisePropertyStore",2),A([(0,o.Inject)(d.TargetingPropertyStore)],I.prototype,"targetingPropertyStore",2),A([(0,o.Inject)(d.MultilingualStore)],I.prototype,"multilingualStore",2),A([(0,o.Localize)(l.AppBladeBuilderLocalization.namespace)],I.prototype,"loc",2),A([(0,o.Localize)(v.namespace)],I.prototype,"propertiesSelectionLoc",2),I=A([a.default],I);const x={cancelButtonDisplay:(0,i("./node_modules/typestyle/umd/typestyle.js").style)({display:"none !important"})};var B,O=Object.defineProperty,j=Object.getOwnPropertyDescriptor,C=(e,t,i,s)=>{for(var a,o=s>1?void 0:s?j(t,i):t,p=e.length-1;p>=0;p--)(a=e[p])&&(o=(s?a(t,i,o):a(o))||o);return s&&o&&O(t,i,o),o};(e=>{let t;var i;let s;var a;let o;var p;let r;var n;let l;var d;(i=t=e.TeamCollaborationAppType||(e.TeamCollaborationAppType={}))[i.SharePointTeamSite=1]="SharePointTeamSite",i[i.Office365Group=2]="Office365Group",i[i.YammerGroup=3]="YammerGroup",i[i.FacebookWorkplaceGroup=4]="FacebookWorkplaceGroup",i[i.SharePointCommunicationSite=5]="SharePointCommunicationSite",i[i.MicrosoftTeam=6]="MicrosoftTeam",(a=s=e.TeamPrivacyOptions||(e.TeamPrivacyOptions={})).Public="Public",a.Private="Private",(p=o=e.GiphyContentRatingType||(e.GiphyContentRatingType={})).Moderate="Moderate",p.Strict="Strict",(n=r=e.InstalledTeamApps||(e.InstalledTeamApps={})).Website="com.microsoft.teamspace.tab.web",n.Planner="com.microsoft.teamspace.tab.planner",n.MicrosoftStream="com.microsoftstream.embed.skypeteamstab",n.MicrosoftForms="81fef3a6-72aa-4648-a763-de824aeafb7d",n.Word="com.microsoft.teamspace.tab.file.staticviewer.word",n.Excel="com.microsoft.teamspace.tab.file.staticviewer.excel",n.PowerPoint="com.microsoft.teamspace.tab.file.staticviewer.powerpoint",n.PDF="com.microsoft.teamspace.tab.file.staticviewer.pdf",n.Wiki="com.microsoft.teamspace.tab.wiki",n.DocumentLibrary="com.microsoft.teamspace.tab.files.sharepoint",n.OneNote="0d820ecd-def2-4297-adad-78056cde7c78",n.PowerBI="com.microsoft.teamspace.tab.powerbi",n.SharePoint="2a527703-1f6f-4559-a332-d8a7d288cd88",(d=l=e.TeamAppsType||(e.TeamAppsType={}))[d.BuiltIn=1]="BuiltIn",d[d.Organization=2]="Organization"})(B||(B={}));let k=class extends p.VueComponentBase{constructor(){super(...arguments),this.registerAppProvisioningStepsSubscriptionHandler=null,this.isLoading=!0,this.appDefinition=null,this.appTemplate=null,this.appTemplateTitle="",this.steps=[],this.isSaving=!1,this.isEnableCustomSteps=!1,this.coreSteps=[{...n.AppProvisioningDefaultSteps[0],checked:!0},{...n.AppProvisioningDefaultSteps[1],checked:!0},{...n.AppProvisioningDefaultSteps[2],checked:!0}],this.uncheckFeatureDialogOption={icon:"fas fa-exclamation-circle",title:this.loc.UncheckTitle,message:this.loc.UncheckConfirmation,buttonClass:x.cancelButtonDisplay},this.errorMessage="",this.buildFromScratch=!0}async created(){this.appTemplate=this.appStore.editingAppTemplate.state,this.setStatus(),this.setAppTemplate(),this.setCoreStep();(await omniaApi.fx.ux.appTemplates.steps.registrations).getAppProvisioningStepInfo().forEach((e=>{this.addAdditonalStep(e)})),this.sortStep(),await this.setFeature()}setStatus(){o.Utils.isArrayNullOrEmpty(this.appTemplate.properties.appProvisioningStepInfos)?this.appTemplate.properties.appProvisioningStepInfos=[]:(this.isEnableCustomSteps=!0,this.buildFromScratch=!1)}setAppTemplate(){let e=this.coreSteps[0].weight;this.appTemplate.properties.appProvisioningStepInfos.forEach((t=>{e++;const i={info:t,checked:!0,weight:e};this.steps.push(i)}))}setCoreStep(){this.coreSteps.forEach((e=>{const t=e.info.id.toString().toLowerCase();0===this.steps.filter((e=>e.info.id.toString().toLowerCase()===t)).length&&(e.checked=0===this.appTemplate.properties.appProvisioningStepInfos.length,this.steps.push(e))}))}sortStep(){this.steps.sort(((e,t)=>e.weight-t.weight))}async setFeature(){await this.featureStore.actions.loadFeatureDefinitions.dispatch().then((e=>{this.filterAvailableFeatures(e),this.isLoading=!1,this.$forceUpdate()}))}registerAppProvisioningSteps(e){this.addAdditonalStep(e)}addAdditonalStep(e){if(-1===this.steps.findIndex((t=>t.info.id.toString().toLowerCase()===e.info.id.toString().toLowerCase()))&&(null==e.info.shouldRender||e.info.shouldRender(this.appTemplate))){const t=!!this.buildFromScratch&&e.info.isDefaultStep,i={info:e.info,weight:e.weight,checked:t};this.steps.push(i)}}filterAvailableFeatures(e){const t={id:new n.Guid("00000000-0000-0000-0000-000000000000"),title:"",elementToRender:"",appDefinitionId:"",isFeature:!0},i={info:t,checked:0===this.steps.filter((e=>1==e.info.isFeature)).length,weight:250},s=[];this.appTemplate?.features?.length>0&&this.appTemplate.features.forEach((t=>{const i=e.filter((e=>e.id==t&&null!==e.uiOptions&&!o.Utils.isNullOrEmpty(e.uiOptions.customRendererElement)));i.length>0&&s.push(i[0])})),s.forEach((e=>{0===this.steps.filter((t=>t.info.id==e.id)).length&&(t.id=e.id,t.title=e.title,i.info=t,this.steps.push(i))})),this.buildCheckedItemList()}buildCheckedItemList(){this.appTemplate.properties.appProvisioningStepInfos=[];for(let e=0;e<this.steps.length;e++)this.steps[e].checked&&(this.steps[e].info.appDefinitionId=this.appTemplate.appDefinitionId,this.steps[e].info.title=o.Utils.isNullOrEmpty(this.steps[e].inputTitle)?this.steps[e].info.title:this.steps[e].inputTitle,this.appTemplate.properties.appProvisioningStepInfos.push(this.steps[e].info))}onSave(){this.isSaving=!0,this.isEnableCustomSteps?this.buildCheckedItemList():this.appTemplate.properties.appProvisioningStepInfos=[],this.settings.validator?this.settings.validator(this.appTemplate).then((e=>{e.isValid?this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()})):(this.errorMessage=e.message,this.isSaving=!1)})):this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()}))}renderSteps(){return(0,s.h)("draggable",{attrs:{options:{handle:".drag-handle",animation:"500"}},style:"width: 100%",model:{value:this.steps,callback:e=>{this.steps=e}}},[this.steps.map((e=>(0,s.h)("div",{class:"flex xs12 layout ml-2"},[(0,s.h)("v-col",{attrs:{cols:"6"}},[(0,s.h)("v-checkbox",{attrs:{label:e.info.isFeature?this.loc.Feature+": "+this.localizationService.transform(e.info.title):this.localizationService.transform(e.info.title),"input-value":e.checked},on:{change:()=>{this.onStepCheckedChange(e)}}})]),(0,s.h)("v-col",{attrs:{cols:"5"}},[(0,s.h)("v-text-field",{attrs:{placeholder:this.localizationService.transform(e.info.title)},model:{value:e.inputTitle,callback:t=>{this.$set(e,"inputTitle",t)}}})]),(0,s.h)("v-col",{attrs:{cols:"1"},class:"text-right",style:{margin:"auto"}},[(0,s.h)("v-btn",{attrs:{icon:!0},class:"mr-0",style:{color:"rgba(0,0,0,0.54)"},on:{click:()=>{}}},[(0,s.h)("v-icon",{class:"drag-handle",attrs:{size:"18"}},["fas fa-grip-lines"])])])])))])}onEnableCustomStepsChange(){this.isEnableCustomSteps=!this.isEnableCustomSteps}onStepCheckedChange(e){!0===e.info.isFeature&&!0===e.checked&&this.$confirm.open(this.uncheckFeatureDialogOption).then((e=>{p.ConfirmDialogResponse.Ok})),e.checked=!e.checked,this.buildCheckedItemList()}render(){return(0,s.h)("div",[(0,s.h)("omfx-blade-header",{attrs:{journey:this.journey,title:this.loc.CustomSteps}}),(0,s.h)("v-container",{attrs:{fluid:!0}},[this.isLoading?(0,s.h)("div",{class:"text-center"},[(0,s.h)("v-progress-circular",{attrs:{indeterminate:!0}})]):(0,s.h)("v-row",{attrs:{"no-gutters":!0}},[(0,s.h)("v-col",{attrs:{cols:"12"}},[(0,s.h)("v-checkbox",{attrs:{label:this.loc.EnableCutomSteps,"input-value":this.isEnableCustomSteps},on:{change:()=>{this.onEnableCustomStepsChange()}}})]),this.isEnableCustomSteps?this.renderSteps():null,(0,s.h)("span",{style:{color:"rgba(255,0,0)"}},[this.errorMessage]),(0,s.h)("v-col",{attrs:{cols:"12"},class:"text-right"},[(0,s.h)("omfx-button",{attrs:{contentClass:"shrink ml-2",text:this.omniaUxLoc.Common.Buttons.Save,loading:this.isSaving},domProps:{mode:n.ButtonModes.flat,onClick:()=>{this.onSave()}}})])])])])}};C([(0,r.Prop)()],k.prototype,"journey",2),C([(0,r.Prop)()],k.prototype,"settings",2),C([(0,o.Localize)("Omnia.Ux")],k.prototype,"omniaUxLoc",2),C([(0,o.Localize)(l.AppBladeBuilderLocalization.namespace)],k.prototype,"loc",2),C([(0,o.Inject)(d.AppStore)],k.prototype,"appStore",2),C([(0,o.Inject)(p.OmniaTheming)],k.prototype,"omniaTheming",2),C([(0,o.Inject)(d.FeatureStore)],k.prototype,"featureStore",2),C([(0,o.Inject)(T.LocalizationService)],k.prototype,"localizationService",2),k=C([a.default],k);var U=i("./client/fx/ux/uxmodels.js"),L=Object.defineProperty,D=Object.getOwnPropertyDescriptor,w=(e,t,i,s)=>{for(var a,o=s>1?void 0:s?D(t,i):t,p=e.length-1;p>=0;p--)(a=e[p])&&(o=(s?a(t,i,o):a(o))||o);return s&&o&&L(t,i,o),o};let V=class extends p.VueComponentBase{constructor(){super(...arguments),this.namingPolicySelections=[],this.appTemplate=null,this.errorMessage="",this.isSaving=!1,this.minimumNumberOfAdministratorOptions=[1,2,3,4,5]}created(){this.appTemplate=this.appStore.editingAppTemplate.state;let e={namingPolicyId:null,minimumDescriptionLength:null,minimumNumberOfAdministrators:1,defaultAdministrators:[]};this.appTemplate.properties.policies&&(e=(0,p.mergeObjects)(this.appTemplate.properties.policies,null,null,null,e)),this.$set(this.appTemplate.properties,"policies",e),this.settings.policies.enableNamingPolicy&&this.appNamingPolicyStore.actions.ensureLoad.dispatch(this.settings.appDefinitionId).then((()=>{const e=this.appNamingPolicyStore.getters.getByAppDefinitionId(this.settings.appDefinitionId);this.namingPolicySelections=e.map((e=>({id:e.id,label:e.definition.title})))}))}onSave(){this.isSaving=!0,this.settings.validator?this.settings.validator(this.appTemplate).then((e=>{e.isValid?this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()})):(this.errorMessage=e.message,this.isSaving=!1)})):this.appStore.actions.addOrUpdateAppTemplate.dispatch(this.appTemplate).then((e=>{const t=o.Utils.clone(e);this.appTemplate=t,this.appStore.mutations.setEditingAppTemplate(t),this.isSaving=!1,this.journey().travelBack()}))}renderAppendElement(){return this.settings.policies.appendElement?this.settings.policies.appendElement(this.appTemplate,this):null}renderMinimumDescriptionLength(){return(0,s.h)("v-text-field",{attrs:{type:"number",min:"0",label:this.omniaUxLoc.Apps.Policies.MinimumDescriptionLength,value:this.appTemplate.properties.policies.minimumDescriptionLength},on:{input:e=>{this.appTemplate.properties.policies.minimumDescriptionLength=e?parseInt(e):null}}})}renderDefaultAdmin(){return(0,s.h)("div",[(0,s.h)("v-select",{attrs:{label:this.omniaUxLoc.Apps.Policies.MinimumNumberOfAdministrators,items:this.minimumNumberOfAdministratorOptions},model:{value:this.appTemplate.properties.policies.minimumNumberOfAdministrators,callback:e=>{this.$set(this.appTemplate.properties.policies,"minimumNumberOfAdministrators",e)}}}),(0,s.h)("omfx-people-picker",{attrs:{label:this.omniaUxLoc.Apps.Policies.DefaultAdministrators,multiple:!0},domProps:{valueBind:this.appTemplate.properties.policies.defaultAdministrators,onValueChanged:e=>{this.appTemplate.properties.policies.defaultAdministrators=e},principalType:n.AzureAdObjectPrincipalTypes.Member}})])}render(){return(0,s.h)("v-card",[(0,s.h)("omfx-blade-header",{attrs:{journey:this.journey,title:this.loc.Policies}}),(0,s.h)("v-card-text",[this.settings.policies.enableNamingPolicy&&(0,s.h)("v-select",{attrs:{clearable:!0,"item-value":"id","item-text":"label",items:this.namingPolicySelections,label:this.omniaUxLoc.Apps.NamingPolicies.NamingPolicy},model:{value:this.appTemplate.properties.policies.namingPolicyId,callback:e=>{this.$set(this.appTemplate.properties.policies,"namingPolicyId",e)}}}),this.renderMinimumDescriptionLength(),this.renderDefaultAdmin(),this.renderAppendElement(),this.errorMessage&&(0,s.h)("p",{style:{color:"rgba(255,0,0)"}},[this.errorMessage])]),(0,s.h)("v-card-actions",[(0,s.h)("v-spacer"),(0,s.h)("omfx-button",{attrs:{contentClass:"shrink ml-2",dark:this.theming.body.bg.dark,loading:this.isSaving,text:this.omniaUxLoc.Common.Buttons.Save},domProps:{mode:n.ButtonModes.flat,onClick:()=>{this.onSave()}}})])])}};w([(0,r.Prop)()],V.prototype,"journey",2),w([(0,r.Prop)()],V.prototype,"settings",2),w([(0,o.Inject)(p.OmniaTheming)],V.prototype,"omniaTheming",2),w([(0,o.Localize)(U.OmniaUxLocalizationNamespace)],V.prototype,"omniaUxLoc",2),w([(0,o.Inject)(d.AppStore)],V.prototype,"appStore",2),w([(0,o.Inject)(d.AppNamingPolicyStore)],V.prototype,"appNamingPolicyStore",2),w([(0,o.Localize)(l.AppBladeBuilderLocalization.namespace)],V.prototype,"loc",2),V=w([a.default],V);var E=Object.defineProperty,M=Object.getOwnPropertyDescriptor,F=(e,t,i,s)=>{for(var a,o=s>1?void 0:s?M(t,i):t,p=e.length-1;p>=0;p--)(a=e[p])&&(o=(s?a(t,i,o):a(o))||o);return s&&o&&E(t,i,o),o};let N=class extends p.VueComponentBase{constructor(){super(...arguments),this.visibleBlades=[],this.items=[],this.selectedItem=-1,this.generalMenuItemId=new n.Guid("3e4567a1-f9bc-4dcb-82f5-8dc9271788bd")}created(){if(this.initAppTemplateData(),this.getVisibleBlade(),this.getGeneralBlade(),this.getPropertiesBlade(),this.getFeaturesBlade(),this.getCustomStepsBlade(),this.getPoliciesBlade(),this.items=this.getDefaultMenuItems(),this.addMenuItems(),this.onAppTemplatesChangedUnSubscribe=this.appStore.editingAppTemplate.onMutated((e=>{this.selectedItem=-1,this.initAppTemplateData(),this.$forceUpdate()})),!this.appTemplate.id){this.selectedItem=0;const e=this.items.find((e=>e.id===this.generalMenuItemId));e.onClick(e,this.journey())}}mounted(){o.WebComponentBootstrapper.registerElementInstance(this,this.$el)}initAppTemplateData(){this.appTemplate=Object.assign({},this.appStore.editingAppTemplate.state)}addMenuItems(){this.settings.appendMenuItems&&this.settings.appendMenuItems.forEach((e=>{this.items.push(e)})),this.items.sort(((e,t)=>(e.order||100)-(t.order||100)))}getVisibleBlade(){this.journey().visibleBlades.forEach((e=>{this.visibleBlades.push(e.id)}))}getGeneralBlade(){this.journey().hasBlade(l.AppTemplateBladeIds.general)||this.journey().addOrUpdateBlade({id:l.AppTemplateBladeIds.general,size:n.BladeSizes.medium,content:()=>(0,s.h)(u,{attrs:{journey:this.journey,settings:this.settings}})})}getPropertiesBlade(){this.journey().hasBlade(l.AppTemplateBladeIds.properties)||this.journey().addOrUpdateBlade({id:l.AppTemplateBladeIds.properties,size:n.BladeSizes.medium,content:()=>(0,s.h)(I,{attrs:{journey:this.journey,settings:this.settings}})})}getFeaturesBlade(){this.journey().hasBlade(l.AppTemplateBladeIds.features)||this.journey().addOrUpdateBlade({id:l.AppTemplateBladeIds.features,size:n.BladeSizes.medium,content:()=>(0,s.h)(y,{attrs:{journey:this.journey,settings:this.settings}})})}getCustomStepsBlade(){this.journey().hasBlade(l.AppTemplateBladeIds.customSteps)||this.journey().addOrUpdateBlade({id:l.AppTemplateBladeIds.customSteps,size:n.BladeSizes.medium,content:()=>(0,s.h)(k,{attrs:{journey:this.journey,settings:this.settings}})})}getPoliciesBlade(){this.journey().hasBlade(l.AppTemplateBladeIds.policies)||this.journey().addOrUpdateBlade({id:l.AppTemplateBladeIds.policies,size:n.BladeSizes.medium,content:()=>(0,s.h)(V,{attrs:{journey:this.journey,settings:this.settings}})})}getDefaultMenuItems(){const e=[{id:this.generalMenuItemId,title:this.loc.General,icon:new n.FontAwesomeIcon("fas fa-info-circle"),onClick:()=>this.onSelect(l.AppTemplateBladeIds.general),order:100},{id:new n.Guid("39672ee6-a536-4778-8f37-3e4f8e2318fc"),title:this.loc.Properties,icon:new n.FontAwesomeIcon("fa fa-tags"),onClick:()=>this.onSelect(l.AppTemplateBladeIds.properties),order:200},{id:new n.Guid("b002b37c-eedb-47de-b18b-4a984c5f4872"),title:this.loc.Features,icon:new n.FontAwesomeIcon("far fa-cubes"),onClick:()=>this.onSelect(l.AppTemplateBladeIds.features),order:300},{id:new n.Guid("cb662528-12a4-4aae-9a5d-2568ff0a4d12"),title:this.loc.CustomSteps,icon:new n.FontAwesomeIcon("fa fa-magic"),onClick:()=>this.onSelect(l.AppTemplateBladeIds.customSteps),order:500}];return this.settings.policies?.enable&&e.push({id:new n.Guid("43ba42e1-03d7-4d5f-a999-ffbecf181672"),title:this.loc.Policies,icon:new n.FontAwesomeIcon("far fa-file-alt"),onClick:()=>this.onSelect(l.AppTemplateBladeIds.policies),order:600}),e}onSelect(e){switch(e){case l.AppTemplateBladeIds.general:{const e=o.Utils.clone(this.visibleBlades);e.push(l.AppTemplateBladeIds.general),this.journey().travelTo(e);break}case l.AppTemplateBladeIds.properties:{const e=o.Utils.clone(this.visibleBlades);e.push(l.AppTemplateBladeIds.properties),this.journey().travelTo(e);break}case l.AppTemplateBladeIds.features:{const e=o.Utils.clone(this.visibleBlades);e.push(l.AppTemplateBladeIds.features),this.journey().travelTo(e);break}case l.AppTemplateBladeIds.customSteps:{const e=o.Utils.clone(this.visibleBlades);e.push(l.AppTemplateBladeIds.customSteps),this.journey().travelTo(e);break}case l.AppTemplateBladeIds.policies:{const e=o.Utils.clone(this.visibleBlades);e.push(l.AppTemplateBladeIds.policies),this.journey().travelTo(e);break}}}render(){return(0,s.h)("div",{style:{height:"100%"}},[(0,s.h)("omfx-blade-header",{attrs:{journey:this.journey,title:this.appTemplate.title?this.multilingualTextsStore.getters.stringValue(this.appTemplate.title):this.loc.CreateNewTemplate,bladeId:this.bladeId}}),(0,s.h)("v-list",{attrs:{dense:!0}},[(0,s.h)("div",[(0,s.h)("v-list-item-group",{attrs:{value:this.selectedItem,color:"primary"}},[this.items.map(((e,t)=>(0,s.h)("v-list-item",{attrs:{ripple:!0},on:{click:()=>{this.selectedItem=t,e.onClick(e,this.journey())}}},[(0,s.h)("v-list-item-action",{style:{width:"24px"}},[(0,s.h)("omfx-icon",{domProps:{valueBind:e.icon}})]),(0,s.h)("v-list-item-content",[(0,s.h)("v-list-item-title",[e.title])])])))])])])])}};F([(0,r.Prop)()],N.prototype,"journey",2),F([(0,r.Prop)()],N.prototype,"settings",2),F([(0,r.Prop)()],N.prototype,"bladeId",2),F([(0,o.Inject)(p.OmniaTheming)],N.prototype,"omniaTheming",2),F([(0,o.Inject)(d.MultilingualStore)],N.prototype,"multilingualTextsStore",2),F([(0,o.Inject)(d.AppStore)],N.prototype,"appStore",2),F([(0,o.Localize)(l.AppBladeBuilderLocalization.namespace)],N.prototype,"loc",2),N=F([a.default],N);var z=Object.defineProperty,G=Object.getOwnPropertyDescriptor,W=(e,t,i,s)=>{for(var a,o=s>1?void 0:s?G(t,i):t,p=e.length-1;p>=0;p--)(a=e[p])&&(o=(s?a(t,i,o):a(o))||o);return s&&o&&z(t,i,o),o};let R=class extends p.VueComponentBase{constructor(){super(...arguments),this.loading=!0,this.selectedIndex=-1,this.appTemplates=[],this.visibleBlades=[],this.templateDetailBlade={id:l.AppTemplateBladeIds.templateDetail,size:n.BladeSizes.small}}created(){this.appStore.actions.loadAppTemplates.dispatch().then((()=>{this.loading=!1,this.appTemplates=this.appStore.getters.getAppTemplatesByDefinition(this.settings.appDefinitionId),this.getGeneralBlade(),this.journey().hasBlade(this.templateDetailBlade.id)||(this.templateDetailBlade.content=()=>(0,s.h)(N,{attrs:{journey:this.journey,settings:this.settings,bladeId:this.templateDetailBlade.id}}),this.journey().addOrUpdateBlade(this.templateDetailBlade))})),this.subscriptionHandler.add(this.appStore.appTemplates.onMutated((e=>{this.appTemplates=this.appStore.getters.getAppTemplatesByDefinition(this.settings.appDefinitionId),setTimeout((()=>{const e=this.appStore.editingAppTemplate.state?this.appStore.editingAppTemplate.state.id:-1;-1!=e&&(this.selectedIndex=this.appTemplates.findIndex((t=>t.id===e)))}),200)})))}getVisibleBlade(){this.visibleBlades=[];this.journey().visibleBlades.forEach((e=>{this.visibleBlades.push(e.id)}))}getGeneralBlade(){if(!this.journey().hasBlade(l.AppTemplateBladeIds.general)){const e={id:l.AppTemplateBladeIds.general,size:n.BladeSizes.medium,content:()=>(0,s.h)(u,{attrs:{journey:this.journey,settings:this.settings}})};this.journey().addOrUpdateBlade(e)}}openCreateTemplateBlade(){const e=this.createTemplate();this.settings.beforeCreate&&this.settings.beforeCreate(e),this.onSelect(e)}createTemplate(){return this.settings.appendMenuItems?{title:void 0,appDefinitionId:this.settings.appDefinitionId,icons:[{iconType:n.IconTypes.FontAwesome}],properties:{approvers:[],permissionLevel:n.AppTemplatePermissionLevel.SeftService,appProvisioningStepInfos:[],setups:{pageCollections:[],publishingAppSettings:{enabledAllowReuseContent:!1,pagePropertyMappingSetting:{contact:"",reviewDate:""},achievementLevels:[],enableAchievements:!1,statistics:{pageScript:"",siteScript:""},appPermission:[],allowMobileLogin:!1}}}}:{title:void 0,appDefinitionId:this.settings.appDefinitionId,icons:[{iconType:n.IconTypes.FontAwesome}],properties:{approvers:[],permissionLevel:n.AppTemplatePermissionLevel.SeftService,appProvisioningStepInfos:[]}}}onSelect(e){const t=o.Utils.clone(e);this.appStore.mutations.setEditingAppTemplate(t),this.getVisibleBlade(),this.visibleBlades.some((e=>e===l.AppTemplateBladeIds.templateDetail))?this.journey().travelBackTo(l.AppTemplateBladeIds.templateDetail):this.visibleBlades.some((e=>e===l.AppTemplateBladeIds.general))&&!this.visibleBlades.some((e=>e===l.AppTemplateBladeIds.templateDetail))?this.journey().travelTo([this.visibleBlades[0],this.visibleBlades[1],l.AppTemplateBladeIds.templateDetail]):(this.visibleBlades.push(l.AppTemplateBladeIds.templateDetail),this.journey().travelTo(this.visibleBlades))}renderIcon(e){return e&&(0,s.h)("omfx-icon",{domProps:{valueBind:e,iconAttrs:{size:24}}})}removeTemplate(e){this.$confirm.open({icon:"fas fa-exclamation-triangle",title:this.loc.DeleteAppTemplateTitle.replace("{0}",this.multiLingualStore.getters.stringValue(e.title)),message:this.loc.DeleteAppTemplateConfirmation}).then((t=>{t===p.ConfirmDialogResponse.Ok&&this.appStore.actions.removeAppTemplate.dispatch(e.id).then((()=>{this.appTemplates=this.appStore.getters.getAppTemplatesByDefinition(this.settings.appDefinitionId)}))}))}render(){return(0,s.h)("div",{style:{height:"100%"}},[(0,s.h)("omfx-blade-header",{attrs:{journey:this.journey,title:this.loc.Templates,prependIcons:[(0,s.h)("omfx-button",{domProps:{onClick:()=>{this.openCreateTemplateBlade()},mode:n.ButtonModes.icon,icon:{iconType:new n.FontAwesomeIcon("add")}},attrs:{dark:this.omniaTheming.promoted.header.dark}})]}}),(0,s.h)("v-list",{attrs:{dense:!0}},[(0,s.h)("v-skeleton-loader",{attrs:{loading:this.loading,height:"50%",type:"list-item-avatar,list-item-avatar,list-item-avatar,list-item-avatar,list-item-avatar,list-item-avatar"},class:this.theming.chrome.components.skeletonLoader.css},[(0,s.h)("div",[(0,s.h)("v-list-item-group",{attrs:{color:"primary"},model:{value:this.selectedIndex,callback:e=>{this.selectedIndex=e}}},[this.appTemplates.map((e=>(0,s.h)("v-list-item",{attrs:{ripple:!0},on:{click:()=>this.onSelect(e)}},[(0,s.h)("v-list-item-action",{style:{width:"24px"}},[this.renderIcon(e.icons[0])]),(0,s.h)("v-list-item-content",[(0,s.h)("v-list-item-title",[this.multilingualTextsStore.getters.stringValue(e.title)])]),(0,s.h)("v-list-item-action",{class:"ma-0"},[(0,s.h)("omfx-button",{attrs:{contentClass:"mr-0"},domProps:{onClick:t=>{t.stopPropagation(),this.removeTemplate(e)},icon:{iconType:new n.FontAwesomeIcon("fal fa-trash-alt"),small:!0},preset:p.ButtonPresets.base.smallIcon}})])])))])])])])])}};W([(0,r.Prop)()],R.prototype,"journey",2),W([(0,r.Prop)()],R.prototype,"settings",2),W([(0,o.Inject)(o.SubscriptionHandler)],R.prototype,"subscriptionHandler",2),W([(0,o.Inject)(p.OmniaTheming)],R.prototype,"omniaTheming",2),W([(0,o.Inject)(d.AppStore)],R.prototype,"appStore",2),W([(0,o.Inject)(d.MultilingualStore)],R.prototype,"multilingualTextsStore",2),W([(0,o.Inject)(d.MultilingualStore)],R.prototype,"multiLingualStore",2),W([(0,o.Localize)(l.AppBladeBuilderLocalization.namespace)],R.prototype,"loc",2),R=W([a.default],R),o.WebComponentBootstrapper.registerElement((e=>{(0,o.vueCustomElement)(e.elementName,R)}));class ${constructor(){this.providers=[]}getAppProvisioningStepInfo(){return this.providers}registerAppProvisioningStepInfo(e){this.providers.push(e)}}(0,o.registerApi)((e=>e.fx.ux.appTemplates.steps.registrations),(e=>e(new $)))},"./client/fx/ux/app/builders/core/index.js":(e,t,i)=>{e.exports=i("dll-reference md31")("./client/fx/ux/app/builders/core/index.js")},"./client/fx/ux/uxmodels.js":(e,t,i)=>{e.exports=i("dll-reference md66")("./client/fx/ux/uxmodels.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/typestyle/umd/typestyle.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/typestyle/umd/typestyle.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,i)=>{e.exports=i("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,i)=>{e.exports=i("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,i)=>{e.exports=i("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,i)=>{e.exports=i("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,i)=>{e.exports=i("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md31":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["d3fc9400-4049-4fe0-9f26-6d03f825b4a6"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["8cac4134-eacf-4089-89fc-a797cf7589b2"])throw new Error("Error, already loaded manifest 8cac4134-eacf-4089-89fc-a797cf7589b2 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["8cac4134-eacf-4089-89fc-a797cf7589b2"]=i;var t={};function i(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};i("./client/fx/ux/app/builders/blades/apptemplatebladebuilder.tsx")})()};