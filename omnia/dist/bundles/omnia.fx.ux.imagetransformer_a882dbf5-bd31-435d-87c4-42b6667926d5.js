if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["a882dbf5-bd31-435d-87c4-42b6667926d5"])throw new Error("Error, already loaded manifest a882dbf5-bd31-435d-87c4-42b6667926d5 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["a882dbf5-bd31-435d-87c4-42b6667926d5"]=function(){(()=>{var t={"./client/fx/ux/imagetransformer/imagetransformer.tsx":(t,e,i)=>{"use strict";i.r(e),i.d(e,{ImageTransformer:()=>X});var o=i("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),a=i("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),s=i("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),n=i("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","a882dbf5-bd31-435d-87c4-42b6667926d5"),r=i("./client/fx/ux/imagetransformer/imagetransformer.css.js"),l=i("./client/fx/ux/imagetransformer/loc/localize.js"),h=i("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","a882dbf5-bd31-435d-87c4-42b6667926d5"),d=i("./client/fx/ux/styleflow.js"),m=i("./client/fx/ux/models/index.js"),c=i("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),p=i("./node_modules/@vue/babel-helper-vue-jsx-merge-props/dist/helper.js"),g=i.n(p),f=i("./client/fx/ux/imagetransformation/utils.js"),u=i("5e618f4d-d014-414e-a681-89e34cbeda0f"),b=i("./client/fx/ux/imagetransformer/tui-image-editor/index.js"),I=i("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),C=Object.defineProperty,R=Object.getOwnPropertyDescriptor,T=(t,e,i,o)=>{for(var a,s=o>1?void 0:o?R(e,i):e,n=t.length-1;n>=0;n--)(a=t[n])&&(s=(o?a(e,i,s):a(s))||s);return o&&s&&C(e,i,s),s};let v=class extends h.VueComponentBase{constructor(){super(...arguments),this.selectedRatio=null,this.selectedRendition=null,this.editorId=c.Guid.newGuid().toString(),this.availableImageRatios=null,this.sourceImageInformation=null,this.isLoading=!0,this.editingRenditionData=null}sourceImageChanged(t,e){t!==e&&(this.removeEditor(),this.initImageEditor())}shareableRenditionsChanged(){if(this.editingRenditionData&&(this.shareableRenditions.forEach((t=>{const e=this.editingRenditionData.find((e=>e.renditionId==t.imageRatioId));e&&(e.height=t.height,e.width=t.width,e.positionLeft=t.positionLeft,e.positionTop=t.positionTop)})),this.updateRenditionDataChange(),this.selectedRatio&&this.selectedRatio.id==this.selectedRenditionId.value)){const t=this.availableImageRatios.find((t=>t.id===this.selectedRenditionId.value));t&&this.setSelectedImageRatio(t)}}mounted(){this.init()}beforeDestroy(){this.removeEditor()}removeEditor(){this.editorInstance&&(this.editorInstance.stopDrawingMode(),this.editorInstance.destroy())}init(){this.availableImageRatios=[],this.rollupRatios&&this.mediaPickerStore.actions.ensureImageRatios.dispatch().then((()=>{const t=this.mediaPickerStore.getters.rollupRatios();t&&(this.rollupRatios.forEach((e=>{const i=t.find((t=>t.uniqueId==e.uniqueId));i&&this.availableImageRatios.push(i)})),this.availableImageRatios.length>0&&this.$nextTick((()=>{this.initImageEditor()})))}))}initImageEditor(){this.mediaPickerService.getMediaPickerImageInformation(this.sourceImage).then((t=>{this.sourceImageInformation=t,n.Utils.waitForElementAvailable(this.$el,this.editorId,(()=>{this.isLoading=!1,this.maxImageHeight=parseInt((0,f.getComputedProp)(this.editorId,"height").toString().split(".").shift()),this.maxImageWidth=parseInt((0,f.getComputedProp)(this.editorId,"width").toString().split(".").shift());const t=this.$refs.tuiImageEditorRollup;this.editorInstance=new b.ImageEditor(t,{usageStatistics:!1,cssMaxHeight:this.maxImageHeight}),this.loadImage(),this.ensureImageRenditionData()}))}))}resizeCanvasDimension(){const t=t=>{let e=-1,i=0,o=0;do{e++,o=t-e,i=o*this.sourceImageInformation.width/this.sourceImageInformation.height}while(i>this.maxImageWidth);return{newWidth:i,newHeight:o}};let e;return new Promise(((i,o)=>{e=t(this.maxImageHeight),this.editorInstance.resizeCanvasDimension({width:e.newWidth,height:e.newHeight}).then((()=>{i()}))}))}ensureImageRenditionData(){if(this.editingRenditionData=[],this.availableImageRatios&&this.availableImageRatios.length>0){let t=!1;this.availableImageRatios.forEach((e=>{let i=null;if(this.sourceRenditionData&&(i=this.sourceRenditionData.find((t=>t.renditionId==e.id))),i){const t=this.availableImageRatios.find((t=>t.id==e.id)),o=t?t.x/t.y:null;i.height=i.width/o}else i={renditionId:e.id,positionLeft:0,positionTop:0,width:0,height:0},t=!0;this.editingRenditionData.push(i),this.saveCropState(i),this.updateRenditionDataChange()})),t&&this.updateRenditionDataChange()}}onInitCropperEvent(){const t=e=>{if(this.editorInstance.isValidCropzoneRect())this.updateCurrentRenditionData(e);else{this.isShowWarningDialog.value=!0;const e=this.selectedRatio.x/this.selectedRatio.y;this.editorInstance.setCropzoneRect(e),t(this.editorInstance.getCropzoneRect())}};this.editorInstance.on("mouseup",(e=>{t(e)}))}loadImage(){if(this.sourceImage){const t=this.mediaPickerService.ensureBase64String(this.sourceImage.base64,this.sourceImage.fileName);this.editorInstance.loadImageFromURL(t,"image").then((()=>{this.resizeCanvasDimension().then((()=>{this.editorInstance.startDrawingMode("CROPPER").then((()=>{this.setSelectedImageRatio(this.availableImageRatios[0]),this.onInitCropperEvent()}))}))}))}}setSelectedImageRatio(t){if(this.editorInstance)if(this.selectedRatio=t,this.selectedRendition=this.editingRenditionData.find((e=>e.renditionId===t.id)),this.selectedRendition.width>0&&this.selectedRendition.height>0)this.saveCropState(this.selectedRendition),this.editorInstance.restoreCropzoneRect(this.selectedRatio.x/this.selectedRatio.y,{top:this.selectedRendition.positionTop,left:this.selectedRendition.positionLeft,width:this.selectedRendition.width,height:this.selectedRendition.height});else{const e=this.getCropState(t.id);if(e&&(this.selectedRendition={renditionId:e.imageRatioId,height:e.height,width:e.width,positionLeft:e.positionLeft,positionTop:e.positionTop}),this.selectedRendition&&this.selectedRendition.width>0&&this.selectedRendition.height>0)this.saveCropState(this.selectedRendition),this.editorInstance.restoreCropzoneRect(this.selectedRatio.x/this.selectedRatio.y,{top:this.selectedRendition.positionTop,left:this.selectedRendition.positionLeft,width:this.selectedRendition.width,height:this.selectedRendition.height});else{this.editorInstance.setCropzoneRect(this.selectedRatio.x/this.selectedRatio.y);const t=this.editorInstance.getCropzoneRect();this.setImageRenditionDataProps(t,this.selectedRendition),this.updateRenditionDataChange()}}}setImageRenditionDataProps(t,e){t&&e&&(e.width=t.width,e.height=t.height,e.positionLeft=t.left,e.positionTop=t.top)}updateCurrentRenditionData(t){this.setImageRenditionDataProps(t,this.selectedRendition),this.saveCropState(this.selectedRendition),this.updateRenditionDataChange()}updateRenditionDataChange(){if(this.renditionDataChangedCallback){const t=n.Utils.clone(this.editingRenditionData);t.forEach((t=>{t.width=Math.floor(t.width),t.height=Math.floor(t.height),t.positionLeft=Math.floor(t.positionLeft),t.positionTop=Math.floor(t.positionTop)})),this.renditionDataChangedCallback(t)}}saveCropState(t){if(this.shareableRenditions&&t&&t.height>0&&t.width>0){const e=this.shareableRenditions.find((e=>e.imageRatioId===t.renditionId));e?(e.height=t.height,e.width=t.width,e.positionLeft=t.positionLeft,e.positionTop=t.positionTop):this.shareableRenditions.push({imageRatioId:t.renditionId,type:c.MediaPickerEnums.MediaPickerTransformationTypes.Crop,height:t.height,width:t.width,positionLeft:t.positionLeft,positionTop:t.positionTop})}}getCropState(t){let e=null;return this.shareableRenditions&&(e=this.shareableRenditions.find((e=>e.imageRatioId===t))),e}render(){return this.availableImageRatios&&this.availableImageRatios.length>0?(0,o.h)("div",[(0,o.h)("h2",{class:"font-weight-light pa-4"},[this.loc.Rollup]),(0,o.h)("v-tabs",{attrs:{"fixed-tabs":!0,"hide-slider":!this.theming.body.bg.dark,dark:this.theming.body.bg.dark,color:this.theming.body.components.color.base,"background-color":this.theming.body.bg.color.base},class:this.theming.body.components.tabs.css},[this.availableImageRatios.map((t=>{const e=this.multilingualStore.getters.stringValue(t.title);return(0,o.h)("v-tab",{on:{click:()=>{this.setSelectedImageRatio(t)}}},[(0,o.h)("v-tooltip",g()([{attrs:{top:!0,lazy:!0}},this.transformVSlot({activator:t=>{const i={on:t.on};return[(0,o.h)("span",g()([{},i]),[e])]}})]),[(0,o.h)("span",[e])])])}))]),(0,o.h)("div",{class:"image-container",style:"border-top:20px solid rgba(33, 33, 33, 0.07);border-bottom:20px solid rgba(33, 33, 33, 0.07)"},[(0,o.h)("div",{attrs:{id:this.editorId},ref:"tuiImageEditorRollup",class:["image-editor",this.isLoading&&"isLoading"]}),this.isLoading&&(0,o.h)("v-skeleton-loader",{attrs:{type:"image"}})])]):null}};T([(0,s.Prop)()],v.prototype,"sourceImage",2),T([(0,s.Prop)()],v.prototype,"sourceRenditionData",2),T([(0,s.Prop)()],v.prototype,"rollupRatios",2),T([(0,s.Prop)()],v.prototype,"renditionDataChangedCallback",2),T([(0,s.Prop)()],v.prototype,"shareableRenditions",2),T([(0,s.Prop)()],v.prototype,"selectedRenditionId",2),T([(0,s.Prop)()],v.prototype,"isShowWarningDialog",2),T([(0,n.Inject)(h.OmniaTheming)],v.prototype,"omniaTheming",2),T([(0,n.Inject)(u.MultilingualStore)],v.prototype,"multilingualStore",2),T([(0,n.Localize)(l.ImageTransformerLocalization.namespace)],v.prototype,"loc",2),T([(0,n.Inject)(u.MediaPickerStore)],v.prototype,"mediaPickerStore",2),T([(0,n.Inject)(I.MediaPickerService)],v.prototype,"mediaPickerService",2),T([(0,s.Watch)("sourceImage.base64")],v.prototype,"sourceImageChanged",1),T([(0,s.Watch)("shareableRenditions",{deep:!0})],v.prototype,"shareableRenditionsChanged",1),v=T([a.default],v);var y=i("./client/fx/ux/imagetransformation/enums.js"),D=Object.defineProperty,x=Object.getOwnPropertyDescriptor,k=(t,e,i,o)=>{for(var a,s=o>1?void 0:o?x(e,i):e,n=t.length-1;n>=0;n--)(a=t[n])&&(s=(o?a(e,i,s):a(s))||s);return o&&s&&D(e,i,s),s};let P=class extends h.VueComponentBase{constructor(){super(...arguments),this.availableImageRatioDefinitions=[],this.internalCropTransformationData=null,this.selectedCropRatio=null,this.customRenditions=null}shareableRenditionsChanged(){this.selectedCropRatio.definition&&this.selectedCropRatio.definition.id==this.selectedRenditionId.value&&this.onSelectCropRatio(this.selectedCropRatio)}mounted(){}created(){this.init()}beforeDestroy(){this.editorInstance._graphics&&this.editorInstance.stopDrawingMode()}init(){if(this.imageTransformationData){const t=this.imageTransformationData.find((t=>t.type==c.MediaPickerEnums.MediaPickerTransformationTypes.Crop));t&&(this.internalCropTransformationData=n.Utils.clone(t))}if(!this.selectableRatios)return;const t=new c.Future(null);t.then((()=>{this.availableImageRatioDefinitions.length>0&&this.editorInstance.startDrawingMode("CROPPER").then((()=>{if(this.internalCropTransformationData){this.internalCropTransformationData.imageRatioId?this.selectedCropRatio=this.availableImageRatioDefinitions.find((t=>t.definition&&t.definition.id==this.internalCropTransformationData.imageRatioId)):this.selectedCropRatio=this.availableImageRatioDefinitions.find((t=>null==t.definition));const t=this.selectedCropRatio&&!this.selectedCropRatio.isCustom?this.selectedCropRatio.definition.x/this.selectedCropRatio.definition.y:null;t?this.internalCropTransformationData.height=this.internalCropTransformationData.width/t:this.customRenditions={type:c.MediaPickerEnums.MediaPickerTransformationTypes.Crop,imageRatioId:null,positionTop:this.internalCropTransformationData.positionTop,positionLeft:this.internalCropTransformationData.positionLeft,width:this.internalCropTransformationData.width,height:this.internalCropTransformationData.height},this.editorInstance.restoreCropzoneRect(t,{top:this.internalCropTransformationData.positionTop,left:this.internalCropTransformationData.positionLeft,width:this.internalCropTransformationData.width,height:this.internalCropTransformationData.height}),this.saveCropState(this.internalCropTransformationData)}this.selectedCropRatio||this.onSelectCropRatio(this.availableImageRatioDefinitions[0]),this.onInitCropperEvent()}))})),0==this.selectableRatios.length?(this.availableImageRatioDefinitions.push({isCustom:!0,definition:null}),t.resolve(null)):this.mediaPickerStore.actions.ensureImageRatios.dispatch().then((()=>{const e=this.mediaPickerStore.getters.imageRatios();e&&e.length>0?this.selectableRatios.forEach((t=>{if(0==t.x&&0==t.y)this.availableImageRatioDefinitions.push({isCustom:!0,definition:null});else{const i=e.find((e=>e.uniqueId==t.uniqueId));i&&this.availableImageRatioDefinitions.push({isCustom:!1,definition:i})}})):this.selectableRatios.find((t=>0==t.x&&0==t.y))&&this.availableImageRatioDefinitions.push({isCustom:!0,definition:null}),t.resolve(null)}))}onCropAreaChanged(t){this.internalCropTransformationData.width==t.width&&this.internalCropTransformationData.height==t.height&&this.internalCropTransformationData.positionLeft==t.left&&this.internalCropTransformationData.positionTop==t.top||(this.internalCropTransformationData.width=t.width,this.internalCropTransformationData.height=t.height,this.internalCropTransformationData.positionLeft=t.left,this.internalCropTransformationData.positionTop=t.top,this.internalCropTransformationData.imageRatioId||(this.customRenditions=this.internalCropTransformationData),this.saveCropState(this.internalCropTransformationData),this.updateImageCropAreaChange())}updateImageCropAreaChange(){if(this.changedImageCropAreaCallback&&this.internalCropTransformationData){const t=n.Utils.clone(this.internalCropTransformationData);t.width=Math.floor(t.width),t.height=Math.floor(t.height),t.positionLeft=Math.floor(t.positionLeft),t.positionTop=Math.floor(t.positionTop),this.changedImageCropAreaCallback(t)}}onInitCropperEvent(){const t=e=>{if(this.editorInstance.isValidCropzoneRect())e&&e.width>0&&e.height>0&&this.onCropAreaChanged(e);else{this.isShowWarningDialog.value=!0;const e=this.selectedCropRatio.definition?this.selectedCropRatio.definition.x/this.selectedCropRatio.definition.y:null;this.editorInstance.setCropzoneRect(e),t(this.editorInstance.getCropzoneRect())}};this.editorInstance.on("mouseup",(e=>{t(e)}))}onSelectCropRatio(t){this.selectedCropRatio=t;const e=this.selectedCropRatio.definition?this.selectedCropRatio.definition.x/this.selectedCropRatio.definition.y:null;if(this.editorInstance.setCropzoneRect(e),this.selectedCropRatio.definition?this.internalCropTransformationData=this.getCropState(this.selectedCropRatio.definition.id):this.internalCropTransformationData=this.customRenditions,this.internalCropTransformationData)this.editorInstance.restoreCropzoneRect(e,{top:this.internalCropTransformationData.positionTop,left:this.internalCropTransformationData.positionLeft,width:this.internalCropTransformationData.width,height:this.internalCropTransformationData.height});else if(e){const t=this.editorInstance.getCropzoneRect();this.generatedCropZone(t,e)}else{const t=this.editorInstance.getCanvasSize();this.generatedCropZone({top:0,left:0,width:t.width,height:t.height}),this.customRenditions=this.internalCropTransformationData}this.updateImageCropAreaChange()}generatedCropZone(t,e){t&&(this.editorInstance.restoreCropzoneRect(e,{top:t.top,left:t.left,width:t.width,height:t.height}),this.internalCropTransformationData={type:c.MediaPickerEnums.MediaPickerTransformationTypes.Crop,imageRatioId:this.selectedCropRatio.definition?this.selectedCropRatio.definition.id:null,width:t.width,height:t.height,positionLeft:t.left,positionTop:t.top})}saveCropState(t){if(this.shareableRenditions&&t&&t.height>0&&t.width>0){const e=this.shareableRenditions.find((e=>e.imageRatioId===t.imageRatioId));e?(e.height=t.height,e.width=t.width,e.positionLeft=t.positionLeft,e.positionTop=t.positionTop):this.shareableRenditions.push(t)}}getCropState(t){let e=null;if(this.shareableRenditions){const i=this.shareableRenditions.find((e=>e.imageRatioId===t));i&&(e=n.Utils.clone(i))}return e}render(){return this.availableImageRatioDefinitions&&this.availableImageRatioDefinitions.length>1&&(0,o.h)("div",{class:["image-editor-menu-option-crop",this.theming.body.bg.css]},[(0,o.h)("v-row",{class:"justify-center"},[this.availableImageRatioDefinitions.map((t=>t.isCustom?(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.onSelectCropRatio(t)},mode:this.selectedCropRatio&&this.selectedCropRatio.isCustom?c.ButtonModes.depressed:c.ButtonModes.flat,styles:{textColor:(this.selectedCropRatio&&this.selectedCropRatio.isCustom,this.theming.body.text.color.base),bgColor:"rgba(33, 33, 33, 0.07)"},size:c.ButtonSizes.large},attrs:{text:this.loc.CustomRatio}}):(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.onSelectCropRatio(t)},mode:this.selectedCropRatio&&this.selectedCropRatio.definition&&this.selectedCropRatio.definition.id==t.definition.id?c.ButtonModes.depressed:c.ButtonModes.flat,styles:{textColor:(this.selectedCropRatio&&this.selectedCropRatio.definition&&(this.selectedCropRatio.definition.id,t.definition.id),this.theming.body.text.color.base),bgColor:this.theming.body.bg.dark?"rgba(0,0,0,0.20)":"rgba(33, 33, 33, 0.07)"},size:c.ButtonSizes.large},attrs:{text:this.multilingualStore.getters.stringValue(t.definition.title)}})))])])}};k([(0,s.Prop)()],P.prototype,"imageTransformationData",2),k([(0,s.Prop)()],P.prototype,"editorInstance",2),k([(0,s.Prop)()],P.prototype,"selectableRatios",2),k([(0,s.Prop)()],P.prototype,"changedImageCropAreaCallback",2),k([(0,s.Prop)()],P.prototype,"shareableRenditions",2),k([(0,s.Prop)()],P.prototype,"selectedRenditionId",2),k([(0,s.Prop)()],P.prototype,"isShowWarningDialog",2),k([(0,n.Inject)(h.OmniaTheming)],P.prototype,"omniaTheming",2),k([(0,n.Localize)(l.ImageTransformerLocalization.namespace)],P.prototype,"loc",2),k([(0,n.Inject)(u.MultilingualStore)],P.prototype,"multilingualStore",2),k([(0,n.Inject)(u.MediaPickerStore)],P.prototype,"mediaPickerStore",2),k([(0,s.Watch)("shareableRenditions",{deep:!0})],P.prototype,"shareableRenditionsChanged",1),P=k([a.default],P);var w=Object.defineProperty,F=Object.getOwnPropertyDescriptor,M=(t,e,i,o)=>{for(var a,s=o>1?void 0:o?F(e,i):e,n=t.length-1;n>=0;n--)(a=t[n])&&(s=(o?a(e,i,s):a(s))||s);return o&&s&&w(e,i,s),s};let S=class extends h.VueComponentBase{constructor(){super(...arguments),this.imageWithoutFlipperTransformationData={type:c.MediaPickerEnums.MediaPickerTransformationTypes.Flip,flipX:!1,flipY:!1},this.currentFlipperTransformationData=null,this.isLoading=!1}created(){this.init()}mounted(){}init(){if(this.imageTransformationData){const t=this.imageTransformationData.find((t=>t.type==c.MediaPickerEnums.MediaPickerTransformationTypes.Flip));t&&(this.currentFlipperTransformationData=n.Utils.clone(t))}this.currentFlipperTransformationData||(this.currentFlipperTransformationData=n.Utils.clone(this.imageWithoutFlipperTransformationData))}onFlipTransformationChanged(){let t=null,e=!1;Object.keys(this.currentFlipperTransformationData).forEach((t=>{this.currentFlipperTransformationData[t]!=this.imageWithoutFlipperTransformationData[t]&&(e=!0)})),e&&(t=n.Utils.clone(this.currentFlipperTransformationData)),this.changedImageConfigurationCallback(t)}render(){return(0,o.h)("div",{class:"image-editor-menu-option-flip"},[(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.currentFlipperTransformationData.flipX=!this.currentFlipperTransformationData.flipX,this.onFlipTransformationChanged()},mode:c.ButtonModes.icon,styles:{textColor:"#fff"},size:c.ButtonSizes.large,tooltip:{text:this.loc.FlipX,position:c.ButtonTooltipPosition.Top}},attrs:{disabled:this.isLoading}},[(0,o.h)("v-icon",["flip"])]),(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.currentFlipperTransformationData.flipY=!this.currentFlipperTransformationData.flipY,this.onFlipTransformationChanged()},mode:c.ButtonModes.icon,styles:{textColor:"#fff"},size:c.ButtonSizes.large,tooltip:{text:this.loc.FlipY,position:c.ButtonTooltipPosition.Top}},attrs:{disabled:this.isLoading},class:"flipY"},[(0,o.h)("v-icon",["flip"])]),(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.currentFlipperTransformationData.flipX=!1,this.currentFlipperTransformationData.flipY=!1,this.onFlipTransformationChanged()},mode:c.ButtonModes.icon,styles:{textColor:"#fff"},size:c.ButtonSizes.large,tooltip:{text:this.loc.Reset,position:c.ButtonTooltipPosition.Top}},attrs:{disabled:this.isLoading}},[(0,o.h)("v-icon",["cached"])])])}};M([(0,s.Prop)()],S.prototype,"imageTransformationData",2),M([(0,s.Prop)()],S.prototype,"changedImageConfigurationCallback",2),M([(0,n.Inject)(h.OmniaTheming)],S.prototype,"omniaTheming",2),M([(0,n.Localize)(l.ImageTransformerLocalization.namespace)],S.prototype,"loc",2),S=M([a.default],S);var B=i("./client/fx/ux/imagetransformation/constants.js"),E=Object.defineProperty,j=Object.getOwnPropertyDescriptor,L=(t,e,i,o)=>{for(var a,s=o>1?void 0:o?j(e,i):e,n=t.length-1;n>=0;n--)(a=t[n])&&(s=(o?a(e,i,s):a(s))||s);return o&&s&&E(e,i,s),s};let z=class extends h.VueComponentBase{constructor(){super(...arguments),this.currentFilterTransformationData=null,this.isLoading=!1,this.imageWithoutFilterTransformationData={type:c.MediaPickerEnums.MediaPickerTransformationTypes.Filter,grayscale:!1,sepia:!1,vintage:!1,emboss:!1,invert:!1,sharpen:!1,removeWhite:B.Constants.DefaultFilterRangeValus.removewhiteDistanceRange.value,brightness:B.Constants.DefaultFilterRangeValus.brightnessRange.value,noise:B.Constants.DefaultFilterRangeValus.noiseRange.value,pixelate:B.Constants.DefaultFilterRangeValus.pixelateRange.value,colorFilter:B.Constants.DefaultFilterRangeValus.colorfilterThresholeRange.value}}created(){this.init()}mounted(){}init(){if(this.imageTransformationData){const t=this.imageTransformationData.find((t=>t.type==c.MediaPickerEnums.MediaPickerTransformationTypes.Filter));t&&(this.currentFilterTransformationData=n.Utils.clone(t))}this.currentFilterTransformationData||(this.currentFilterTransformationData=n.Utils.clone(this.imageWithoutFilterTransformationData))}onFilterTransformationChanged(){let t=null,e=!1;Object.keys(this.currentFilterTransformationData).forEach((t=>{this.currentFilterTransformationData[t]!=this.imageWithoutFilterTransformationData[t]&&(e=!0)})),e&&(t=n.Utils.clone(this.currentFilterTransformationData)),this.changedImageConfigurationCallback(t)}render(){return(0,o.h)("div",{class:"image-editor-menu-option-filter"},[(0,o.h)("v-row",[(0,o.h)("v-col",{attrs:{md:"4"},class:"py-0"},[(0,o.h)("v-row",[(0,o.h)("v-col",{attrs:{md:"6"}},[(0,o.h)("v-checkbox",{attrs:{dark:!0,color:this.omniaTheming.promoted.body.primary.base,label:this.loc.Grayscale,"input-value":this.currentFilterTransformationData.grayscale,"hide-details":!0,disabled:this.isLoading},class:"mt-0",on:{change:()=>{this.currentFilterTransformationData.grayscale=!this.currentFilterTransformationData.grayscale,this.onFilterTransformationChanged()}},model:{value:this.currentFilterTransformationData.grayscale,callback:t=>{this.$set(this.currentFilterTransformationData,"grayscale",t)}}}),(0,o.h)("v-checkbox",{attrs:{dark:!0,color:this.omniaTheming.promoted.body.primary.base,label:this.loc.Sepia,"input-value":this.currentFilterTransformationData.sepia,"hide-details":!0,disabled:this.isLoading},on:{change:()=>{this.currentFilterTransformationData.sepia=!this.currentFilterTransformationData.sepia,this.onFilterTransformationChanged()}},model:{value:this.currentFilterTransformationData.sepia,callback:t=>{this.$set(this.currentFilterTransformationData,"sepia",t)}}}),(0,o.h)("v-checkbox",{attrs:{dark:!0,color:this.omniaTheming.promoted.body.primary.base,label:this.loc.Emboss,"input-value":this.currentFilterTransformationData.emboss,"hide-details":!0,disabled:this.isLoading},on:{change:()=>{this.currentFilterTransformationData.emboss=!this.currentFilterTransformationData.emboss,this.onFilterTransformationChanged()}},model:{value:this.currentFilterTransformationData.emboss,callback:t=>{this.$set(this.currentFilterTransformationData,"emboss",t)}}})]),(0,o.h)("v-col",{attrs:{md:"6"}},[(0,o.h)("v-checkbox",{attrs:{dark:!0,color:this.omniaTheming.promoted.body.primary.base,label:this.loc.Invert,"input-value":this.currentFilterTransformationData.invert,"hide-details":!0,disabled:this.isLoading},class:"mt-0",on:{change:()=>{this.currentFilterTransformationData.invert=!this.currentFilterTransformationData.invert,this.onFilterTransformationChanged()}},model:{value:this.currentFilterTransformationData.invert,callback:t=>{this.$set(this.currentFilterTransformationData,"invert",t)}}}),(0,o.h)("v-checkbox",{attrs:{dark:!0,color:this.omniaTheming.promoted.body.primary.base,label:this.loc.Vintage,"input-value":this.currentFilterTransformationData.vintage,"hide-details":!0,disabled:this.isLoading},on:{change:()=>{this.currentFilterTransformationData.vintage=!this.currentFilterTransformationData.vintage,this.onFilterTransformationChanged()}},model:{value:this.currentFilterTransformationData.vintage,callback:t=>{this.$set(this.currentFilterTransformationData,"vintage",t)}}}),(0,o.h)("v-checkbox",{attrs:{dark:!0,color:this.omniaTheming.promoted.body.primary.base,label:this.loc.Sharpen,"input-value":this.currentFilterTransformationData.sharpen,"hide-details":!0,disabled:this.isLoading},on:{change:()=>{this.currentFilterTransformationData.sharpen=!this.currentFilterTransformationData.sharpen,this.onFilterTransformationChanged()}},model:{value:this.currentFilterTransformationData.sharpen,callback:t=>{this.$set(this.currentFilterTransformationData,"sharpen",t)}}})])])]),(0,o.h)("v-col",{attrs:{md:"8"},class:"py-0"},[(0,o.h)("v-row",[(0,o.h)("v-col",{attrs:{md:"6"}},[(0,o.h)("v-slider",{attrs:{label:this.loc.RemoveWhite,color:this.omniaTheming.promoted.body.primary.base,max:B.Constants.DefaultFilterRangeValus.removewhiteDistanceRange.max,min:B.Constants.DefaultFilterRangeValus.removewhiteDistanceRange.min,step:B.Constants.DefaultFilterRangeValus.removewhiteDistanceRange.step,"thumb-size":24,"thumb-label":!0,"tick-size":2,ticks:!0,value:this.currentFilterTransformationData.removeWhite,dark:!0,"hide-details":!0,disabled:this.isLoading},on:{change:t=>{this.currentFilterTransformationData.removeWhite=t,this.onFilterTransformationChanged()}}}),(0,o.h)("v-slider",{attrs:{label:this.loc.Brightness,color:this.omniaTheming.promoted.body.primary.base,max:B.Constants.DefaultFilterRangeValus.brightnessRange.max,min:B.Constants.DefaultFilterRangeValus.brightnessRange.min,step:B.Constants.DefaultFilterRangeValus.brightnessRange.step,"thumb-size":24,"thumb-label":!0,"tick-size":2,ticks:!0,value:this.currentFilterTransformationData.brightness,dark:!0,"hide-details":!0,disabled:this.isLoading},class:"mt-3",on:{change:t=>{this.currentFilterTransformationData.brightness=t,this.onFilterTransformationChanged()}}}),(0,o.h)("v-slider",{attrs:{label:this.loc.Noise,color:this.omniaTheming.promoted.body.primary.base,max:B.Constants.DefaultFilterRangeValus.noiseRange.max,min:B.Constants.DefaultFilterRangeValus.noiseRange.min,step:B.Constants.DefaultFilterRangeValus.noiseRange.step,"thumb-size":24,"thumb-label":!0,"tick-size":2,ticks:!0,value:this.currentFilterTransformationData.noise,dark:!0,"hide-details":!0,disabled:this.isLoading},class:"mt-3",on:{change:t=>{this.currentFilterTransformationData.noise=t,this.onFilterTransformationChanged()}}})]),(0,o.h)("v-col",{attrs:{md:"6"}},[(0,o.h)("v-slider",{attrs:{label:this.loc.Pixelate,color:this.omniaTheming.promoted.body.primary.base,max:B.Constants.DefaultFilterRangeValus.pixelateRange.max,min:B.Constants.DefaultFilterRangeValus.pixelateRange.min,step:B.Constants.DefaultFilterRangeValus.pixelateRange.step,"thumb-size":24,"thumb-label":!0,"tick-size":2,ticks:!0,value:this.currentFilterTransformationData.pixelate,dark:!0,"hide-details":!0,disabled:this.isLoading},on:{change:t=>{this.currentFilterTransformationData.pixelate=t,this.onFilterTransformationChanged()}}}),(0,o.h)("v-slider",{attrs:{label:this.loc.ColorFilter,color:this.omniaTheming.promoted.body.primary.base,max:B.Constants.DefaultFilterRangeValus.colorfilterThresholeRange.max,min:B.Constants.DefaultFilterRangeValus.colorfilterThresholeRange.min,step:B.Constants.DefaultFilterRangeValus.colorfilterThresholeRange.step,"thumb-size":24,"thumb-label":!0,"tick-size":2,ticks:!0,value:this.currentFilterTransformationData.colorFilter,dark:!0,"hide-details":!0,disabled:this.isLoading},class:"mt-3",on:{change:t=>{this.currentFilterTransformationData.colorFilter=t,this.onFilterTransformationChanged()}}})])])])])])}};L([(0,s.Prop)()],z.prototype,"imageTransformationData",2),L([(0,s.Prop)()],z.prototype,"changedImageConfigurationCallback",2),L([(0,n.Inject)(h.OmniaTheming)],z.prototype,"omniaTheming",2),L([(0,n.Localize)(l.ImageTransformerLocalization.namespace)],z.prototype,"loc",2),z=L([a.default],z);var W=Object.defineProperty,O=Object.getOwnPropertyDescriptor,V=(t,e,i,o)=>{for(var a,s=o>1?void 0:o?O(e,i):e,n=t.length-1;n>=0;n--)(a=t[n])&&(s=(o?a(e,i,s):a(s))||s);return o&&s&&W(e,i,s),s};let U=class extends h.VueComponentBase{constructor(){super(...arguments),this.transformedImage=null,this.transformedImageInformation=null,this.maxImageHeight=0,this.maxImageWidth=0,this.menu=-1,this.cropButton=!1,this.flipButton=!1,this.filterButton=!1,this.isHiddenMenu=!1,this.editorId=c.Guid.newGuid().toString(),this.imageEditorMenuClassname="image-editor-menu",this.imageEditorMenuOptionClassname="image-editor-menu-option",this.isLoadingAndTransforming=!1}created(){}mounted(){this.init()}beforeDestroy(){this.editorInstance&&this.editorInstance.destroy()}init(){this.sourceImage&&(this.selectableRatios?this.menu=y.ImageEditorMenu.crop:this.menu=y.ImageEditorMenu.flip,this.getUiOption(),this.toogleCurrentButton(this.menu),this.transformedImage=n.Utils.clone(this.sourceImage),this.transformedImage.transformations||(this.transformedImage.transformations=[]),this.isLoadingAndTransforming=!0,n.Utils.waitForElementAvailable(this.$el,this.editorId,(()=>{this.maxImageHeight=parseInt((0,f.getComputedProp)(this.containerId,"height").toString().split(".").shift()),this.maxImageWidth=parseInt((0,f.getComputedProp)(this.containerId,"width").toString().split(".").shift());const t=this.$refs.tuiImageEditor;this.editorInstance=new b.ImageEditor(t,{usageStatistics:!1,cssMaxHeight:this.maxImageHeight}),this.transformUsingTuiEditor().then((t=>{this.transformationChanged(this.sourceImage,t),this.isLoadingAndTransforming=!1}))})))}transformUsingTuiEditor(){const t=this.mediaPickerService.ensureBase64String(this.sourceImage.base64,n.Utils.getFileType(this.sourceImage.fileName));return new Promise(((e,i)=>{this.editorInstance.loadImageFromURL(t,"image1").then((()=>{const t=[],o=[];if(this.transformedImage.transformations&&this.transformedImage.transformations.length>0){const e=this.getConfig(this.transformedImage.transformations,c.MediaPickerEnums.MediaPickerTransformationTypes.Filter);e&&Object.keys(e).forEach((i=>{"type"!=i&&e[i]&&t.push({key:i,value:e[i]})}));const i=this.getConfig(this.transformedImage.transformations,c.MediaPickerEnums.MediaPickerTransformationTypes.Flip);i&&Object.keys(i).forEach((t=>{"type"!=t&&i[t]&&o.push({key:t,value:i[t]})}))}(t.length>0||o.length>0)&&(0,f.onApplyStyle)(this.editorInstance,t,o).then((()=>{const t={format:n.Utils.getFileType(this.transformedImage.fileName)};this.transformedImage.base64=this.mediaPickerService.removeBase64FormatTags(this.editorInstance.toDataURL(t))})),this.mediaPickerService.getMediaPickerImageInformation(this.transformedImage).then((t=>{this.transformedImageInformation=t,this.openMenu(this.menu),e(this.transformedImage)})).catch((()=>{this.isLoadingAndTransforming=!1,i({originalImageBase64:this.sourceImage})}))})).catch((()=>{this.isLoadingAndTransforming=!1,i({originalImageBase64:this.sourceImage})}))}))}onImageTransformationDataChanged(t,e){let i=!1;!e&&this.transformedImage.transformations?.filter((t=>t.type!==c.MediaPickerEnums.MediaPickerTransformationTypes.Crop)).length>0&&(this.transformedImage.base64=this.sourceImage.base64,i=!0),this.transformedImage.transformations=this.transformedImage.transformations.filter((e=>e.type!=t)),e&&(this.transformedImage.transformations.push(e),i=!0),i&&this.transformationChanged(this.sourceImage,this.transformedImage),t!=c.MediaPickerEnums.MediaPickerTransformationTypes.Crop&&this.transformUsingTuiEditor().then((t=>{this.transformationChanged(this.sourceImage,this.transformedImage)}))}resizeCanvasDimension(t=!0){if(!this.transformedImageInformation.width||!this.transformedImageInformation.height)return;const e=t=>{let e=-1,i=0,o=0;do{e++,o=t-e,i=o*this.transformedImageInformation.width/this.transformedImageInformation.height}while(i>this.maxImageWidth);return{newWidth:i,newHeight:o}};let i;return i=e(t?this.maxImageHeight:(0,f.getComputedProp)(this.containerId,"height")-128),this.editorInstance.resizeCanvasDimension({width:i.newWidth,height:i.newHeight})}resetStyle(t){t==h.ConfirmDialogResponse.Ok&&(this.transformedImage.base64=this.sourceImage.base64,this.transformedImage.transformations=[],this.transformUsingTuiEditor().then((t=>{this.transformationChanged(this.sourceImage,this.transformedImage)})))}getConfig(t,e){return t.find((t=>t.type==e))}getUiOption(){this.options||(this.options={crop:!0,flip:!0,filter:!0,reset:!0});let t=0,e=0;for(const i in this.options)this.options[i]&&(t++,1==t&&(e=y.ImageEditorMenu[i]));t<4&&(this.menu=e),this.isHiddenMenu=1===t}openMenu(t,e){switch(this.menu=t,this.menu){case y.ImageEditorMenu.crop:this.cropButton?this.resizeCanvasDimension(!1):(this.resizeCanvasDimension(),this.menu=-1);break;case y.ImageEditorMenu.flip:this.flipButton?this.resizeCanvasDimension():this.menu=-1;break;case y.ImageEditorMenu.filter:this.filterButton?this.resizeCanvasDimension():this.menu=-1;break;case y.ImageEditorMenu.reset:this.resizeCanvasDimension().then((()=>{this.resetStyle(e),this.menu=-1}))}}toogleCurrentButton(t){switch(t){case y.ImageEditorMenu.crop:this.cropButton=!this.cropButton,this.flipButton=!1,this.filterButton=!1;break;case y.ImageEditorMenu.flip:this.flipButton=!this.flipButton,this.cropButton=!1,this.filterButton=!1;break;case y.ImageEditorMenu.filter:this.filterButton=!this.filterButton,this.cropButton=!1,this.flipButton=!1;break;case y.ImageEditorMenu.reset:this.filterButton=!1,this.cropButton=!1,this.flipButton=!1}}renderMenu(){return!this.isHiddenMenu&&(0,o.h)("div",{class:this.imageEditorMenuClassname},[this.selectableRatios&&this.options.crop&&(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.toogleCurrentButton(y.ImageEditorMenu.crop),this.openMenu(y.ImageEditorMenu.crop)},mode:c.ButtonModes.flat,styles:{textColor:"#fff"},tooltip:{text:this.loc.Crop,position:c.ButtonTooltipPosition.Top}}},[(0,o.h)("v-icon",["crop"])]),this.options.flip&&(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.toogleCurrentButton(y.ImageEditorMenu.flip),this.openMenu(y.ImageEditorMenu.flip)},mode:c.ButtonModes.flat,styles:{textColor:"#fff"},tooltip:{text:this.loc.Flip,position:c.ButtonTooltipPosition.Top}}},[(0,o.h)("v-icon",["flip"])]),this.options.filter&&(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.toogleCurrentButton(y.ImageEditorMenu.filter),this.openMenu(y.ImageEditorMenu.filter)},mode:c.ButtonModes.flat,styles:{textColor:"#fff"},tooltip:{text:this.loc.Filter,position:c.ButtonTooltipPosition.Top}}},[(0,o.h)("v-icon",["tune"])]),this.options.reset&&(0,o.h)("v-tooltip",g()([{attrs:{top:!0}},this.transformVSlot({activator:t=>{const e={on:t.on};return[(0,o.h)("omfx-confirm-dialog",g()([{},e,{domProps:{icon:"refresh",styles:{icon:{fontSize:"24px",color:"#fff !important"},button:{width:"64px !important",display:"block"}},dialogOptions:{title:this.loc.ResetOriginal,message:this.loc.ResetOriginalConfirmation},onClose:t=>{this.toogleCurrentButton(y.ImageEditorMenu.reset),this.openMenu(y.ImageEditorMenu.reset,t)}},attrs:{flat:!0,type:h.ConfirmDialogDisplay.Button}}]))]}})]),[(0,o.h)("span",[this.loc.Reset])])])}renderMenuOptions(){return!this.isLoadingAndTransforming&&this.transformedImage&&(0,o.h)("div",{class:[this.imageEditorMenuOptionClassname]},[this.menu==y.ImageEditorMenu.crop&&(0,o.h)(P,{attrs:{imageTransformationData:this.transformedImage.transformations,editorInstance:this.editorInstance,selectableRatios:this.selectableRatios,shareableRenditions:this.shareableRenditions,selectedRenditionId:this.selectedRenditionId,isShowWarningDialog:this.isShowWarningDialog,changedImageCropAreaCallback:t=>{this.onImageTransformationDataChanged(c.MediaPickerEnums.MediaPickerTransformationTypes.Crop,t)}}}),this.menu==y.ImageEditorMenu.flip&&(0,o.h)(S,{attrs:{imageTransformationData:this.transformedImage.transformations,changedImageConfigurationCallback:t=>{this.onImageTransformationDataChanged(c.MediaPickerEnums.MediaPickerTransformationTypes.Flip,t)}}}),this.menu==y.ImageEditorMenu.filter&&(0,o.h)(z,{attrs:{imageTransformationData:this.transformedImage.transformations,changedImageConfigurationCallback:t=>{this.onImageTransformationDataChanged(c.MediaPickerEnums.MediaPickerTransformationTypes.Filter,t)}}})])}render(){return(0,o.h)("div",{class:"image-editor-container",key:this.editorId},[(0,o.h)("div",{key:this.editorId+"tui",attrs:{id:this.editorId},ref:"tuiImageEditor",class:["image-editor",this.isLoadingAndTransforming&&"isLoading"]},[this.renderMenu(),this.renderMenuOptions()]),this.isLoadingAndTransforming&&(0,o.h)("v-skeleton-loader",{attrs:{type:"image"}})])}};V([(0,s.Prop)()],U.prototype,"sourceImage",2),V([(0,s.Prop)()],U.prototype,"containerId",2),V([(0,s.Prop)()],U.prototype,"selectableRatios",2),V([(0,s.Prop)()],U.prototype,"transformationChanged",2),V([(0,s.Prop)()],U.prototype,"shareableRenditions",2),V([(0,s.Prop)()],U.prototype,"selectedRenditionId",2),V([(0,s.Prop)()],U.prototype,"isShowWarningDialog",2),V([(0,s.Prop)()],U.prototype,"options",2),V([(0,n.Inject)(h.OmniaTheming)],U.prototype,"omniaTheming",2),V([(0,n.Inject)(I.MediaPickerService)],U.prototype,"mediaPickerService",2),V([(0,n.Localize)(l.ImageTransformerLocalization.namespace)],U.prototype,"loc",2),U=V([a.default],U);var A=i("./node_modules/typestyle/umd/typestyle.js"),_=Object.defineProperty,H=Object.getOwnPropertyDescriptor,$=(t,e,i,o)=>{for(var a,s=o>1?void 0:o?H(e,i):e,n=t.length-1;n>=0;n--)(a=t[n])&&(s=(o?a(e,i,s):a(s))||s);return o&&s&&_(e,i,s),s};let J=class extends h.VueComponentBase{constructor(){super(...arguments),this.fileInfo=null}created(){}onSettingUpdated(t){t?this.mediaPickerService.getMediaPickerImageInformation(this.imageBase64).then((t=>{this.fileInfo=t})):this.fileInfo=null}mounted(){}render(){return(0,o.h)("div",[(0,o.h)("h2",{class:["font-weight-light mb-4",r.MediaStyles.hideDisplayWrapper,this.theming.body.text.css]},[" ",this.loc.Information," "]),(0,o.h)("v-text-field",{attrs:{dark:this.theming.body.bg.dark,placeholder:this.loc.ImageAlt,filled:!0},on:{change:t=>{this.imageBase64.altText=t,this.changed(this.imageBase64)}},model:{value:this.imageBase64.altText,callback:t=>{this.$set(this.imageBase64,"altText",t)}}}),(0,o.h)("v-row",{attrs:{"no-gutters":!0},class:(0,A.classes)(r.MediaStyles.hideDisplayWrapper,this.theming.body.text.css)},[(0,o.h)("v-col",{attrs:{md:"5"}},[this.loc.Dimension]),(0,o.h)("v-col",{attrs:{md:"7"}},[(0,o.h)("label",[" ",this.loc.Size.width]),(0,o.h)("span",{class:"float-right"},[this.fileInfo?this.fileInfo.width+" px":""])])]),(0,o.h)("v-row",{attrs:{"no-gutters":!0},class:(0,A.classes)(r.MediaStyles.hideDisplayWrapper,this.theming.body.text.css)},[(0,o.h)("v-col",{attrs:{"offset-md":"5",md:"7"}},[(0,o.h)("label",[" ",this.loc.Size.height]),(0,o.h)("span",{class:"float-right"},[this.fileInfo?this.fileInfo.height+" px":""])])]),(0,o.h)("v-row",{attrs:{"no-gutters":!0},class:(0,A.classes)(r.MediaStyles.hideDisplayWrapper,this.theming.body.text.css)},[(0,o.h)("v-col",{attrs:{md:"5"}},[this.loc.Size.Title]),(0,o.h)("v-col",{attrs:{md:"7"}},[this.fileInfo?h.MediaPickerImageHandler.convertByteToString(this.fileInfo.sizeBytes):""])])])}};$([(0,s.Prop)()],J.prototype,"imageBase64",2),$([(0,s.Prop)()],J.prototype,"changed",2),$([(0,n.Inject)(h.OmniaTheming)],J.prototype,"omniaTheming",2),$([(0,n.Inject)(I.MediaPickerService)],J.prototype,"mediaPickerService",2),$([(0,n.Localize)(l.ImageTransformerLocalization.namespace)],J.prototype,"loc",2),$([(0,s.Watch)("imageBase64",{immediate:!0,deep:!0})],J.prototype,"onSettingUpdated",1),J=$([a.default],J);var N=Object.defineProperty,G=Object.getOwnPropertyDescriptor,Y=(t,e,i,o)=>{for(var a,s=o>1?void 0:o?G(e,i):e,n=t.length-1;n>=0;n--)(a=t[n])&&(s=(o?a(e,i,s):a(s))||s);return o&&s&&N(e,i,s),s};let X=class extends h.VueComponentBase{constructor(){super(...arguments),this.imageTransformerStyles=d.StyleFlow.use(m.ImageTransformerStyles),this.transformerContentId=c.Guid.newGuid().toString(),this.imageContainerId=c.Guid.newGuid().toString(),this.imageFileInformation=null,this.currentTransformationResult=null,this.shareableRenditions=[],this.selectedRenditionId={value:null},this.isShowWarningDialog={value:!1}}created(){if(this.sourceImage&&this.changed){const t=n.Utils.clone(this.sourceImage);t.transformations?this.setCurrentTransformations(t.transformations):t.transformations=[],t.altText||(t.altText=null),this.currentTransformationResult={sourceImage:this.sourceImage,transformedBase64:t,renditionData:this.renditions}}}mounted(){n.WebComponentBootstrapper.registerElementInstance(this,this.$el)}setCurrentTransformations(t){let e=null;t&&(e=t.find((t=>t.type===c.MediaPickerEnums.MediaPickerTransformationTypes.Crop))),this.selectedRenditionId.value=e?e.imageRatioId:null}onRenditionDataChanged(t){this.currentTransformationResult.renditionData=t,this.changed(this.currentTransformationResult)}getUiOption(){if(!this.options){switch(n.Utils.getFileType(this.currentTransformationResult.sourceImage.fileName)){case"png":case"jpeg":case"jpg":case"bmp":this.options={editor:{crop:!0,flip:!0,filter:!0,reset:!0},rollup:!0,setting:!0};break;case"gif":this.options={editor:{crop:!0,flip:!1,filter:!1,reset:!1},rollup:!0,setting:!0};break;default:this.options={editor:null,rollup:!1,setting:!0}}}}renderWarningDialog(){return(0,o.h)("omfx-dialog",{attrs:{valueBind:{visible:this.isShowWarningDialog.value},title:this.loc.Message.InvalidCropzoneTitle,width:"500px",color:this.theming.body.bg.color.base,headerClass:(0,A.classes)(this.theming.body.bg.css,this.theming.body.text.css),contentClass:(0,A.classes)(this.theming.body.bg.css),dark:this.theming.body.bg.dark},on:{close:()=>{this.isShowWarningDialog.value=!1}}},[(0,o.h)("v-card",[(0,o.h)("div",{class:"pa-4"},[(0,o.h)("div",{class:"mb-1"},[this.loc.Message.InvalidCropzoneMessage])]),(0,o.h)("v-card-actions",[(0,o.h)("v-spacer"),(0,o.h)("omfx-button",{domProps:{mode:c.ButtonModes.flat,onClick:()=>{this.isShowWarningDialog.value=!1}},attrs:{text:this.uxLoc.Common.Buttons.Cancel}})])])])}renderImageEditor(){return(0,o.h)("v-card",{attrs:{tile:!0,dark:this.theming.body.bg.dark,color:this.theming.body.bg.color.base,id:this.imageContainerId},class:"image-transformer"},[(0,o.h)(U,{attrs:{sourceImage:this.sourceImage,containerId:this.imageContainerId,selectableRatios:this.selectableRatios,transformationChanged:(t,e)=>{this.currentTransformationResult.transformedBase64.base64=e.base64,this.currentTransformationResult.transformedBase64.fileName=e.fileName,this.currentTransformationResult.transformedBase64.transformations=e.transformations,this.mediaPickerService.getMediaPickerImageInformation(this.currentTransformationResult.transformedBase64).then((t=>{this.imageFileInformation=t})),this.setCurrentTransformations(this.currentTransformationResult.transformedBase64.transformations),this.changed(this.currentTransformationResult)},shareableRenditions:this.shareableRenditions,selectedRenditionId:this.selectedRenditionId,isShowWarningDialog:this.isShowWarningDialog,options:this.options.editor}})])}renderImageRollup(){if(this.rollupRatios&&this.rollupRatios.length>0&&this.currentTransformationResult&&this.currentTransformationResult.transformedBase64){if(this.options.editor&&this.imageFileInformation||!this.options.editor)return(0,o.h)("v-card",{attrs:{tile:!0,dark:this.theming.body.bg.dark,color:this.theming.body.bg.color.base},class:this.options.editor?"mb-4 rollup":"image-transformer rollup"},[(0,o.h)(v,{attrs:{sourceImage:this.currentTransformationResult.transformedBase64,sourceRenditionData:this.currentTransformationResult.renditionData,rollupRatios:this.rollupRatios,renditionDataChangedCallback:this.onRenditionDataChanged,shareableRenditions:this.shareableRenditions,selectedRenditionId:this.selectedRenditionId,isShowWarningDialog:this.isShowWarningDialog}})])}else if(!this.options.editor)return this.renderImageViewer()}renderImageSetting(){return this.currentTransformationResult&&this.currentTransformationResult.transformedBase64?(0,o.h)("v-card",{attrs:{tile:!0,dark:this.theming.body.bg.dark,color:this.theming.body.bg.color.base},class:"overflow"},[(0,o.h)("v-card-text",[(0,o.h)(J,{attrs:{imageBase64:this.currentTransformationResult.transformedBase64,changed:t=>{this.currentTransformationResult.transformedBase64=t,this.changed(this.currentTransformationResult)}}})])]):(0,o.h)("v-skeleton-loader",{attrs:{type:"card"},class:"overflow"})}renderImageViewer(){return(0,o.h)("v-card",{attrs:{tile:!0,dark:this.theming.body.bg.dark,color:this.theming.body.bg.color.base},class:"image-transformer"},[(0,o.h)("v-img",{attrs:{contain:!0,"max-width":"100%","max-height":"100%",src:this.mediaPickerService.ensureBase64String(this.sourceImage.base64,n.Utils.getFileType(this.sourceImage.fileName))}})])}render(){this.getUiOption();const t=window.outerWidth<600;return(0,o.h)("div",{class:this.imageTransformerStyles.transformer(this.omniaTheming)},[(0,o.h)("div",{class:"image-container",attrs:{id:this.transformerContentId}},[this.options.editor&&!t&&this.renderImageEditor(),(0,o.h)("div",{class:!this.options.editor||t?"image-container":"image-settings"},[(!this.options.editor&&!this.options.rollup||t)&&this.renderImageViewer(),this.options.rollup&&!t&&this.renderImageRollup(),this.options.setting&&!this.options.editor?(0,o.h)("div",{class:"image-settings"},[" ",this.renderImageSetting()," "]):this.renderImageSetting()])]),this.isShowWarningDialog&&this.renderWarningDialog()])}};Y([(0,s.Prop)()],X.prototype,"sourceImage",2),Y([(0,s.Prop)()],X.prototype,"renditions",2),Y([(0,s.Prop)()],X.prototype,"selectableRatios",2),Y([(0,s.Prop)()],X.prototype,"rollupRatios",2),Y([(0,s.Prop)()],X.prototype,"changed",2),Y([(0,s.Prop)()],X.prototype,"options",2),Y([(0,s.Prop)()],X.prototype,"nisse",2),Y([(0,s.Prop)()],X.prototype,"testThis",2),Y([(0,n.Inject)(h.OmniaTheming)],X.prototype,"omniaTheming",2),Y([(0,n.Inject)(I.MediaPickerService)],X.prototype,"mediaPickerService",2),Y([(0,n.Localize)(l.ImageTransformerLocalization.namespace)],X.prototype,"loc",2),Y([(0,n.Localize)(h.OmniaUxLocalizationNamespace)],X.prototype,"uxLoc",2),X=Y([a.default],X),n.WebComponentBootstrapper.registerElement((t=>{(0,n.vueCustomElement)(t.elementName,X)}))},"./client/fx/ux/imagetransformation/constants.js":(t,e,i)=>{t.exports=i("dll-reference md66")("./client/fx/ux/imagetransformation/constants.js")},"./client/fx/ux/imagetransformation/enums.js":(t,e,i)=>{t.exports=i("dll-reference md66")("./client/fx/ux/imagetransformation/enums.js")},"./client/fx/ux/imagetransformation/utils.js":(t,e,i)=>{t.exports=i("dll-reference md66")("./client/fx/ux/imagetransformation/utils.js")},"./client/fx/ux/imagetransformer/imagetransformer.css.js":(t,e,i)=>{t.exports=i("dll-reference md66")("./client/fx/ux/imagetransformer/imagetransformer.css.js")},"./client/fx/ux/imagetransformer/loc/localize.js":(t,e,i)=>{t.exports=i("dll-reference md66")("./client/fx/ux/imagetransformer/loc/localize.js")},"./client/fx/ux/imagetransformer/tui-image-editor/index.js":(t,e,i)=>{t.exports=i("dll-reference md38")("./client/fx/ux/imagetransformer/tui-image-editor/index.js")},"./client/fx/ux/models/index.js":(t,e,i)=>{t.exports=i("dll-reference md66")("./client/fx/ux/models/index.js")},"./client/fx/ux/styleflow.js":(t,e,i)=>{t.exports=i("dll-reference md66")("./client/fx/ux/styleflow.js")},"./node_modules/@vue/babel-helper-vue-jsx-merge-props/dist/helper.js":(t,e,i)=>{t.exports=i("dll-reference md2")("./node_modules/@vue/babel-helper-vue-jsx-merge-props/dist/helper.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(t,e,i)=>{t.exports=i("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/typestyle/umd/typestyle.js":(t,e,i)=>{t.exports=i("dll-reference md2")("./node_modules/typestyle/umd/typestyle.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(t,e,i)=>{t.exports=i("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(t,e,i)=>{t.exports=i("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(t,e,i)=>{t.exports=i("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(t,e,i)=>{t.exports=i("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(t,e,i)=>{t.exports=i("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(t,e,i)=>{t.exports=i("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(t,e,i)=>{t.exports=i("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"dll-reference md2":t=>{"use strict";t.exports=omniaVendor},"dll-reference md38":t=>{"use strict";t.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["701863f7-730f-46c3-9656-6ddc8262da27"]},"dll-reference md9":t=>{"use strict";t.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":t=>{"use strict";t.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":t=>{"use strict";t.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a882dbf5-bd31-435d-87c4-42b6667926d5"])throw new Error("Error, already loaded manifest a882dbf5-bd31-435d-87c4-42b6667926d5 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a882dbf5-bd31-435d-87c4-42b6667926d5"]=i;var e={};function i(o){var a=e[o];if(void 0!==a)return a.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};i("./client/fx/ux/imagetransformer/imagetransformer.tsx")})()};