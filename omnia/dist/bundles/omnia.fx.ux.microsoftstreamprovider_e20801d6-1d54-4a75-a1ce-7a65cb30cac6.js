if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["e20801d6-1d54-4a75-a1ce-7a65cb30cac6"])throw new Error("Error, already loaded manifest e20801d6-1d54-4a75-a1ce-7a65cb30cac6 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["e20801d6-1d54-4a75-a1ce-7a65cb30cac6"]=function(){(()=>{var e={"./client/fx/ux/mediapickerproviders/microsoftstream/microsoftstreamprovider.tsx":(e,t,i)=>{"use strict";i.r(t),i.d(t,{MicrosoftStreamProviderComponent:()=>x});var o=i("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),r=i("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),a=i("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","e20801d6-1d54-4a75-a1ce-7a65cb30cac6"),s=i("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),n=i("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),d=i("97786ea9-4861-48bd-8a57-eae9bbdb4892"),l=i("./node_modules/typestyle/umd/typestyle.js");(0,l.style)({backgroundColor:"inherit"});var m,h;(h=m||(m={})).ResponsiveContainer="width: 100%; height: 0; padding-bottom: 56.25%",h.innerIframe="position: absolute;\n                                            top: 0;\n                                            left: 0;";(0,l.style)({position:"absolute",top:"0",bottom:"0",left:"0",right:"0",padding:"50px 0"}),(0,l.style)({height:"50px",padding:"20px",marginTop:"-50px",h2:{float:"left"}}),(0,l.style)({padding:"20px 20px 0 20px"}),(0,l.style)({height:"100%",padding:"0 20px",overflowY:"auto"}),(0,l.style)({marginBottom:"-50px",height:"50px",width:"100%",boxShadow:"0 -5px 5px -5px rgba(0, 0, 0, 0.26)"});const b=(0,l.style)({color:"red"}),c=((0,l.style)({display:"block",paddingRight:"20px",$nest:{".video-ratio":{margin:"5px 11px 10px",$nest:{"&:first-child":{marginTop:"0px"},".video-ratio-title":{display:"flex",flexDirection:"row",justifyContent:"space-between",height:"19px",fontSize:"14px",color:"#212121",opacity:.64,marginBottom:"5px"},".video-ratio-thumbnail":{alignItems:"center",background:"rgba(33, 33, 33, 0.07)",display:"flex",height:"20vw",justifyContent:"center",maxHeight:"205px",maxWidth:"205px",width:"20vw",$nest:{img:{backgroundPosition:"50% 50%",backgroundRepeat:"no-repeat",backgroundSize:"cover",display:"block",width:"100%"}}}}}}}),(0,l.style)({width:"640px",height:"360px",position:"relative"}),(0,l.style)({width:"100%",maxWidth:"100%",position:"relative"}));var p;(0,l.cssRaw)("\n    .v-input input {\n        border: inherit!important;\n    }\n\n    .video-option-checkbox {\n        max-width: 100px;\n        display: inline-block!important;\n        margin-top: 10px!important;\n        float: left;\n    }\n\n    @keyframes play {\n        to { background-position:-8160px }\n    }\n\n    .video-iframe-max-width-wrapper {\n        max-width: 100%;\n    }\n\n    .video-iframe-max-width { \n        position: relative; \n        padding-bottom: 56.25%; \n        height: 0; \n        overflow: hidden;\n    }\n    \n    .video-iframe-responsive {\n        position: absolute; \n        top: 0; \n        left: 0; \n        right: 0; \n        bottom: 0; \n        height: 100%; \n        max-width: 100%; \n        width: 100%;\n        border: 0;\n    }\n\n    \n"),(p||(p={})).namespace="Omnia.Ux.MicrosoftStreamProvider";var u=i("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","e20801d6-1d54-4a75-a1ce-7a65cb30cac6"),v=i("a3e11883-9574-4070-b80e-40faef6801d2"),f=Object.defineProperty,g=Object.getOwnPropertyDescriptor,S=(e,t,i,o)=>{for(var r,a=o>1?void 0:o?g(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o?r(t,i,a):r(a))||a);return o&&a&&f(t,i,a),a};let x=class extends v.MediaProviderComponentBase{constructor(){super(),this.apiUrl="https://web.microsoftstream.com/oembed",this.microsoftStreamVideoUrl="https://web.microsoftstream.com/video/",this.isIframeLoading=!1,this.isIframeRendering=!1,this.invalidVideoUrl=!1,this.invalidStartTimeInput=!1,this.embedIframeSource=null,this.enableStartTime=!1,this.videoProviderResult=null,this.inVideoUrlInputMode=!0,this.providerSlots={bottom:this.renderProviderButtons}}created(){this.rules={required:"[() => !!value || '"+this.loc.Message.Required+"']"},this.preSelectedMedia&&this.preSelectedMedia.omniaMediaType==n.MediaPickerEnums.OmniaMediaTypes.Video?(this.videoProviderResult=d.Utils.clone(this.preSelectedMedia),this.enableStartTime=!!this.videoProviderResult.startTime,this.initVideoDataAndGoToNextStep()):this.videoProviderResult={omniaMediaType:n.MediaPickerEnums.OmniaMediaTypes.Video,html:null,videoUrl:null,mute:!1,autoPlay:!1,showInfo:!1},this.videoProviderResult={...this.videoProviderResult},this.omniaUrl=d.ServiceLocator.getUrl(n.OmniaService.Id,!0)}mounted(){a.WebComponentBootstrapper.registerElementInstance(this,this.$el)}saveMSStreamResult(){this.iframeElement&&(this.videoProviderResult.html=this.iframeElement.elm.outerHTML,this.videoProviderResult.thumbnailUrl=this.microsoftStream?this.microsoftStream.thumbnail_url:"",this.save(this.videoProviderResult))}initVideoDataAndGoToNextStep(){this.validateVideoUrl(this.videoProviderResult.videoUrl),this.invalidVideoUrl||this.getStreamVideo({apiUrl:this.apiUrl,videoUrl:this.videoProviderResult.videoUrl,showInfo:!1}).then((()=>{this.processResponsiveIframe(),this.inVideoUrlInputMode=!1}))}onVideoUrlChanged(){this.microsoftStream=null,this.iframeElement=null,this.initVideoDataAndGoToNextStep()}onStartTimeChanged(e){if(e&&this.validateStartTimeInput(e)){this.invalidStartTimeInput=!1;const t=this.getStartTimeAsSeconds(e);this.microsoftStream.embed_url=this.updateQueryStringParameter(this.microsoftStream.embed_url,"st",t>0?t.toString():null),this.renderIframe()}else e&&!this.validateStartTimeInput(e)&&(this.invalidStartTimeInput=!0)}onEnableStartTimeChanged(e){if(this.enableStartTime=e,this.enableStartTime){this.$refs.startTime.focus(),this.videoProviderResult.startTime=this.videoProviderResult.startTime??"0:00";const e=this.getStartTimeAsSeconds(this.videoProviderResult.startTime);this.microsoftStream.embed_url=this.updateQueryStringParameter(this.microsoftStream.embed_url,"st",e>0?e.toString():null),this.renderIframe()}else this.videoProviderResult.startTime=null,this.renderIframe()}onAutoPlayChanged(e){this.videoProviderResult.autoPlay=!0===e,this.microsoftStream.embed_url=this.updateQueryStringParameter(this.microsoftStream.embed_url,"autoplay",this.videoProviderResult.autoPlay),this.renderIframe()}onShowInfoChanged(e){this.videoProviderResult.showInfo=!0===e,this.microsoftStream.embed_url=this.updateQueryStringParameter(this.microsoftStream.embed_url,"showinfo",this.videoProviderResult.showInfo),this.renderIframe()}updateQueryStringParameter(e,t,i){const o=new RegExp("[\\?&]"+t+"=([^&#'\"]*)"),r=o.exec(e);let a,s;if(null===r){if(a=/\?/.test(e)?"&":"?",e.endsWith('"')||e.endsWith("'")){const o=e.substr(e.length-1);s=e.slice(0,-1)+a+t+"="+i+o}else s=e+a+t+"="+i}else a=r[0].charAt(0),s=e.replace(o,a+t+"="+i);return s}replaceAttributeFromString(e,t,i){const o=new RegExp(t+"=[\"|']([^/].+?)[\"|']");return e=e.replace(o,(function(e){return null==i?"":i,""}))}validateVideoUrl(e){this.validateMessage="",this.invalidVideoUrl=!1,d.Utils.isNullOrEmpty(e)?(this.invalidVideoUrl=!0,this.validateMessage=this.loc.Message.Required):e.startsWith(this.microsoftStreamVideoUrl)||(this.invalidVideoUrl=!0,this.validateMessage=this.loc.Message.InvalidVideoUrl)}validateStartTimeInput(e){if(null!=e&&null!=e){const e=new RegExp(/^(?:(?:([01]?\d|2[0-3]):)?([0-5]?\d):)?([0-5]?\d)$/,"g").exec(this.videoProviderResult.startTime);return null!=e}return!1}getStartTimeAsSeconds(e){let t=0;if(null!=e&&null!=e){const e=new RegExp(/^(?:(?:([01]?\d|2[0-3]):)?([0-5]?\d):)?([0-5]?\d)$/,"g").exec(this.videoProviderResult.startTime);null!=e&&(null!=e[3]&&(t+=+e[3]),null!=e[2]&&(t+=60*+e[2]),null!=e[1]&&(t+=60*+e[1]*60))}return t}getStreamVideo(e){return this.microsoftStreamService.getStreamVideo(e).then((e=>{null!=e&&(this.microsoftStream=e)}))}processResponsiveIframe(){const e=this;let t=e.microsoftStream.embed_url;if(t=e.updateQueryStringParameter(t,"autoplay",e.videoProviderResult.autoPlay),t=e.updateQueryStringParameter(t,"showinfo",e.videoProviderResult.showInfo),e.enableStartTime){const i=e.getStartTimeAsSeconds(e.videoProviderResult.startTime);t=e.updateQueryStringParameter(t,"st",i.toString())}else t=e.replaceAttributeFromString(t,"st");this.embedVideoUrl=t,e.iframeElement=e.renderResponsiveVideoIframe(t)}renderIframe(){this.processResponsiveIframe()}renderVideoIframe(e,t,i,o){if(void 0!==this.microsoftStream){this.isIframeLoading=!0;const a={};return a.width=t>0?t:"100%",a.height=i>0?i:"100%",e&&""!==e&&(a.src=e),a.frameborder=0,a.ref="videoIframe",a.allow="autoplay",a.allowFullscreen=!0,(0,r.h)("iframe",{style:t<=0&&i<=0?m.innerIframe:{},domProps:a,on:{load:()=>{this.isIframeLoading=!1}},class:[o]})}}renderResponsiveVideoIframe(e){return this.isIframeLoading=!0,this.iframeElement=this.renderVideoIframe(e,0,0,"video-iframe-responsive"),(0,r.h)("div",{style:m.ResponsiveContainer,domProps:{omfxmpc:"video"}},[this.iframeElement])}renderMicrosoftStreamUrlInput(){const e=this.omniaTheming.promoted.body.dark;return(0,r.h)("div",{class:"select-video"},[(0,r.h)("label",[this.loc.Labels.ChooseVideo]),(0,r.h)("v-text-field",{attrs:{dark:e,filled:!0,name:"videoUrl",label:this.loc.Labels.VideoUrl,hint:this.loc.Message.UrlVideoHint,"single-line":!0},ref:"videoUrl",on:{change:this.onVideoUrlChanged},model:{value:this.videoProviderResult.videoUrl,callback:e=>{this.$set(this.videoProviderResult,"videoUrl",e)}}}),(0,r.h)("label",{class:b,directives:[{name:"show",value:this.invalidVideoUrl}]},[this.validateMessage])])}renderSelectedVideoSettings(){const e=this.omniaTheming.promoted.body.dark;return(0,r.h)("div",{class:(t=this.omniaUrl,(0,l.style)({display:"flex",flexDirection:"row",height:"100%",width:"100%",$nest:{".video-iframe":{width:"70%",overflow:"hidden",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(33, 33, 33, 0.07) !important",display:"flex",$nest:{".video-iframe-loading":{width:"170px",height:"75px",animation:"play 1.5s steps(48) infinite",fontSize:"0",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto",backgroundImage:t&&`url('${t}/images/stream-loading.png')`}}},".video-options":{width:"30%",$nest:{".full-width":{width:"100%"}}}}}))},[(0,r.h)("v-card",{class:"video-iframe"},[(0,r.h)("div",{class:c},[(0,r.h)("div",{class:"video-iframe-loading",directives:[{name:"show",value:this.isIframeLoading}]},[(0,r.h)("span")]),(0,r.h)("div",{directives:[{name:"show",value:!this.isIframeLoading}]},[this.iframeElement])])]),(0,r.h)("v-card",{class:"video-options ml-4"},[(0,r.h)("v-container",[(0,r.h)("v-layout",[(0,r.h)("v-checkbox",{class:"full-width",attrs:{"input-value":this.enableStartTime,label:this.loc.Labels.StartAt,color:this.omniaTheming.promoted.body.primary.base,dark:e},on:{change:this.onEnableStartTimeChanged},model:{value:this.enableStartTime,callback:e=>{this.enableStartTime=e}}}),(0,r.h)("v-text-field",{class:"full-width",attrs:{placeholder:"0:00",dark:e,"single-line":!0,name:"startTime",disabled:!this.enableStartTime},ref:"startTime",on:{change:this.onStartTimeChanged},model:{value:this.videoProviderResult.startTime,callback:e=>{this.$set(this.videoProviderResult,"startTime",e)}}})]),(0,r.h)("v-row",{attrs:{"no-gutters":!0}},[(0,r.h)("label",{class:b,directives:[{name:"show",value:this.invalidStartTimeInput}]},[this.loc.Message.InvalidInputStartTime])]),(0,r.h)("v-row",{attrs:{"no-gutters":!0}},[(0,r.h)("v-switch",{attrs:{"input-value":this.videoProviderResult.autoPlay,color:this.omniaTheming.promoted.body.primary.base,dark:e,label:this.loc.Labels.AutoPlay},on:{change:e=>this.onAutoPlayChanged(e)}})]),(0,r.h)("v-row",{attrs:{"no-gutters":!0}},[(0,r.h)("v-switch",{attrs:{"input-value":this.videoProviderResult.showInfo,color:this.omniaTheming.promoted.body.primary.base,dark:e,label:this.loc.Labels.ShowInfo},on:{change:e=>this.onShowInfoChanged(e)}})])])])]);var t}renderProviderButtons(){const e=[];return this.inVideoUrlInputMode?(e.push((0,r.h)("v-spacer")),this.videoProviderResult.videoUrl&&!this.invalidVideoUrl&&e.push((0,r.h)("omfx-button",{attrs:{dark:this.theming.body.bg.dark,text:this.uxLoc.Common.Buttons.Next},domProps:{onClick:()=>{this.initVideoDataAndGoToNextStep()},mode:n.ButtonModes.flat,icon:{iconType:new n.FontAwesomeIcon("arrow_forward"),position:n.ButtonIconPosition.Left}}}))):(e.push((0,r.h)("omfx-button",{attrs:{dark:this.theming.body.bg.dark,text:this.uxLoc.Common.Buttons.Back},domProps:{onClick:()=>{this.inVideoUrlInputMode=!0},mode:n.ButtonModes.flat,icon:{iconType:new n.FontAwesomeIcon("arrow_back"),position:n.ButtonIconPosition.Left}}})),e.push((0,r.h)("v-spacer")),e.push((0,r.h)("omfx-button",{attrs:{dark:!0,text:this.uxLoc.Common.Buttons.Ok},domProps:{styles:{textColor:this.theming.chrome.components.text.color.base,bgColor:this.theming.chrome.components.color.base},onClick:()=>{this.saveMSStreamResult()},mode:n.ButtonModes.raised}}))),e.push((0,r.h)("omfx-button",{attrs:{dark:this.theming.body.bg.dark,text:this.uxLoc.Common.Buttons.Close},domProps:{onClick:()=>{this.closed?.()},mode:n.ButtonModes.flat}})),e}render(){return this.renderBase((()=>{let e=null;return e=this.inVideoUrlInputMode?this.renderMicrosoftStreamUrlInput():this.renderSelectedVideoSettings(),e}))}};S([(0,a.Localize)(p.namespace)],x.prototype,"loc",2),S([(0,a.Inject)(s.MicrosoftStreamService)],x.prototype,"microsoftStreamService",2),S([(0,a.Inject)(u.OmniaTheming)],x.prototype,"omniaTheming",2),x=S([o.default],x),a.WebComponentBootstrapper.registerElement((e=>{(0,a.vueCustomElement)(e.elementName,x)}))},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/typestyle/umd/typestyle.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/typestyle/umd/typestyle.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,i)=>{e.exports=i("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,i)=>{e.exports=i("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"a3e11883-9574-4070-b80e-40faef6801d2":(e,t,i)=>{e.exports=i("dll-reference md66")("a3e11883-9574-4070-b80e-40faef6801d2")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,i)=>{e.exports=i("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,i)=>{e.exports=i("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,i)=>{e.exports=i("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["e20801d6-1d54-4a75-a1ce-7a65cb30cac6"])throw new Error("Error, already loaded manifest e20801d6-1d54-4a75-a1ce-7a65cb30cac6 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["e20801d6-1d54-4a75-a1ce-7a65cb30cac6"]=i;var t={};function i(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,i),a.exports}i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};i("./client/fx/ux/mediapickerproviders/microsoftstream/microsoftstreamprovider.tsx")})()};