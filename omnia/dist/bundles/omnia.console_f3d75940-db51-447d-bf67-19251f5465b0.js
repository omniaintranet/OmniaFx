if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["f3d75940-db51-447d-bf67-19251f5465b0"])throw new Error("Error, already loaded manifest f3d75940-db51-447d-bf67-19251f5465b0 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["f3d75940-db51-447d-bf67-19251f5465b0"]=function(){(()=>{var e={"./client/fx/console/components/console.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ConsoleComponent:()=>k,WindowStates:()=>E});var i=s("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),o=s("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),n=s("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","f3d75940-db51-447d-bf67-19251f5465b0"),r=s("./node_modules/typestyle/umd/typestyle.js"),a=s("./node_modules/csx/lib.es2015/index.js");const l=(0,r.style)({height:328,position:"absolute",bottom:0,width:(0,a.percent)(100),zIndex:1e4,backgroundColor:"#424242"});(0,r.style)({overflowY:"scroll"});(0,r.cssRule)(".omfxTerminal",{overflowY:"scroll"});
/*! terminal.ts v2.0 | (c) 2014 Erik Ã–sterberg | https://github.com/eosterberg/terminaljs */
/*! Converted to TypeScript and extended by @Omnia Team */
class d{constructor(e){this._firstPrompt=!0,this._shouldBlinkCursor=!0,this.inputHistory=new Array,this.inputHistoryIndex=0,this.lastKeyUp=!1,this.lastKeyDown=!1,this.init(e)}init(e){this.html=document.createElement("div"),this.html.className="omfxTerminal","string"==typeof e&&(this.html.id=e),this._innerWindow=document.createElement("div"),this._output=document.createElement("p"),this._inputLine=document.createElement("span"),this._cursor=document.createElement("span"),this._input=document.createElement("p"),this._input.appendChild(this._inputLine),this._input.appendChild(this._cursor),this._innerWindow.appendChild(this._output),this._innerWindow.appendChild(this._input),this.html.appendChild(this._innerWindow),this.setBackgroundColor("black"),this.setTextColor("white"),this.setTextSize("1em"),this.setWidth("100%"),this.setHeight("100%"),this.html.style.fontFamily="Monaco, Courier",this.html.style.margin="0",this._innerWindow.style.padding="10px",this._input.style.margin="0",this._output.style.margin="0",this._cursor.style.background="white",this._cursor.innerHTML="C",this._cursor.style.display="none",this._input.style.display="none"}fireCursorInterval(e,t){const s=t._cursor;setTimeout((()=>{e.parentElement&&t._shouldBlinkCursor?(s.style.visibility="visible"===s.style.visibility?"hidden":"visible",this.fireCursorInterval(e,t)):s.style.visibility="visible"}),500)}promptInput(e,t,s,i){const o=s===h.Input,n=document.createElement("input");n.style.zIndex="-100",n.style.outline="none",n.style.border="none",n.style.opacity="0",n.style.fontSize="0.2em",e._inputLine.textContent="",e._input.style.display="block",e.html.appendChild(n),this.fireCursorInterval(n,e),t.length&&e.print(s===h.Confirm?t+" (y/n)":t),n.onblur=()=>{e._cursor.style.display="none"},n.onfocus=()=>{n.value=e._inputLine.textContent,e._cursor.style.display="inline"},e.html.onclick=()=>{n.focus()},n.onkeydown=t=>{37===t.which||39===t.which||38===t.which||40===t.which||9===t.which?t.preventDefault():o&&13!==t.which&&setTimeout((()=>{e._inputLine.textContent=n.value}),1)},n.onkeyup=t=>{if(s===h.Confirm||13===t.which){this.html.scrollTop=this.html.scrollHeight,e._input.style.display="none";const t=n.value;this.inputHistory.unshift(t),this.inputHistoryIndex=0,o&&e.print(t),e.html.removeChild(n),"function"==typeof i&&(s===h.Confirm?i("Y"===t.toUpperCase()[0]):i(t))}else if(38===t.which){if(this.inputHistory.length>0&&(this.lastKeyDown&&(this.inputHistoryIndex=this.inputHistoryIndex+1),this.inputHistoryIndex>=this.inputHistory.length&&(this.inputHistoryIndex=0),this.inputHistory.length>=this.inputHistoryIndex)){const e=1==this.inputHistory.length?1:this.inputHistoryIndex;this._inputLine.textContent=this.inputHistory[e],this.inputHistoryIndex=this.inputHistoryIndex+1,n.value=this.inputHistory[e]}this.lastKeyUp=!0,this.lastKeyDown=!1}else if(40===t.which){if(this.inputHistory.length>0&&(this.lastKeyUp&&(this.inputHistoryIndex=this.inputHistoryIndex-1),this.inputHistoryIndex>0?this.inputHistoryIndex=this.inputHistoryIndex-1:this.inputHistoryIndex=this.inputHistory.length-1,this.inputHistory.length>=this.inputHistoryIndex)){const e=1==this.inputHistory.length?0:this.inputHistoryIndex;this._inputLine.textContent=this.inputHistory[e],n.value=this.inputHistory[e]}this.lastKeyUp=!1,this.lastKeyDown=!0}},this._firstPrompt?(this._firstPrompt=!1,setTimeout((()=>{n.focus()}),50)):n.focus()}print(e,t){const s=document.createElement("div");t&&(s.style.cssText="color:"+t+";"),s.style.cssText+="font-family: monospace; font-size:16px;",s.textContent=e,this._output.appendChild(s)}input(e,t){this.promptInput(this,e,h.Input,t)}password(e,t){this.promptInput(this,e,h.Password,t)}confirm(e,t){this.promptInput(this,e,h.Confirm,t)}clear(){this._output.innerHTML=""}sleep(e,t){setTimeout(t,e)}setTextSize(e){this._output.style.fontSize=e,this._input.style.fontSize=e}setTextColor(e){this.html.style.color=e,this._cursor.style.background=e}setBackgroundColor(e){this.html.style.background=e}setWidth(e){this.html.style.width=e}setHeight(e){this.html.style.height=e}blinkingCursor(e){e=e.toString().toUpperCase(),this._shouldBlinkCursor="TRUE"===e||"1"===e||"YES"===e}}var h=(e=>(e[e.Input=1]="Input",e[e.Password=2]="Password",e[e.Confirm=3]="Confirm",e))(h||{}),m=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),p=s("./node_modules/vue-tsx-support/dist/esm/index.js"),c=s("5e618f4d-d014-414e-a681-89e34cbeda0f"),b=s("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),u=Object.defineProperty,f=Object.getOwnPropertyDescriptor,y=(e,t,s,i)=>{for(var o,n=i>1?void 0:i?f(t,s):t,r=e.length-1;r>=0;r--)(o=e[r])&&(n=(i?o(t,s,n):o(n))||n);return i&&n&&u(t,s,n),n};let g=class extends p.Component{constructor(){super(...arguments),this.headers=[{value:"type",text:"Type",align:"left",sortable:!0},{value:"storeName",text:"Store",align:"left",sortable:!0},{value:"name",text:"Target",align:"left",sortable:!0}]}mounted(){}render(){return(0,i.h)("v-data-table",{style:{height:this.height-64+"px",overflow:"scroll"},attrs:{dark:!0,"hide-default-footer":!0,"fill-height":!0,headers:this.headers,items:c.Store.logging.log,"item-key":"id","items-per-page":Number.MAX_SAFE_INTEGER},scopedSlots:{item:e=>[(0,i.h)("tr",{on:{click:()=>{e.expanded=!e.expanded}}},[(0,i.h)("td",{class:(0,r.classes)("text-left")},[e.item.type]),(0,i.h)("td",{class:(0,r.classes)("text-left")},[e.item.storeName]),(0,i.h)("td",{class:(0,r.classes)("text-left")},[e.item.name])])],expand:e=>[(0,i.h)("v-card",{attrs:{flat:!0}},[(0,i.h)("v-card-text",["Store Id:",e.item.storeId])])]}})}};y([(0,b.Prop)()],g.prototype,"height",2),g=y([o.default],g);var x=s("./client/fx/core/messaging/messagebus.js"),v=Object.defineProperty,C=Object.getOwnPropertyDescriptor,w=(e,t,s,i)=>{for(var o,n=i>1?void 0:i?C(t,s):t,r=e.length-1;r>=0;r--)(o=e[r])&&(n=(i?o(t,s,n):o(n))||n);return i&&n&&v(t,s,n),n};let S=class extends p.Component{constructor(){super(...arguments),this.subscriptions=[],this.headers=[{value:"path",text:"Path",align:"left",sortable:!0},{value:"subscribeCount",text:"Subscribers",align:"left",sortable:!0}]}mounted(){this.subscribers=x.MessageBus._subscribers,this.getSubscriptions(),this.refreshIntervalId=setInterval(this.getSubscriptions,500)}beforeDestroy(){clearInterval(this.refreshIntervalId)}getSubscriptions(){const e=[];Object.keys(this.subscribers).forEach((t=>{const s=this.subscribers[t];e.push({path:t,subscribeCount:s.length,subscribeFuncs:s})})),this.subscriptions=e}renderChildItems(e){}render(){return(0,i.h)("v-data-table",{style:{height:this.height-64+"px",overflow:"scroll"},attrs:{dark:!0,"hide-default-footer":!0,"fill-height":!0,headers:this.headers,items:this.subscriptions,"item-key":"path","items-per-page":Number.MAX_SAFE_INTEGER},scopedSlots:{item:e=>[(0,i.h)("tr",{on:{click:()=>{e.expanded=!e.expanded}}},[(0,i.h)("td",{class:(0,r.classes)("text-left")},[e.item.path]),(0,i.h)("td",{class:(0,r.classes)("text-left")},[e.item.subscribeCount])])],expand:e=>[(0,i.h)("v-card",{attrs:{dark:!0},style:"padding:0 20px 20px 20px;"},[e.item.subscribeFuncs.map((e=>(0,i.h)("v-card",{attrs:{light:!0},style:"margin-top:20px"},[(0,i.h)("v-card-text",[e.toString()]),(0,i.h)("v-card-actions",[(0,i.h)("omfx-button",{attrs:{small:!0,text:"Debug"},domProps:{onClick:()=>{console.dir(e)}}})])])))])]}})}};w([(0,b.Prop)()],S.prototype,"height",2),S=w([o.default],S);var I=s("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","f3d75940-db51-447d-bf67-19251f5465b0"),T=Object.defineProperty,_=Object.getOwnPropertyDescriptor,H=(e,t,s,i)=>{for(var o,n=i>1?void 0:i?_(t,s):t,r=e.length-1;r>=0;r--)(o=e[r])&&(n=(i?o(t,s,n):o(n))||n);return i&&n&&T(t,s,n),n};let k=class extends I.VueComponentBase{constructor(){super(...arguments),this.minimized=!1,this.updateHeight=!1,this.maximized=!1,this.closing=!1,this.windowStateKey="omnia.console.wndstate",this.tabNames={terminal:0,store:1,messagebus:2},this.activeTab=0}created(){}mounted(){n.WebComponentBootstrapper.registerElementInstance(this,this.$el),c.Store.logging.enable(),this.terminal=new d("terminal"),this.terminal.setHeight(this.getTerminalHeight()),this.terminal.setBackgroundColor("#1D1F21"),this.terminal.setTextColor("#C5C8C6"),this.setupEvents(),this.registerCommands(),n.ConsoleUIService.init(),window.addEventListener("resize",(e=>{this.terminal.setHeight(this.getTerminalHeight()),this.updateHeight=!0,this.updateHeight=!1})),this.omniaCtx.user.then((e=>{this.terminal.print("* Welcome to the Omnia Shell master"+e.uid,z.System),this.terminal.print("* Type help to learn more about the Omnia shell",z.System),this.command()})),this.terminalHolder=document.getElementById("omfxConsole"),this.terminalHolder.appendChild(this.terminal.html)}destroyed(){}command(){this.terminal.input("",(e=>{this.processCommand(e),this.command()}))}setupEvents(){this.subscriptionHandler.add(n.ConsoleUIService.onMessagePrintRequest.subscribe(this.onMessagePrinted)),this.subscriptionHandler.add(n.ConsoleUIService.onConsoleCleared.subscribe(this.clear)),this.subscriptionHandler.add(n.ConsoleUIService.stateStorage.onStateStorageAction.subscribe(this.stateActionHandler))}stateActionHandler(e){e.type==m.ConsoleStateStorageMessageTypes.SaveState?n.ConsoleUIService.stateStorage.setStateValue("omnia.console.wndstate",this.getWindowState()):e.type==m.ConsoleStateStorageMessageTypes.RestoreState&&this.restoreWindowState(n.ConsoleUIService.stateStorage.getStateValue("omnia.console.wndstate"))}clear(){this.terminal.clear()}onMessagePrinted(e){let t=z.System;switch(e.type){case m.ConsoleMessageTypes.System:t=z.System;break;case m.ConsoleMessageTypes.Info:t=z.Info;break;case m.ConsoleMessageTypes.Good:t=z.Good;break;case m.ConsoleMessageTypes.Error:t=z.Error;break;case m.ConsoleMessageTypes.Warn:t=z.Warn;break;case m.ConsoleMessageTypes.Todo:t=z.Todo}this.terminal.print(e.message,t)}processCommand(e){let t=[e=e.trim()];e.indexOf(" ")&&(t=e.split(" ")),e=t[0],n.ConsoleUIService.commandExists(e)?n.ConsoleUIService.executeCommand(e,t):this.terminal.print("command not found")}registerCommands(){n.ConsoleUIService.addCommand({name:"quit",description:"Quits the console",action:()=>{this.close()}}),n.ConsoleUIService.addCommand({name:"exit",hidden:!0,action:()=>{this.close()}})}printHelpLine(e,t){this.terminal.print(e+" : "+t)}close(){this.closing=!0,n.ConsoleUIService.dispose(),document.body.removeChild(document.getElementsByTagName("omnia-console")[0])}maximize(){this.minimized=!1,this.maximized=!this.maximized,this.terminal.setHeight(this.getTerminalHeight()),n.ConsoleUIService.stateStorage.saveState()}minimize(){this.maximized=!1,this.minimized=!this.minimized,n.ConsoleUIService.stateStorage.saveState()}showTerminal(){this.activeTab=this.tabNames.terminal}showStore(){this.activeTab=this.tabNames.store}showMessageBus(){this.activeTab=this.tabNames.messagebus}getWindowState(){return this.maximized?E.Maximized:this.minimized?E.Minimize:this.closing?E.Closed:E.Default}restoreWindowState(e){switch(e){case E.Maximized:this.maximize();break;case E.Minimize:this.minimize()}}getTerminalHeight(){return this.maximized?window.innerHeight:this.minimized?64:328}render(){return(0,i.h)("div",{class:l,style:(this.updateHeight,{height:this.getTerminalHeight()+"px"})},[(0,i.h)("v-app-bar",{attrs:{dark:!0}},[(0,i.h)("v-toolbar-title",["Omnia Developer Console"]),(0,i.h)("v-btn-toggle",{attrs:{group:!0,mandatory:!0},model:{value:this.activeTab,callback:e=>{this.activeTab=e}}},[(0,i.h)("omfx-button",{attrs:{dark:!0,text:"Terminal"},domProps:{onClick:this.showTerminal,mode:m.ButtonModes.flat,icon:{iconType:new m.FontAwesomeIcon("fas fa-terminal"),position:m.ButtonIconPosition.Right}}}),(0,i.h)("omfx-button",{attrs:{dark:!0,text:"store"},domProps:{onClick:this.showStore,mode:m.ButtonModes.flat,icon:{iconType:new m.FontAwesomeIcon("fas fa-history"),position:m.ButtonIconPosition.Right}}}),(0,i.h)("omfx-button",{attrs:{dark:!0,text:"messagebus"},domProps:{onClick:this.showMessageBus,mode:m.ButtonModes.flat,icon:{iconType:new m.FontAwesomeIcon("fas fa-bolt"),position:m.ButtonIconPosition.Right}}})]),(0,i.h)("v-spacer"),(0,i.h)("omfx-button",{attrs:{dark:!0},domProps:{onClick:this.maximize,mode:m.ButtonModes.flat,icon:{iconType:new m.FontAwesomeIcon("fas "+(this.maximized?"fa-compress":"fa-window-maximize"))}}}),(0,i.h)("omfx-button",{attrs:{dark:!0},domProps:{onClick:this.minimize,mode:m.ButtonModes.flat,icon:{iconType:new m.FontAwesomeIcon("fas "+(this.minimized?"fa-expand":"fa-minus"))}}}),(0,i.h)("omfx-button",{attrs:{dark:!0},domProps:{onClick:this.close,mode:m.ButtonModes.flat,icon:{iconType:new m.FontAwesomeIcon("fas fa-times")}}})]),(0,i.h)("div",{attrs:{id:"omfxConsole"},style:this.activeTab!==this.tabNames.terminal?{display:"none"}:{height:this.getTerminalHeight()-64+"px"}}),(0,i.h)("div",{style:this.activeTab!==this.tabNames.store?{display:"none"}:{height:this.getTerminalHeight()-64+"px"}},[(0,i.h)(g,{attrs:{height:this.getTerminalHeight()}})]),(0,i.h)("div",{style:this.activeTab!==this.tabNames.messagebus?{display:"none"}:{height:this.getTerminalHeight()-64+"px"}},[(0,i.h)(S,{attrs:{height:this.getTerminalHeight()}})])])}};H([(0,n.Inject)(n.SubscriptionHandler)],k.prototype,"subscriptionHandler",2),H([(0,n.Inject)(n.OmniaContext)],k.prototype,"omniaCtx",2),H([(0,n.Localize)("Omnia.Ux")],k.prototype,"loc",2),k=H([o.default],k),n.WebComponentBootstrapper.registerElement((e=>{(0,n.vueCustomElement)(e.elementName,k)}));var z=(e=>(e.System="#5E8D87",e.Info="#707880",e.Error="#A54242",e.Warn="#F0C674",e.Good="#8C9440",e.Todo="#DE935F",e))(z||{}),E=(e=>(e.Maximized="max",e.Minimize="min",e.Default="def",e.Closed="clo",e))(E||{})},"./client/fx/core/messaging/messagebus.js":(e,t,s)=>{e.exports=s("dll-reference md9")("./client/fx/core/messaging/messagebus.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/csx/lib.es2015/index.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/csx/lib.es2015/index.js")},"./node_modules/typestyle/umd/typestyle.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/typestyle/umd/typestyle.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"./node_modules/vue-tsx-support/dist/esm/index.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-tsx-support/dist/esm/index.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,s)=>{e.exports=s("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,s)=>{e.exports=s("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,s)=>{e.exports=s("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,s)=>{e.exports=s("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["f3d75940-db51-447d-bf67-19251f5465b0"])throw new Error("Error, already loaded manifest f3d75940-db51-447d-bf67-19251f5465b0 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["f3d75940-db51-447d-bf67-19251f5465b0"]=s;var t={};function s(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};s("./client/fx/console/components/console.tsx")})()};