if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"])throw new Error("Error, already loaded manifest a5a89056-b5f5-475d-8518-a1f55090379d with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]=function(){(()=>{var e={"./client/fx/bootstrapper.js":(e,t,s)=>{"use strict";s.r(t);var i=s("./node_modules/dayjs/dayjs.min.js"),r=s.n(i),a=s("./node_modules/dayjs/plugin/utc.js"),n=s.n(a),o=s("./node_modules/dayjs/plugin/timezone.js"),c=s.n(o),p=s("./node_modules/dayjs/plugin/duration.js"),l=s.n(p),d=s("./node_modules/dayjs/plugin/relativetime.js"),h=s.n(d),u=s("./node_modules/vue/dist/vue.esm.js"),g=s("./client/fx/vue/vuecustomelement/vuecustomelement.js"),m=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),f=s("ff061abc-7f0e-444b-b2b9-7ff71c5842c5"),y=s("10407664-c0c5-438b-94b2-507d58d190af");var P=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),v=s("9a75501c-254b-46d1-9010-7b13681e06f4"),b=s("46b8884f-20d6-40e6-b24e-54d8a6126ac9"),S=s("./client/fx/core/services/internalconfigurationservice.js");const I=window.omniaVendor;if(r().extend(n()),r().extend(c()),r().extend(l()),r().extend(h()),r().locale("en-us"),window.omnia.uiThreadId??=v.Guid.newGuid(),window.omnia.workerThreadId??=v.Guid.newGuid(),window.omnia&&window.omnia.language&&(0===window.omnia.language.toLowerCase().indexOf("sv")&&(I("./node_modules/dayjs/locale/sv.js"),r().locale("sv-se")),0===window.omnia.language.toLowerCase().indexOf("da")&&(I("./node_modules/dayjs/locale/da.js"),r().locale("da")),0===window.omnia.language.toLowerCase().indexOf("pl")&&(I("./node_modules/dayjs/locale/pl.js"),r().locale("pl")),0===window.omnia.language.toLowerCase().indexOf("fr")&&(I("./node_modules/dayjs/locale/fr.js"),r().locale("fr")),0===window.omnia.language.toLowerCase().indexOf("de")&&(I("./node_modules/dayjs/locale/de.js"),r().locale("de")),0===window.omnia.language.toLowerCase().indexOf("et")&&(I("./node_modules/dayjs/locale/et.js"),r().locale("et")),0===window.omnia.language.toLowerCase().indexOf("lv")&&(I("./node_modules/dayjs/locale/lv.js"),r().locale("lv")),0===window.omnia.language.toLowerCase().indexOf("lt")&&(I("./node_modules/dayjs/locale/lt.js"),r().locale("lt"))),class{static init(){y.InternalTopics.loadResourcesForElementName.subscribe((e=>{f.ManifestByElementLoader.loadResourcesForElementName(e)})),y.InternalTopics.loadResourcesManifestWithId.subscribe((e=>{const t=f.ManifestResourceLoader.getManifest("bb000000-0000-bbbb-0000-0000000000bb",e.toString());f.ManifestResourceLoader.loadResources(t).then((()=>{})).catch((e=>{m.Console.logDebug("Loaded rejected for manifest: "+JSON.stringify(t)+", load requested over message bus")}))})),Zepto((()=>{document.body.setAttribute("data-app","true")})),window.Vue=u.default,m.WebUtils.getQs("debug")&&(u.default.config.devtools=!0),u.default.use(g.default),u.default.mixin({beforeCreate:function(){if(this.__proto__&&this.__proto__.constructor){const e=this,t=e.$options,s=e.__proto__.constructor;e.omwc?(e.$omniaprovide=t.parent.$omniaprovide,t.parent.__omwc__=e):e.$omniaprovide=t&&t.parent&&t.parent.$omniaprovide||[];const i=(e,t,s,i)=>{var r;Object.defineProperty(i,s,{get:(r=s,function(){return this[`__omniaprovided__${r}`].instance}),set:function(e){return function(t){this[`__omniaprovided__${e}`].instance=t}}(s),enumerable:!0,configurable:!0});const a=i.$omniaprovide.findIndex((t=>t.classType.prototype===e.prototype));a>-1&&i.$omniaprovide.splice(a,1),i[`__omniaprovided__${s}`]={classType:e,instance:t},i.$omniaprovide.push(i[`__omniaprovided__${s}`])};let r=null;if(s.__omniaprovide__instance__){e.$omniaprovide=e.$omniaprovide.slice();const t=s.__omniaprovide__instance__;for(const s in t)if(t[s].classType.prototype===m.ServiceContainerContext.prototype){r=m.ServiceContainer.createInstance(t[s].classType,t[s].constructorArgs,!0),i(t[s].classType,r,s,e);break}}if(!r&&e.$omniaprovide&&(r=e.$omniaprovide.find((e=>e.classType.prototype===m.ServiceContainerContext.prototype))?.instance),r||(r=m.ServiceContainer),s.__omniaprovide__static__||s.__omniaprovide__instance__){if(e.$omniaprovide=e.$omniaprovide.slice(),e.omwc&&(t.parent.$omniaprovide=e.$omniaprovide),s.__omniaprovide__static__){const t=s.__omniaprovide__static__;for(const s in t)t.hasOwnProperty(s)&&i(t[s].classType,t[s].instance,s,e)}if(s.__omniaprovide__instance__){const t=s.__omniaprovide__instance__;for(const s in t)e[s]||i(t[s].classType,r.createInstance(t[s].classType,t[s].constructorArgs,!0),s,e)}}if(s.__omniainject__static__){const t=s.__omniainject__static__;for(const s in t)t.hasOwnProperty(s)&&(e[s]=t[s].instance,e.$omniaprovide&&e.$omniaprovide.find((e=>e.classType.prototype==t[s].prototype))&&console.warn("Found use @inject for static member while have parent provide instance",e))}if(s.__omniainject__instance__){const t=s.__omniainject__instance__;for(const s in t){const i=e.$omniaprovide.find((e=>e.classType.prototype==t[s].classType.prototype));i?(e[`__omniaprovided__${s}`]=i,Object.defineProperty(e,s,{get:function(e){return function(){return this[`__omniaprovided__${e}`].instance}}(s),set:function(e){return function(t){throw`${this.$vnode?this.$vnode.tag:""} can't reassign the property ${e} because that already inherit from parent provided.`}}(s),enumerable:!0,configurable:!0})):e[s]=r.createInstance(t[s].classType,t[s].constructorArgs)}}if(s.__omnialocalize__){const e=s.__omnialocalize__;for(const t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}}},mounted:function(){!this.omwc&&this.omvc&&this.$el.setAttribute&&(this.$el.setAttribute("data-omvc",""),this.$el.__omvc__=this)},updated:function(){!this.omwc&&this.omvc&&!this.$el.__omvc__&&this.$el.setAttribute&&(this.$el.setAttribute("data-omvc",""),this.$el.__omvc__=this)},destroyed:function(){if(this.__proto__&&this.__proto__.constructor&&this.__proto__.constructor&&(y.InternalTopics.vueOnDestroyed.publish({instance:this}),this.__proto__.constructor.__omniaprovide__instance__||this.__proto__.constructor.__omniaprovide__static__)){const e=Object.assign({},this.__proto__.constructor.__omniaprovide__static__||{},this.__proto__.constructor.__omniaprovide__instance__||{});Object.keys(e).forEach((e=>{this[e]instanceof m.ServiceContainerContext&&this[e].dispose()}))}}})}}.init(),window.Worker){S.InternalConfigurationService.getConfiguration()?.enableWorker&&y.InternalTopics.omniaBootstrapperCompleted.subscribe((async()=>{const e=f.ManifestResourceLoader.getManifestById(P.OmniaResourceManifests.FxWorkersBootstrapper),t=`importScripts( "${new f.LoadableManifest(e).getBundleUrl(P.BundleTargetTypes.Javascript)}${f.LocalHostingService.instance.hasServing()?"&omniaworker":""}" );`,s=URL.createObjectURL(new Blob([t],{type:"text/javascript"})),i=new Worker(s);b.WorkerProxy._worker=i,b.WorkerProxy.addFunction(b.WorkerProxyFuncs.ui.loadManifests,(e=>{const t={type:"loadManifests",resourceUrls:[]};return e.forEach((e=>{const s=f.ManifestResourceLoader.getManifestById(e),i=new f.LoadableManifest(s).getBundleUrl(P.BundleTargetTypes.Javascript);t.resourceUrls.push(i)})),i.postMessage(t),e}));const r={type:"bootWorker",loadManifests:{type:"loadManifests",resourceUrls:[]},bootData:{tenant:window.omnia.tenant,uiThreadId:window.omnia.uiThreadId,workerThreadId:window.omnia.workerThreadId,customDomain:window.omnia.customDomain,defaultDomain:window.omnia.defaultDomain,routePrefixes:window.omnia.routePrefixes,language:window.omnia.language,licenses:[],tokenKey:window.omnia.tokenKey,omniaHubMode:!!m.WebUtils.getQs("omniahub"),servingMode:f.LocalHostingService.instance.hasServing()}};window.omnia.omniaHubMode=r.bootData.omniaHubMode;let a=f.ManifestResourceLoader.getManifestById(P.OmniaResourceManifests.FxWorkers),n=new f.LoadableManifest(a).getBundleUrl(P.BundleTargetTypes.Javascript);r.loadManifests.resourceUrls.push(n),a=f.ManifestResourceLoader.getManifestById(P.OmniaResourceManifests.FxShared),n=new f.LoadableManifest(a).getBundleUrl(P.BundleTargetTypes.Javascript),r.loadManifests.resourceUrls.push(n),a=f.ManifestResourceLoader.getManifestById(P.OmniaResourceManifests.OmniaHubWorker),n=new f.LoadableManifest(a).getBundleUrl(P.BundleTargetTypes.Javascript),r.loadManifests.resourceUrls.push(n),i.addEventListener("message",(function e(t){"bootWorker"===t.data.type&&(i.postMessage(JSON.parse(JSON.stringify(r))),i.removeEventListener("message",e))})),i.postMessage(JSON.parse(JSON.stringify(r)))}))}},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ApiHelper:()=>m,AppRoutePropertyBagFactory:()=>a.AppRoutePropertyBagFactory,BusinessProfilePathPropertyBagFactory:()=>a.BusinessProfilePathPropertyBagFactory,BusinessProfilePropertyBagFactory:()=>a.BusinessProfilePropertyBagFactory,Console:()=>a.Console,ConsoleUIService:()=>a.ConsoleUIService,ContextProviderCollection:()=>l.ContextProviderCollection,Cookies:()=>a.Cookies,DisplayRules:()=>h,Encoder:()=>a.Encoder,EnterprisePropertyHandler:()=>a.EnterprisePropertyHandler,ErrorBus:()=>a.ErrorBus,Extend:()=>a.Extend,GraphClient:()=>a.GraphClient,HttpClient:()=>a.HttpClient,HttpContextProviderCollection:()=>a.HttpContextProviderCollection,IAppRouteFactory:()=>a.IAppRouteFactory,IBusinessProfileFactory:()=>a.IBusinessProfileFactory,ITenantFactory:()=>a.ITenantFactory,ImageProxyService:()=>C.ImageProxyService,Inject:()=>a.Inject,Injectable:()=>a.Injectable,LocalStorage:()=>a.LocalStorage,Localize:()=>d.Localize,MD5Util:()=>a.MD5Util,ManifestResourceLoader:()=>a.ManifestResourceLoader,MessageBusExposeOnlyPublication:()=>a.MessageBusExposeOnlyPublication,MessageBusExposeOnlySubscription:()=>a.MessageBusExposeOnlySubscription,MessageBusTopicMediator:()=>a.MessageBusTopicMediator,MigrationUtils:()=>a.MigrationUtils,NamedPropertyOperationsFactory:()=>a.NamedPropertyOperationsFactory,OmniaContext:()=>l.OmniaContext,OmniaContextProvider:()=>l.OmniaContextProvider,OmniaPropertyBagBase:()=>a.OmniaPropertyBagBase,Provide:()=>a.Provide,ReplaceToken:()=>p,Require:()=>a.Require,ScrollPagingUtils:()=>a.ScrollPagingUtils,ServiceContainer:()=>a.ServiceContainer,ServiceContainerContext:()=>a.ServiceContainerContext,ServiceLocator:()=>a.ServiceLocator,ServiceManifestProvider:()=>a.ServiceManifestProvider,SubscriptionHandler:()=>a.SubscriptionHandler,TenantPropertyBagFactory:()=>a.TenantPropertyBagFactory,TokenService:()=>a.TokenService,Topics:()=>a.Topics,UserPropertyBagFactory:()=>a.UserPropertyBagFactory,Utils:()=>a.Utils,VueWebComponentSlot:()=>d.VueWebComponentSlot,WebComponentBootstrapper:()=>x,WebUtils:()=>a.WebUtils,extendApi:()=>T,install:()=>d.install,isInjectable:()=>a.isInjectable,omniaScriptApi:()=>f,propertyPath:()=>a.propertyPath,propertyPathValue:()=>a.propertyPathValue,registerApi:()=>a.registerApi,setCurrentManifest:()=>L,useInject:()=>a.useInject,useLocalize:()=>d.useLocalize,useOmniaClient:()=>a.useOmniaClient,useProvide:()=>a.useProvide,vueCustomElement:()=>d.vueCustomElement});var i={};s.r(i),s.d(i,{ApiHelper:()=>m,AppRoutePropertyBagFactory:()=>a.AppRoutePropertyBagFactory,BusinessProfilePathPropertyBagFactory:()=>a.BusinessProfilePathPropertyBagFactory,BusinessProfilePropertyBagFactory:()=>a.BusinessProfilePropertyBagFactory,Console:()=>a.Console,ConsoleUIService:()=>a.ConsoleUIService,ContextProviderCollection:()=>l.ContextProviderCollection,Cookies:()=>a.Cookies,DisplayRules:()=>h,Encoder:()=>a.Encoder,EnterprisePropertyHandler:()=>a.EnterprisePropertyHandler,ErrorBus:()=>a.ErrorBus,Extend:()=>a.Extend,GraphClient:()=>a.GraphClient,HttpClient:()=>a.HttpClient,HttpContextProviderCollection:()=>a.HttpContextProviderCollection,IAppRouteFactory:()=>a.IAppRouteFactory,IBusinessProfileFactory:()=>a.IBusinessProfileFactory,ITenantFactory:()=>a.ITenantFactory,ImageProxyService:()=>C.ImageProxyService,Inject:()=>a.Inject,Injectable:()=>a.Injectable,LocalStorage:()=>a.LocalStorage,Localize:()=>d.Localize,MD5Util:()=>a.MD5Util,ManifestResourceLoader:()=>a.ManifestResourceLoader,MessageBusExposeOnlyPublication:()=>a.MessageBusExposeOnlyPublication,MessageBusExposeOnlySubscription:()=>a.MessageBusExposeOnlySubscription,MessageBusTopicMediator:()=>a.MessageBusTopicMediator,MigrationUtils:()=>a.MigrationUtils,NamedPropertyOperationsFactory:()=>a.NamedPropertyOperationsFactory,OmniaContext:()=>l.OmniaContext,OmniaContextProvider:()=>l.OmniaContextProvider,OmniaPropertyBagBase:()=>a.OmniaPropertyBagBase,Provide:()=>a.Provide,ReplaceToken:()=>p,Require:()=>a.Require,ScrollPagingUtils:()=>a.ScrollPagingUtils,ServiceContainer:()=>a.ServiceContainer,ServiceContainerContext:()=>a.ServiceContainerContext,ServiceLocator:()=>a.ServiceLocator,ServiceManifestProvider:()=>a.ServiceManifestProvider,SubscriptionHandler:()=>a.SubscriptionHandler,TenantPropertyBagFactory:()=>a.TenantPropertyBagFactory,TokenService:()=>a.TokenService,Topics:()=>a.Topics,UserPropertyBagFactory:()=>a.UserPropertyBagFactory,Utils:()=>a.Utils,VueWebComponentSlot:()=>d.VueWebComponentSlot,WebUtils:()=>a.WebUtils,install:()=>d.install,isInjectable:()=>a.isInjectable,omniaScriptApi:()=>f,propertyPath:()=>a.propertyPath,propertyPathValue:()=>a.propertyPathValue,registerApi:()=>a.registerApi,useInject:()=>a.useInject,useLocalize:()=>d.useLocalize,useOmniaClient:()=>a.useOmniaClient,useProvide:()=>a.useProvide,vueCustomElement:()=>d.vueCustomElement});var r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?o(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&n(t,s,a),a};let p=class{constructor(){this._cachedProviders={}}resolve(e){return new Promise(((t,s)=>{if(a.Utils.isNullOrEmpty(e))t(e);else{let s=e.slice();const i=s.match(/{{([^}]+)}}/g);if(a.Utils.isArrayNullOrEmpty(i))t(e);else{const e=[];Array.from(new Set(i)).forEach((t=>{const i=t.substring(2,t.length-2),r=i.split(".")[0];if(this._cachedProviders[r]){const n=this._cachedProviders[r].resolve(i);a.Utils.isPromise(n)?e.push(new Promise(((e,r)=>{n.then((r=>{r.value?.toString()!==i&&(s=s.replace(this.buildRegExp(t),r.value.toString())),e()}))}))):n.value?.toString()!==i&&(s=s.replace(this.buildRegExp(t),n.value.toString()))}else e.push(new Promise((async(e,n)=>{(await omniaApi.fx.tokens.providers).getProviderByToken(i).then((n=>{if(n){this._cachedProviders[r]||(this._cachedProviders[r]=this.serviceContainerContext.createInstance(n));const o=this._cachedProviders[r].resolve(i);a.Utils.isPromise(o)?o.then((r=>{r.value?.toString()!==i&&(s=s.replace(this.buildRegExp(t),r.value.toString())),e()})):(o.value?.toString()!==i&&(s=s.replace(this.buildRegExp(t),o.value.toString())),e())}else e()}))})))})),Promise.all(e).then((()=>t(s)))}}}))}hasToken(e){return!a.Utils.isNullOrEmpty(e)&&null!==e.match(/{{([^}]+)}}/g)}buildRegExp(e){return new RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),"g")}};c([(0,a.Inject)(a.ServiceContainerContext)],p.prototype,"serviceContainerContext",2),p=c([(0,a.Injectable)({lifetime:r.InstanceLifetimes.Scoped})],p);var l=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),d=s("c041fe9f-1e14-443d-9407-5aa8829fbc21");class h{static IsPreviewMode(){return!a.Utils.isNullOrEmpty(a.WebUtils.getQs("preview"))}static IsFeaturePreviewMode(){return!a.Utils.isNullOrEmpty(a.WebUtils.getQs("featurepreview"))}static isAdvancedModeActivated(){return window.location.href.indexOf("advanced=true")>-1}}var u=s("4eeb27d5-906a-4edf-bd38-3d97048cda3d"),g=s("ff061abc-7f0e-444b-b2b9-7ff71c5842c5");class m{static getExtendApiConfiguration(e){const t=u.InternalExtend.getApiPathString(e);return this._resolvableApiConfigs[t]||(this._resolvableApiConfigs[t]=new r.Future(null),u.InternalExtend.getExtendApiConfiguration(e).then(this._resolvableApiConfigs[t].resolve,this._resolvableApiConfigs[t].reject)),this._resolvableApiConfigs[t]}static loadExtendApiManifest(e,t){return new r.Future(((s,i)=>{this.getExtendApiConfiguration(e).then((e=>{const r=t(e);r?g.ManifestResourceLoader.loadResources(r).then((()=>s()),i):i()}))}))}}m._resolvableApiConfigs={};const f={};a.ServiceContainer.createInstance(l.OmniaContext).environment.backendRuntime===r.OmniaBackendRuntimes.M365&&(f.m365={graphClient:new r.Future((e=>{e(a.ServiceContainer.createInstance(a.GraphClient))}))});var y=s("10407664-c0c5-438b-94b2-507d58d190af"),P=Object.defineProperty,v=Object.getOwnPropertyDescriptor,b=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?v(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&P(t,s,a),a};let S=class{constructor(){this._prefixTokensManifest={},this._resolveProviders={}}register(e){e.tokens.forEach((t=>{const s=(new t).prefixToken;this._resolveProviders[s]=this._resolveProviders[s]||new r.Future(null),this._resolveProviders[s].resolve(e.provider)}))}getProviderByToken(e){return new r.Future(((t,s)=>{const i=e.split(".")[0];this._resolveProviders[i]||(this._resolveProviders[i]=new r.Future(null),this.ready().then((()=>{this._prefixTokensManifest[i]?(g.ManifestResourceLoader.loadResources(this._prefixTokensManifest[i]),setTimeout((()=>{this._resolveProviders[i].resolved||console.error(`<<Api Token>> prefix token ${i} -> Have extend api manifest id ${this._prefixTokensManifest[i].resourceId} with service id ${this._prefixTokensManifest[i].omniaServiceId} waiting a long time after 10s. `)}),1e4)):t(null)}))),this._resolveProviders[i].then(t)}))}ready(){return this._ready||(this._ready=new r.Future(null),m.getExtendApiConfiguration((e=>e.fx.tokens.providers)).then((e=>{e.forEach((e=>{e.configuration.prefixTokens.forEach((t=>{this._prefixTokensManifest[t]?console.error(`<<Api Token>> Provider -> the ${t} already registerd from manifest`,this._prefixTokensManifest[t],e.manifest):this._prefixTokensManifest[t]=e.manifest}))})),this._ready.resolve()}))),this._ready}};S=b([(0,a.Injectable)({lifetime:r.InstanceLifetimes.Transient})],S);let I=class{constructor(){this._tokens=[]}register(e){this._tokens=this._tokens.concat(e),this._tokens.sort(((e,t)=>e.name.localeCompare(t.name)))}getTokens(){return this._tokens.slice()}};I=b([(0,a.Injectable)({lifetime:r.InstanceLifetimes.Transient})],I),y.InternalTopics.omniaBootstrapperCompleted.subscribe((()=>{(0,a.registerApi)((e=>e.fx.tokens.providers),(e=>e(a.ServiceContainer.createInstance(S)))),(0,a.registerApi)((e=>e.fx.tokens.registrations),(e=>e(a.ServiceContainer.createInstance(I))))}));var C=s("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),w=s("./client/fx/models/manifestids.js");
//! <omnia-transform-resource path="14a8d443-2e58-450b-a462-258bdaf69b49" />
u.Extend.fx||Object.defineProperty(u.Extend,"fx",{value:{},writable:!1,enumerable:!0}),u.Extend.fx.models=r,u.Extend.fx.apis=Object.assign({},i,{extendApi:(e,t,s,i)=>{u.InternalExtend.extendApi(s,e,t,i)}}),window.omniaApi=u.Extend,window.omniaScriptApi=f;class x{static registerElementInstance(e,t){return omniaWebpackJsonp[w.OmniaService.Id.toString()][w.OmniaResourceManifests.FxCore.toString()]("c9f21f62-e664-44e4-8cf4-0dcbec75c4bf").InternalWebComponentBootstrapper.registerElementInstance("bb000000-0000-bbbb-0000-0000000000bb","a5a89056-b5f5-475d-8518-a1f55090379d",e,t)}}function T(e,t){return u.InternalExtend.extendApi(e,null,null,t)}function L(e,t){return{...i,extendApi:function(s,i){return u.InternalExtend.extendApi(s,e,t,i)},WebComponentBootstrapper:{registerElement:function(s){omniaWebpackJsonp[w.OmniaService.Id.toString()][w.OmniaResourceManifests.FxCore.toString()]("c9f21f62-e664-44e4-8cf4-0dcbec75c4bf").InternalWebComponentBootstrapper.registerElement(e,t,s)},registerElementInstance:function(s,i){return omniaWebpackJsonp[w.OmniaService.Id.toString()][w.OmniaResourceManifests.FxCore.toString()]("c9f21f62-e664-44e4-8cf4-0dcbec75c4bf").InternalWebComponentBootstrapper.registerElementInstance(e,t,s,i)}}}}x.registerElement=e=>{omniaWebpackJsonp[w.OmniaService.Id.toString()][w.OmniaResourceManifests.FxCore.toString()]("c9f21f62-e664-44e4-8cf4-0dcbec75c4bf").InternalWebComponentBootstrapper.registerElement("bb000000-0000-bbbb-0000-0000000000bb","a5a89056-b5f5-475d-8518-a1f55090379d",e)}},"./client/fx/services/applayoutservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AppLayoutService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.createLayout=(e,t,s)=>{const i={definition:t,urlSegment:s};return new Promise(((t,s)=>{this.httpClient.post(`api/applayouts/create?${r.Parameters.AppInstanceId}=${e}`,i).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))},this.createAlternateLayout=(e,t,s)=>{const i={definition:s,title:t,appInstanceLayout:e};return new Promise(((t,s)=>{this.httpClient.post(`api/applayouts/alternatelayouts/create?${r.Parameters.AppInstanceId}=${e.appInstanceId}`,i).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))},this.deleteLayout=e=>new Promise(((t,s)=>{this.httpClient.post(`api/applayouts/delete?${r.Parameters.AppInstanceId}=${e.appInstanceId}`,e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateLayout=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/update",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.deleteAlternateLayout=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/alternatelayouts/delete",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getLayoutDefinitionLatestRef=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/definition/getlatestref",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getLayoutDefinitionVersion=e=>new Promise(((t,s)=>{this.httpClient.get(`api/applayouts/definition/version?versionId=${e.versionId}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.publishLayoutDefinition=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/definition/publish",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateLayoutDefinition=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/definition/update",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.checkInLayoutDefinition=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/definition/checkin",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.checkOutLayoutDefinition=(e,t=!1)=>new Promise(((s,i)=>{this.httpClient.post(`api/applayouts/definition/checkout?takeOver=${t}`,e).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.discardLayoutDefinition=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/definition/discard",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getLayoutByIdentifier=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/byidentifier",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getLayoutById=e=>new Promise(((t,s)=>{this.httpClient.get(`api/applayouts/byid?appInstanceLayoutId=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getLayoutsByAppId=e=>new Promise(((t,s)=>{this.httpClient.get(`api/applayouts/byappid?${r.Parameters.AppInstanceId}=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getLayoutVersionInformation=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/definition/versioninformation",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.setDisplayBreakpointAlternateLayoutMapping=(e,t)=>new Promise(((s,i)=>{this.httpClient.post(`api/applayouts/alternatelayouts/setdisplaybreakpointmapping?appInstanceLayoutId=${e}`,t).then((e=>{const t=e.data;t.success?s():i(t.errorMessage)})).catch(i)})),this.getDisplayBreakpointAlternateLayoutMappings=(...e)=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/alternatelayouts/getdisplaybreakpointmapping",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateAlternateLayout=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/alternatelayouts/update",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.validateLayoutUrl=e=>new Promise(((t,s)=>{this.httpClient.post("api/applayouts/url/validation",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/appservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AppService:()=>l});var i=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),r=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),a=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=s("ff061abc-7f0e-444b-b2b9-7ff71c5842c5"),o=Object.defineProperty,c=Object.getOwnPropertyDescriptor,p=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?c(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&o(t,s,a),a};let l=class{constructor(){this.getAppDefinitions=()=>new Promise(((e,t)=>{this.httpClient.get("api/apps/definitions").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.getTenantAppTemplates=()=>new Promise(((e,t)=>{this.httpClient.get("api/apps/alltemplates").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.getAppTemplates=e=>new Promise(((t,s)=>{this.httpClient.get(`api/apps/profiles/templates?${a.Parameters.BusinessProfileId}=${e||this.omniaContext.businessProfile.id}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getAppTemplate=e=>new Promise(((t,s)=>{this.httpClient.get(`api/apps/template?${a.Parameters.AppTemplateId}=${e}&${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.addOrUpdateAppTemplate=e=>new Promise(((t,s)=>{this.httpClient.post(`api/apps/template?${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}`,e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateAppTemplates=e=>new Promise(((t,s)=>{this.httpClient.post(`api/apps/templates?${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}`,e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.removeAppTemplate=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/apps/template?${a.Parameters.AppTemplateId}=${e}&${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.getProfileAppInstances=(e,t=!0)=>new Promise(((s,i)=>{this.httpClient.get(`api/apps/profiles/definitions/${e}/instances`,{params:{[a.Parameters.BusinessProfileId]:this.omniaContext.businessProfile.id,[a.Parameters.ShowInPublicListingsOnly]:t}}).then((t=>{const r=t.data;r.success?(r.data.appDefinitionId=e,s(r.data)):i(r.errorMessage)})).catch(i)})),this.getProfileAppInstancesByQuery=(e,t,s=!0)=>new Promise(((i,r)=>{const n=`${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}&${a.Parameters.ShowInPublicListingsOnly}=${s}`;this.httpClient.post(`api/apps/profiles/definitions/${e}/instances?${n}`,t).then((t=>{const s=t.data;s.success?(s.data.appDefinitionId=e,i(s.data)):r(s.errorMessage)})).catch(r)})),this.getProfilePublicAppInstancesByScopedQuery=(e,t,s)=>new Promise(((i,r)=>{this.httpClient.post(`api/apps/profiles/definitions/${e}/instances/public`,s,{params:{businessProfileId:t.toString(),appDefinitionId:e.toString()}}).then((e=>{const t=e.data;t.success?i(t.data):r(t.errorMessage)})).catch(r)})),this.createAppInstance=(e,t,s,i=null,r=!1)=>new Promise(((n,o)=>{this.ensureRemoveAppInstnaceIdAndProfileId(s),r&&((s=s||{}).useRouteProvisioning="true");const c=this.buildContextParamsUrl(s);null==i&&(i=this.omniaContext.businessProfile.id),this.httpClient.post(`api/apps/instance?${a.Parameters.AppTemplateId}=${e}&${a.Parameters.BusinessProfileId}=${i}${c}`,t,{headers:{profileId:i?.toString(),appInstanceId:""}}).then((e=>{const t=e.data;t.success?n(t.data):o(t.errorMessage)})).catch(o)})),this.ensureAppInstanceProvisioning=(e,t=null)=>new Promise(((s,i)=>{const r=t?"ensureprovisioningwithinput":"ensureprovisioning";this.httpClient.post(`api/apps/instance/${r}`,t,{params:{[a.Parameters.AppInstanceId]:e}}).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.requestChangeProvisioning=(e,t)=>new Promise(((s,i)=>{this.httpClient.post("api/apps/instance/requestchangeprovisioning",t,{params:{[a.Parameters.AppInstanceId]:e}}).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.updateAppInstance=(e,t,s)=>new Promise(((i,r)=>{this.ensureRemoveAppInstnaceIdAndProfileId(s);const n=this.buildContextParamsUrl(s);this.httpClient.put(`api/apps/instance?${a.Parameters.AppInstanceId}=${e}&${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}${n}`,t).then((e=>{const t=e.data;t.success?i(t.data):r(t.errorMessage)})).catch(r)})),this.approveAppInstance=(e,t,s)=>new Promise(((i,r)=>{const n=this.buildContextParamsUrl(s);this.httpClient.post(`api/apps/instance/approve?${a.Parameters.AppInstanceId}=${e}&${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}${n}`,t).then((e=>{const t=e.data;t.success?i(t.data):r(t.errorMessage)})).catch(r)})),this.rejectAppInstance=(e,t)=>new Promise(((s,i)=>{this.httpClient.post(`api/apps/instance/reject?${a.Parameters.AppInstanceId}=${e}&${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}`,t).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.removeAppInstance=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/apps/instance?${a.Parameters.AppInstanceId}=${e}&${a.Parameters.BusinessProfileId}=${this.omniaContext.businessProfile.id}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getAppInstanceById=e=>new Promise(((t,s)=>{this.httpClient.get(`api/apps/instance?${a.Parameters.AppInstanceId}=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getAppInstanceProgressByTransactionId=e=>new Promise(((t,s)=>{this.httpClient.get(`api/apps/instance/transactions/${e}/progress`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getAppInstanceOutputInfosByAppInstanceIds=e=>new Promise(((t,s)=>{this.httpClient.post("api/apps/getinstanceoutputinfos/byappinstanceids",e||[]).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getAppInstanceOutputInfosByAppDefinitionId=e=>new Promise(((t,s)=>{this.httpClient.get(`api/apps/getinstanceoutputinfos/byappdefinitionid?${a.Parameters.AppDefinitionId}=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getAppInstanceOutputInfosByFeatureDefinition=e=>new Promise(((t,s)=>{this.httpClient.get("api/apps/getinstanceoutputinfos/byfeatureactivation/id",{params:{activatedFeatureDefinitionId:e}}).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.followAppInstance=e=>new Promise(((t,s)=>{this.httpClient.post(`api/apps/instance/follow?${a.Parameters.AppInstanceId}=${e}`).then((e=>{const i=e.data;i.success?t(null):s(i.errorMessage)})).catch(s)})),this.unfollowAppInstance=e=>new Promise(((t,s)=>{this.httpClient.post(`api/apps/instance/unfollow?${a.Parameters.AppInstanceId}=${e}`).then((e=>{const i=e.data;i.success?t(null):s(i.errorMessage)})).catch(s)})),this.addOrUpdateLastVisited=e=>new Promise(((t,s)=>{this.httpClient.post(`api/apps/instance/lastvisited?${a.Parameters.AppInstanceId}=${e}`).then((e=>{const i=e.data;i.success?t(null):s(i.errorMessage)})).catch(s)})),this.getAppContextByAppInstanceId=e=>{const t=l.routes[e.toString().toLowerCase()];return t?new Promise(((e,s)=>{t.appRouteWithProperties?this.loadAppManifest(t).then((()=>{e(t)})):e(t)})):d.initialAppRouteExists?new Promise(((t,s)=>{this.httpClient.get(`api/context/byappinstanceid?appInstanceId=${e}`).then((i=>{if(i.data.success){const s=i.data.data;s&&(l.routes[e.toString().toLowerCase()]=s,s.appRouteWithProperties?(s.appRouteWithProperties.path&&(l.routes[s.appRouteWithProperties.path]=s),this.loadAppManifest(s).then((()=>{t(s)}))):t(s))}else s(i.data.errorMessage)})).catch(s)})):Promise.resolve(null)},this.getAppContext=e=>{const t=this.omniaContext.routePrefixes;let s=e;const i=t.find((t=>e.startsWith(`/${t}/`)));if(i){const t=e.split("/");s=`/${i}/${t[2]}`}else s="/";const r=l.routes[s];return r?new Promise(((e,t)=>{this.loadAppManifest(r).then((()=>{e(r)}))})):d.initialAppRouteExists?new Promise(((e,t)=>{this.httpClient.get(`api/context/bypath?path=${s}`).then((i=>{if(i.data.success){const t=i.data.data;t&&(l.routes[s]=t,t.appRouteWithProperties?(t.appRouteWithProperties.appInstance?.id&&(l.routes[t.appRouteWithProperties.appInstance.id.toString().toLowerCase()]=t),this.loadAppManifest(t).then((()=>{e(t)}))):e(t))}else t(i.data.errorMessage)})).catch(t)})):Promise.resolve(null)},this.updateAppInstanceProperties=(e,t)=>new Promise(((s,i)=>{this.httpClient.post(`api/apps/instance/properties?${a.Parameters.AppInstanceId}=${e}`,t).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.changeAppTemplate=(e,t)=>new Promise(((s,i)=>{this.httpClient.post(`/api/apps/changeapptemplate?${a.Parameters.AppTemplateId}=${t}`,e).then((e=>{e.data.success?s(e.data):i(e.data.errorMessage)})).catch(i)}))}buildContextParamsUrl(e){let t="";if(null!=e)for(const s in e)r.Utils.isNull(e[s])||(t+=`&${s}=${encodeURIComponent(e[s])}`);return t}ensureRemoveAppInstnaceIdAndProfileId(e){e&&(e.appinstanceid=void 0,e[a.Parameters.AppInstanceId]=void 0,e[a.Parameters.BusinessProfileId]=void 0,e.profileid=void 0)}loadAppManifest(e){if(e.appRouteWithProperties&&e.appRouteWithProperties.manifestId&&e.appRouteWithProperties.omniaServiceId){const t=e.appRouteWithProperties;return new Promise(((e,s)=>{const i=t.omniaServiceId.toString(),o=t.manifestId.toString();o&&o!=a.Guid.empty?r.ServiceManifestProvider.getOmniaServiceManifests(i).then((t=>{if(!t)throw`Cant load any manifests for service widh id: ${i} is the local webserver running?`;let r=t.groupedResouresAndComponents&&t.groupedResouresAndComponents.find((e=>e.resourceId===o));r||(r=t.webcomponent&&t.webcomponent.find((e=>e.resourceId===o))),r||(r=t.resource&&t.resource.find((e=>e.resourceId===o))),n.ManifestResourceLoader.ready().then((()=>{n.ManifestResourceLoader.loadResources(r).then((t=>{e(t)})).catch((e=>{throw s(e),console.dir("Load App Manifest failure reason"),console.dir(e),`loadAppManifest can't load manifest for serviceId: ${i} and manifestId ${o}`}))})).catch((e=>{console.dir("ManifestResourceLoader ready promise rejection"),console.dir(e)}))})):e(null)}))}throw"loadAppManifest can't load manifest"}};l.routes={},p([(0,r.Inject)(r.HttpClient,{configPromise:r.HttpClient.createOmniaServiceRequestConfig()})],l.prototype,"httpClient",2),p([(0,r.Inject)(i.OmniaContext)],l.prototype,"omniaContext",2),l=p([(0,r.Injectable)({lifetime:a.InstanceLifetimes.Transient,onBeforeInstanceCreated:()=>{d.ensureInitialized()}})],l);class d{static ensureInitialized(){if(!this.initialized&&(this.initialized=!0,window.omnia)){const e=window.omnia;let t,s;e.appRoute&&(t=e.appRoute),e.businessProfile&&(s=e.businessProfile),t&&(l.routes[t.path]={appRouteWithProperties:t,businessProfileWithProperties:s,activatedFeatures:e.activatedFeatures},t.appInstance?.id&&(l.routes[t.appInstance.id.toString().toLowerCase()]={appRouteWithProperties:t,businessProfileWithProperties:s,activatedFeatures:e.activatedFeatures}),this.initialAppRouteExists=!0)}}}d.initialized=!1,d.initialAppRouteExists=!1},"./client/fx/services/auditlogservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AuditLogService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.baseUrl="api/logs",this.getAuditLogSettings=()=>new Promise(((e,t)=>{this.httpClient.get(this.baseUrl+"/settings").then((s=>{200==s.status?s.data.success?e(s.data.data):t(s.data.errorMessage):t(s.statusText)})).catch(t)})),this.addOrUpdateAuditLogSettings=e=>new Promise(((t,s)=>{this.httpClient.post(this.baseUrl+"/settings",e).then((e=>{200==e.status?e.data.success?t():s(e.data.errorMessage):s(e.statusText)})).catch(s)})),this.getAuditLogs=e=>new Promise(((t,s)=>{this.httpClient.post(this.baseUrl+"/logs",e).then((e=>{200==e.status?e.data.success?t(e.data.data):s(e.data.errorMessage):s(e.statusText)})).catch(s)})),this.getAuditLogsNextPage=e=>{if(null!==e)return new Promise(((t,s)=>{this.httpClient.post(this.baseUrl+"/nextPage",e).then((e=>{200==e.status?e.data.success?t(e.data.data):s(e.data.errorMessage):s(e.statusText)})).catch(s)}));Promise.resolve({nextToken:null,result:[]})},this.getById=e=>new Promise(((t,s)=>{this.httpClient.get(this.baseUrl+"/byid?logId="+e).then((e=>{200==e.status?e.data.success?t(e.data.data):s(e.data.errorMessage):s(e.statusText)})).catch(s)})),this.getCategories=()=>new Promise(((e,t)=>{this.httpClient.get(this.baseUrl+"/categories").then((s=>{200==s.status?s.data.success?e(s.data.data):t(s.data.errorMessage):t(s.statusText)})).catch(t)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/azureadservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AzureAdService:()=>u});var i=s("./node_modules/axios/dist/axios.js"),r=s.n(i),a=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),n=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),o=s("./client/fx/services/featureservice.js"),c=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),p=s("./client/fx/stores/featurestore.js"),l=Object.defineProperty,d=Object.getOwnPropertyDescriptor,h=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?d(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&l(t,s,a),a};let u=class{constructor(){this.resolvers={},this.resolvers2={},this.resolveUsersByPrincipalNames=e=>{if(!e)return Promise.resolve([]);if(0==(e=e.filter((e=>e))).length)return Promise.resolve([]);const t=e.filter((e=>!this.resolvers2[e.toLowerCase()])).map((e=>e.toLowerCase()));if(t.length>0){const e={};t.forEach((t=>{this.resolvers2[t]||(this.resolvers2[t]=new Promise(((s,i)=>{e[t]=s})))})),this.httpClient.post("api/users/byprincipalnames",Object.keys(e)).then((t=>{if(t.data.success&&t.data.data){const s=t.data.data;s.forEach(this.populateUser);for(const t in e){const i=s.filter((e=>a.Utils.removeClaimPrefixFromLoginName(e.uid.toLowerCase())==a.Utils.removeClaimPrefixFromLoginName(t).toLowerCase()))[0];i?(e[t](i),this.resolvers[i.objectId.toString()]||(this.resolvers[i.objectId.toString()]=Promise.resolve({isGroup:!1,value:i}))):(e[t](null),this.resolvers2[t]=null)}}else for(const t in e)e[t](null),this.resolvers2[t]=null})).catch((()=>{for(const t in e)e[t](null),this.resolvers2[t]=null}))}const s=e.map((e=>this.resolvers2[e.toLowerCase()])).filter((e=>e));return new Promise(((e,t)=>{Promise.all(s).then((t=>{const s=(t=t.filter((e=>e))).map((e=>a.Utils.clone(e)));e(s)}))}))},this.resolveUsersByUIDs=e=>{const t=e.filter((e=>this.isIdGroupIdentityOrValidGuid(e))),s=e.filter((e=>!this.isIdGroupIdentityOrValidGuid(e))),i=[this.resolveUsersByIds(t),this.resolveUsersByPrincipalNames(s)];return Promise.all(i).then((e=>{const t=e[0];return e[1].forEach((e=>{t.users.filter((t=>t.uid==e.uid))[0]||t.users.push(e)})),t}))},this.resolveUsersByIds=e=>{if(!e)return Promise.resolve({groups:[],users:[]});if(0==(e=e.filter((e=>e))).length)return Promise.resolve({groups:[],users:[]});const t=e.filter((e=>!this.resolvers[e.toLowerCase()])).map((e=>e.toLowerCase()));if(t.length>0){const e={};t.forEach((t=>{this.resolvers[t]||(this.resolvers[t]=new Promise(((s,i)=>{e[t]=s})))})),this.httpClient.post("api/users/byids",Object.keys(e)).then((t=>{if(t.data.success&&t.data.data){const s=t.data.data,i=s.filter((e=>e.type===c.UserTypes.AzureAdExternalUser||e.type===c.UserTypes.AzureAdInternalUser)),r=s.filter((e=>e.type===c.GroupTypes.AzureAdGroup));i.forEach(this.populateUser),r.forEach(this.populateGroup);for(const t in e){const s=i.filter((e=>e.objectId==t))[0];let n=null;n=a.Utils.isOnline(this.omniaContext.environment.backendRuntime)?r.filter((e=>e.uid==t))[0]:r.filter((e=>a.Utils.removeClaimPrefixFromLoginName(e.uid)==a.Utils.removeClaimPrefixFromLoginName(t)))[0],s?(e[t]({isGroup:!1,value:s}),this.resolvers2[s.uid]||(this.resolvers2[s.uid]=Promise.resolve(s))):n?e[t]({isGroup:!0,value:n}):(e[t](null),this.resolvers[t]=null)}}else for(const t in e)e[t](null),this.resolvers[t]=null})).catch((()=>{for(const t in e)e[t](null),this.resolvers[t]=null}))}const s=e.map((e=>this.resolvers[e])).filter((e=>e));return new Promise(((e,t)=>{Promise.all(s).then((t=>{const s={groups:(t=t.filter((e=>e))).filter((e=>e.isGroup)).map((e=>a.Utils.clone(e.value))),users:t.filter((e=>!e.isGroup)).map((e=>a.Utils.clone(e.value)))};e(s)}))}))},this.searchUsers=(e,t,s)=>new Promise(((i,a)=>{this.httpClient.get(`api/users/search?key=${encodeURIComponent(e)}&type=${t}`,{cancelToken:new(r().CancelToken)((function(e){s&&s(e)}))}).then((e=>{if(e.data.success&&e.data.data){const t=e.data.data,s=t.filter((e=>e.type===c.UserTypes.AzureAdExternalUser||e.type===c.UserTypes.AzureAdInternalUser)),r=t.filter((e=>e.type===c.GroupTypes.AzureAdGroup));s.forEach(this.populateUser),r.forEach(this.populateGroup);i({groups:r,users:s})}else a(e.data.errorMessage)})).catch(a)})),this.getUsers=e=>new Promise(((t,s)=>{this.httpClient.get(`api/users/search?type=${e}`).then((e=>{if(e.data.success&&e.data.data){const s=e.data.data,i=s.filter((e=>e.type===c.UserTypes.AzureAdExternalUser||e.type===c.UserTypes.AzureAdInternalUser)),r=s.filter((e=>e.type===c.GroupTypes.AzureAdGroup));i.forEach(this.populateUser),r.forEach(this.populateGroup);t({groups:r,users:i})}else s(e.data.errorMessage)})).catch(s)})),this.getProfileUrl=e=>`https://delve.office.com/?u=${e}`,this.getAzureAdUserProperties=()=>new Promise(((e,t)=>{this.httpClient.get("api/azuread/properties").then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)})),this.populateCurrentUser=e=>{if(e&&e.objectId){this.populateUser(e);this.featureStore.getters.isAnyFeaturesActivated([c.Constants.featureIds.showTeamsPresence])&&this.graphClient.get("/v1.0/me/presence").then((t=>{200==t.status?(e.activity=t.data.activity,e.availability=t.data.availability):(e.activity=null,e.availability=null)})).catch()}return e},this.getCurrentUserBirthday=e=>new Promise(((t,s)=>{a.Utils.isOnline(this.omniaContext.environment.backendRuntime)?this.graphClient.get(`/v1.0/users/${e}?$select=birthday`).then((e=>{200===e.status&&t("0001-01-01T00:00:00Z"===e.data.birthday?null:e.data.birthday)})).catch((e=>{s()})):t(null)})),this.populateUser=e=>(e&&e.objectId&&(window.omnia?.enviroment&&window.omnia?.enviroment?.backendRuntime===c.OmniaBackendRuntimes.SharepointServer?(e.avatar=this.getUserAvatarSrc(e.uid.toString()),e.profileUrl=a.Utils.getProfileUrl(e.uid.toString())):(e.avatar=this.getUserAvatarSrc(e.objectId.toString()),e.profileUrl=a.Utils.getProfileUrl(e.objectId.toString()))),e),this.getUsersPresence=e=>new Promise(((t,s)=>{this.graphClient.post("/v1.0/communications/getPresencesByUserId",{ids:e}).then((e=>{200==e.status?t(e.data.value):s()})).catch((e=>{s()}))})),this.getUserAvatarSrc=(e="00000000-0000-0000-0000-000000000000")=>{if(!e)return"";return a.ServiceLocator.getUrl(c.OmniaService.Id)+`/api/users/profilephoto?id=${encodeURIComponent(e)}`},this.populateGroup=e=>{},this.checkUserInsideGroups=e=>new Promise(((t,s)=>{this.httpClient.post("api/users/checkuserinsidegroups",e).then((e=>{e.data.success?t(e.data.data):s()})).catch((e=>{s()}))})),this.isValidGuid=e=>{if(e){const t=e.match(/^[{]?[0-9a-fA-F]{8}[-]?([0-9a-fA-F]{4}[-]?){3}[0-9a-fA-F]{12}[}]?$/);return null!==t&&t.length>0}return!1}}isIdGroupIdentityOrValidGuid(e){if(this.isValidGuid(e))return!0;return a.Utils.getIdentityId(e)?.type==c.GroupTypes.AzureAdGroup}};h([(0,a.Inject)(a.HttpClient,{configPromise:a.HttpClient.createOmniaServiceRequestConfig()})],u.prototype,"httpClient",2),h([(0,a.Inject)(a.HttpClient,{configPromise:a.HttpClient.createMS365ServiceRequestConfig()})],u.prototype,"graphClient",2),h([(0,a.Inject)(n.OmniaContext)],u.prototype,"omniaContext",2),h([(0,a.Inject)(o.FeatureService)],u.prototype,"featureService",2),h([(0,a.Inject)(p.FeatureStore)],u.prototype,"featureStore",2),u=h([(0,a.Injectable)({lifetime:c.InstanceLifetimes.Singelton})],u)},"./client/fx/services/businessprofileservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{BusinessProfileService:()=>p});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?o(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&n(t,s,a),a};let p=class{constructor(){this.baseUrl="api/businessprofiles",this.createProfile=e=>new Promise(((t,s)=>{this.httpClient.post(this.baseUrl,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.updateProfile=(e,t)=>new Promise(((s,i)=>{this.httpClient.put(`${this.baseUrl}/update?profileId=${e}`,t).then((e=>{e.data.success?s(e.data.data):i(e.data.errorMessage)})).catch(i)})),this.findProfile=e=>new Promise(((t,s)=>{this.httpClient.get(`${this.baseUrl}/path?path=${e}`).then((e=>{if(e.data.success){const s=e.data.data;t(s.businessProfile)}else s(e.data.errorMessage)})).catch(s)})),this.getProfiles=()=>new Promise(((e,t)=>{this.httpClient.get(this.baseUrl).then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)}))})),this.getProfile=e=>new Promise(((t,s)=>{this.httpClient.get(`${this.baseUrl}/id?profileId=${e}`).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.getProfileWithProperties=e=>new Promise(((t,s)=>{this.httpClient.get(`${this.baseUrl}/properties?profileId=${e}`).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.deleteProfile=e=>new Promise(((t,s)=>{this.httpClient.delete(`${this.baseUrl}?profileId=${e}`).then((e=>{e.data.success?t():s(e.data.errorMessage)}))})),this.getPathsOfProfile=e=>new Promise(((t,s)=>{this.httpClient.get(`${this.baseUrl}/paths/remove?profileId=${e}`).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.getAllPaths=()=>new Promise(((e,t)=>{this.httpClient.get(`${this.baseUrl}/paths`).then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)})),this.getByPath=(e,t=r.CompareBusinessProfilePathType.StartsWith)=>new Promise(((s,i)=>{this.httpClient.get(`${this.baseUrl}/path?path=${encodeURIComponent(e)}&compareType=${t}`).then((e=>{e.data.success?s(e.data.data):i(e.data.errorMessage)})).catch(i)})),this.addPaths=(e,t)=>new Promise(((s,i)=>{this.httpClient.post(`${this.baseUrl}/${e}/paths/add`,t).then((e=>{e.data.success?s():i(e.data.errorMessage)})).catch(i)})),this.updatePath=(e,t,s)=>new Promise(((i,r)=>{this.httpClient.put(`${this.baseUrl}/path/update?profileId=${e}&oldPath=${t}&newPath=${s}`).then((e=>{e.data.success?i():r(e.data.errorMessage)})).catch(r)})),this.removePaths=e=>new Promise(((t,s)=>{this.httpClient.post(`${this.baseUrl}/paths/remove`,e).then((e=>{e.data.success?t():s(e.data.errorMessage)})).catch(s)})),this.removePathsOfProfile=e=>new Promise(((t,s)=>{this.httpClient.delete(`${this.baseUrl}/${e}/paths`).then((e=>{e.data.success?t():s(e.data.errorMessage)})).catch(s)})),this.getPropertiesInAllProfilePropertyBags=e=>new Promise(((t,s)=>{this.httpClient.post(`${this.baseUrl}/propertybag/properties`,new e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)}))}};c([(0,i.Inject)(a.OmniaContext)],p.prototype,"omniaContext",2),c([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],p.prototype,"httpClient",2),p=c([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Singelton})],p)},"./client/fx/services/enterpriseglossaryservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{EnterpriseGlossaryService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.baseUrl="api/enterpriseglossary",this.addEnterpriseGlossary=e=>new Promise(((t,s)=>{this.httpClient.post(this.baseUrl,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.updateEnterpriseGlossary=e=>new Promise(((t,s)=>{this.httpClient.put(this.baseUrl,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.removeEnterpriseGlossary=e=>new Promise(((t,s)=>{this.httpClient.delete(`${this.baseUrl}/${e.id}`).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.getAllEnterpriseGlossaries=()=>new Promise(((e,t)=>{this.httpClient.get(`${this.baseUrl}/all`).then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)})),this.getEnterpriseGlossary=e=>new Promise(((t,s)=>{this.httpClient.get(`${this.baseUrl}/byid/${e}`).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.addOrUpdateEnterpriseGlossaryMapping=e=>new Promise(((t,s)=>{this.httpClient.post(`${this.baseUrl}/mapping`,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.removeEnterpriseGlossaryMappings=e=>new Promise(((t,s)=>{this.httpClient.post(`${this.baseUrl}/mapping/remove`,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.getEnterpriseGlossaryMappings=e=>new Promise(((t,s)=>{this.httpClient.post(`${this.baseUrl}/mapping/ids`,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.queryEnterpriseGlossaryMappings=e=>new Promise(((t,s)=>{this.httpClient.post(`${this.baseUrl}/mapping/query`,JSON.stringify(e)).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/enterprisepropertycategoryservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{EnterprisePropertyCategoryService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.getEnterprisePropertyCategories=()=>new Promise(((e,t)=>{this.httpClient.get("api/enterprisepropertycategories").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.getEnterprisePropertyCategoryById=e=>new Promise(((t,s)=>{this.httpClient.get(`api/enterprisepropertycategories/${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.createEnterprisePropertyCategory=e=>new Promise(((t,s)=>{this.httpClient.post("api/enterprisepropertycategories",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateEnterprisePropertyCategory=e=>new Promise(((t,s)=>{this.httpClient.put("api/enterprisepropertycategories",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateEnterprisePropertyCategoryOrders=e=>new Promise(((t,s)=>{this.httpClient.post("api/enterprisepropertycategories/orders",e).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.removeEnterprisePropertyCategory=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/enterprisepropertycategories/${e}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/enterprisepropertysetservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{EnterprisePropertySetService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.getEnterprisePropertySets=()=>new Promise(((e,t)=>{this.httpClient.get("api/enterprisepropertysets").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.getEnterprisePropertySetById=e=>new Promise(((t,s)=>{this.httpClient.get(`api/enterprisepropertysets/${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.createEnterprisePropertySet=e=>new Promise(((t,s)=>{this.httpClient.post("api/enterprisepropertysets",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateEnterprisePropertySet=e=>new Promise(((t,s)=>{this.httpClient.put("api/enterprisepropertysets",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.removeEnterprisePropertySet=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/enterprisepropertysets/${e}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.terminateEnterprisePropertySet=e=>new Promise(((t,s)=>{this.httpClient.post(`api/enterprisepropertysets/terminate?id=${e}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.restoreEnterprisePropertySet=e=>new Promise(((t,s)=>{this.httpClient.post(`api/enterprisepropertysets/restore?id=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/extensionsservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ExtensionsService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.getDeployed=()=>new Promise(((e,t)=>{this.httpClient.get("api/extensions").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/featureservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{FeatureService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.getFeatureDefinitions=()=>new Promise(((e,t)=>{this.httpClient.get("api/features/definitions?includeHidden=false").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.getFeatureInstances=(e,t)=>new Promise(((s,r)=>{i.HttpClient.createOmniaServiceRequestConfig().then((i=>{const a=t;i.headers=Object.assign(i.headers||{},a||{}),this.httpClient.useConfig(i),this.httpClient.get(`api/features?targetResolverType=${e}`).then((e=>{const t=e.data;t.success?s(t.data):r(t.errorMessage)})).catch(r)}))})),this.getFeatureInstanceByFeatureId=e=>new Promise(((t,s)=>{this.httpClient.get(`api/features/${e}?featureId=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.activeFeature=(e,t)=>new Promise(((s,i)=>{this.httpClient.post(`api/features/${e}`,t).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.upgradeFeature=(e,t)=>new Promise(((s,i)=>{this.httpClient.put(`api/features/${e}`,t).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.removeFeature=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/features/${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/localizationservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{LocalizationService:()=>p});var i=s("./client/fx/stores/localizationstore.js"),r=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),a=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?o(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&n(t,s,a),a};let p=class{constructor(){}get(e){const t=i.LocalizationStore.instance.localizations.state,s=(e=e||"").indexOf(".")>-1?e.split("."):[e];let r=t;return s.forEach((e=>{r=r?r[e]:r})),"string"==typeof r?r:e}transform(e){return((e=e||"").match(/[$]Localize:(.*)[;$]/g)||[]).forEach((t=>{const s=t.replace("$Localize:","").replace(" ","").replace(";",""),i=this.get(s);i&&(e=e.replace(t,i))})),e}transformObj(e){if(!e)return e;let t=JSON.stringify(e);return t=this.transform(t),JSON.parse(t)}get allLanguages(){return p.allLanguages?Promise.resolve(r.Utils.clone(p.allLanguages)):(p.promiseGettingAllLanguages||(p.promiseGettingAllLanguages=new Promise(((e,t)=>{this.httpClient.get("api/localization/languges").then((s=>{if(s.data.success){const t=s.data.data;t&&t.forEach((e=>e.name=e.name.toLowerCase())),p.allLanguages=t,e(r.Utils.clone(t))}else p.promiseGettingAllLanguages=null,t(s.data.errorMessage)})).catch((()=>{p.promiseGettingAllLanguages=null,t()}))}))),p.promiseGettingAllLanguages)}};p.allLanguages=null,p.promiseGettingAllLanguages=null,c([(0,r.Inject)(r.HttpClient,{configPromise:r.HttpClient.createOmniaServiceRequestConfig()})],p.prototype,"httpClient",2),p=c([(0,r.Injectable)({lifetime:a.InstanceLifetimes.Transient})],p)},"./client/fx/services/mediapickerservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{MediaPickerService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.extensionHttpClients={},this.getMediaPickerImage=e=>new Promise(((t,s)=>{this.httpClient.get("api/omniamediapicker/dbimage",{params:{mediaPickerImageId:e}}).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getPersistedImageAsync=e=>new Promise(((t,s)=>{this.httpClient.get("api/omniamediapicker/dbimage/persisted",{params:{mediaPickerImageId:e}}).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getImageUrl=(e,t,s,r)=>{let a="";a+=t?`renditionid=${t}`:"",s&&(a+=a.length>0?"&":"",a+=`scalingid=${s}`);return`${r?i.ServiceLocator.generateToken(e.omniaServiceId):i.ServiceLocator.getUrl(e.omniaServiceId)}/api/mediapicker/image/${e.omniaImageId}`+(e.fileName?`/${encodeURIComponent(e.fileName)}`:"")+(a.length>0?"?"+a:"")},this.getOriginalImageUrl=(e,t)=>`${i.ServiceLocator.getUrl(e)}/api/mediapicker/image/original/${t}`,this.getMediaPickerBase64Image=(e,t,s)=>{const i=this.getImageUrl(e,t,s);return this.createImageBase64FromImageUrl(i,e)},this.getMediaPickerBase64OriginalImage=e=>{const t=this.getOriginalImageUrl(e.omniaServiceId,e.omniaImageId);return this.createImageBase64FromImageUrl(t,e)},this.getMediaPickerImageInformation=e=>{let t=null;return new Promise(((s,r)=>{if(e&&e.base64){let r=e.base64;if(e.fileName&&e.fileName.indexOf(".")>=0){const t=i.Utils.getFileType(e.fileName);r=this.ensureBase64String(r,t)}const a=new Image;a.src=r,a.onload=()=>{0!=a.naturalHeight||0!=a.naturalWidth?(t={height:a.naturalHeight,width:a.naturalWidth,sizeBytes:e.base64.length*(3/4)},s(t)):s(null)},a.onerror=()=>{s(null)}}}))},this.getAllImageScalings=()=>new Promise(((e,t)=>{this.httpClient.get("api/omniamediapicker/imagescalings").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.addImageScaling=e=>new Promise(((t,s)=>{this.httpClient.post("api/omniamediapicker/imagescaling",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateImageScaling=(e,t)=>new Promise(((s,i)=>{this.httpClient.put("api/omniamediapicker/imagescaling",{imageScalingToUpdate:e,newImageScalingDefinition:t}).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.deleteImageScaling=e=>new Promise(((t,s)=>{this.httpClient.post("api/omniamediapicker/imagescaling/delete",e).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.getAllImageRatios=()=>new Promise(((e,t)=>{this.httpClient.get("api/omniamediapicker/imageratios").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.addImageRatio=e=>new Promise(((t,s)=>{this.httpClient.post("api/omniamediapicker/imageratio",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateImageRatio=(e,t,s)=>new Promise(((i,r)=>{this.httpClient.put("api/omniamediapicker/imageratio",{ratioToUpdate:e,title:t,enableInRollup:s}).then((e=>{const t=e.data;t.success?i(t.data):r(t.errorMessage)})).catch(r)})),this.deleteImageRatio=e=>new Promise(((t,s)=>{this.httpClient.post("api/omniamediapicker/imageratio/delete",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.addNewImage=(e,t,s,r)=>{const a={originalImage:t,transformedImage:s,renditionData:r,imageAlternateText:t.altText,providerContext:e};let n=this.extensionHttpClients[e.omniaServiceId.toString()];return n||(n=this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(e.omniaServiceId)}),this.extensionHttpClients[e.omniaServiceId.toString()]=n),new Promise(((e,t)=>{n.post("api/mediapicker/image",a).then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)}))},this.updateImage=(e,t,s)=>{let r=this.extensionHttpClients[e.omniaServiceId.toString()];r||(r=this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(e.omniaServiceId)}),this.extensionHttpClients[e.omniaServiceId.toString()]=r);const a=i.Utils.clone({mediaPickerImageId:e.omniaImageId,transformedImage:t,renditionData:s,imageAlternateText:t.altText});return new Promise(((e,t)=>{r.put("api/mediapicker/image",a).then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)}))},this.copyImage=(e,t)=>{const s={mediaPickerImageId:e.omniaImageId,targetProviderContext:t},r=e.omniaServiceId;let a=this.extensionHttpClients[r.toString()];return a||(a=this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(r)}),this.extensionHttpClients[r.toString()]=a),new Promise(((e,t)=>{a.post(`api/mediapicker/image/${s.mediaPickerImageId}/copy`,s).then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)}))},this.ensureRenditions=(e,t)=>{let s=this.extensionHttpClients[e.toString()];return s||(s=this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(e)}),this.extensionHttpClients[e.toString()]=s),new Promise(((e,i)=>{s.post(`api/mediapicker/image/${t}/ensurerenditions`,null,{params:{mediaPickerImageId:t}}).then((t=>{const s=t.data;s.success?e():i(s.errorMessage)})).catch(i)}))}}createImageBase64FromImageUrl(e,t){return new Promise(((s,i)=>{let r=null;fetch(e,{headers:{"Access-Control-Allow-Origin":"*"},method:"GET",credentials:"include",cache:"default",referrerPolicy:"no-referrer-when-downgrade"}).then((e=>e.blob())).then((e=>{const i=new FileReader;i.readAsDataURL(e),i.onloadend=()=>{const e=this.removeBase64FormatTags(i.result);r={base64:e,fileName:t.fileName,altText:t.altText},s(r)}})).catch(i)}))}removeBase64FormatTags(e){if(!e)return e;const t=";base64,",s=e.indexOf(t);return s>0?e.substring(s+t.length):e}ensureBase64String(e,t){if(!e||!t)return e;t.indexOf(".")<0&&(t="."+t);let s=r.OmniaMimeType[t];return s||(s=r.OmniaMimeType.jpg),e.startsWith("data:image/")?e:`data:${s};base64,${e}`}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),o([(0,i.Inject)(i.ServiceContainerContext)],c.prototype,"serviceContainerContext",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/organizationtreeservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{OrganizationTreeService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.controllerUrl="/api/orgtree/",this.getOrgTreeByUserName=e=>(e=e.replace("#","%23").replace("#","%23"),new Promise(((t,s)=>{this.httpClient.get(this.controllerUrl+"gettreeforusername?userName="+e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)}))),this.getOrgTreeByUser=e=>new Promise(((t,s)=>{this.httpClient.post(this.controllerUrl+"gettreeforuser",e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/postservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{PostService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.extensionHttpClients={}}update(e){const t=this.getBaseUrl(e.postTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.put(t,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}create(e){const t=this.getBaseUrl(e.postTypeId),s=this.getHttpClientForServiceId(e.context.omniaServiceId);return new Promise(((i,r)=>{s.post(t,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}delete(e){const t=this.getBaseUrl(e.postTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.delete(`${t}?${this.getQueryString(e)}`).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}get(e){const t=this.getBaseUrl(e.postTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.get(`${t}?${this.getQueryString(e)}`).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}getContext(e,t,s){const i=this.getBaseUrl(t),r=this.getHttpClientForServiceId(e);return new Promise(((e,t)=>{r.get(`${i}/context?topicId=${s}`).then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)}))}toggleLike(e){const t=this.getBaseUrl(e.postTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.put(`${t}/like`,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}getHttpClientForServiceId(e){return this.extensionHttpClients[e]||(this.extensionHttpClients[e]=this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(e)})),this.extensionHttpClients[e]}getBaseUrl(e){return`api/post/${e}`}getQueryString(e){return`postId=${e.postId}&postTypeId=${e.postTypeId}&omniaServiceId=${e.omniaServiceId}`}};o([(0,i.Inject)(i.ServiceContainerContext)],c.prototype,"serviceContainerContext",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/profilecardservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ProfileCardService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.controllerUrl="/api/profilecard/",this.getUser=e=>(e=e.replace("#","%23").replace("#","%23"),new Promise(((t,s)=>{this.httpClient.get(this.controllerUrl+"getuser?userName="+e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)}))),this.getUserInformation=e=>(e=e.replace("#","%23").replace("#","%23"),new Promise(((t,s)=>{this.httpClient.get(this.controllerUrl+"getuserprofileproperties?userName="+e).then((s=>{s.data.success?t(s.data.data):(t({aboutMe:null,birthday:null,cellPhone:null,department:null,interests:null,jobTitle:null,office:null,pastProjects:null,schools:null,skills:[],userName:null,sipAddress:null,workPhone:null,loginName:e,workEmail:e}),console.error(`Profile Card Error: -> ${s.data.errorMessage}`))})).catch(s)})))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/queryablepropertiesservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{QueryablePropertiesService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.baseUrl="api/queryableproperties",this.getQueryableProperties=(e="",t)=>{let s=this.httpClient;return t&&!i.Utils.isEmptyGuid(t.toString())&&(s=this.createHttpClientFromServiceId(t)),new Promise(((t,i)=>{s.get(`${this.baseUrl}/computed?tableName=${e}`).then((e=>{e.data.success?t(e.data.data):i()})).catch(i)}))},this.removeQueryableProperties=(e,t)=>{let s=this.httpClient;return t&&!i.Utils.isEmptyGuid(t.toString())&&(s=this.createHttpClientFromServiceId(t)),new Promise(((t,i)=>{s.post(this.baseUrl+"/remove",e).then((e=>{200==e.status?e.data.success?t():i(e.data.errorMessage):i(e.statusText)})).catch(i)}))},this.addQueryableProperties=(e,t)=>{let s=this.httpClient;return t&&!i.Utils.isEmptyGuid(t.toString())&&(s=this.createHttpClientFromServiceId(t)),new Promise(((t,i)=>{s.post(this.baseUrl+"/add",e).then((e=>{200==e.status?e.data.success?t():i(e.data.errorMessage):i(e.statusText)})).catch(i)}))},this.createHttpClientFromServiceId=e=>this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(e)})}};o([(0,i.Inject)(i.ServiceContainerContext)],c.prototype,"serviceContainerContext",2),o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/securityservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{SecurityService:()=>p});var i=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),r=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),a=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?o(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&n(t,s,a),a};let p=class{constructor(){this.getAllPermissionBindings=()=>new Promise(((e,t)=>{this.httpClient.get("api/security/allpermissionbindings").then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)})),this.getAllOmniaRoles=()=>new Promise(((e,t)=>{this.httpClient.get("api/security/roles").then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)})),this.getPermissionBindings=(e,t)=>new Promise(((s,i)=>{this.httpClient.post("api/security/roles/getpermissionbindings",e,{params:t}).then((e=>{e.data.success?s(e.data.data):i(e.data.errorMessage)})).catch(i)})),this.addOrUpdatePermissionBindings=(e,t)=>{let s=this.httpClient;return t&&!r.Utils.isEmptyGuid(t.toString())&&(s=this.createHttpClientFromServiceId(t)),new Promise(((t,i)=>{s.post("api/security/update/settings",e,{params:e.permissionContextParam}).then((e=>{e.data.success?t():i(e.data.errorMessage)})).catch(i)}))},this.getTenantRequiredAzureAdPermissions=()=>new Promise(((e,t)=>{this.httpClient.get("api/security/azuread/permissions").then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)})),this.getConsentUrl=e=>new Promise(((t,s)=>{this.httpClient.get("api/auth/adminconsent/get?redirectUrl="+encodeURIComponent(e+"")).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.createHttpClientFromServiceId=e=>this.serviceContainerContext.createInstance(r.HttpClient,{configPromise:r.HttpClient.createOmniaServiceRequestConfig(e)})}};c([(0,r.Inject)(r.ServiceContainerContext)],p.prototype,"serviceContainerContext",2),c([(0,r.Inject)(i.OmniaContext)],p.prototype,"omniaContext",2),c([(0,r.Inject)(r.HttpClient,{configPromise:r.HttpClient.createOmniaServiceRequestConfig()})],p.prototype,"httpClient",2),p=c([(0,r.Injectable)({lifetime:a.InstanceLifetimes.Singelton})],p)},"./client/fx/services/siteservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{SiteService:()=>p});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),a=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?o(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&n(t,s,a),a};let p=class{constructor(){this.getSiteLogo=e=>this.httpClient.post("api/sites/logo",e).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage)))}};c([(0,i.Inject)(r.OmniaContext)],p.prototype,"omniaContext",2),c([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],p.prototype,"httpClient",2),p=c([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],p)},"./client/fx/services/targetingpropertyservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{TargetingPropertyService:()=>c});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,s,i)=>{for(var r,o=i>1?void 0:i?n(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(o=(i?r(t,s,o):r(o))||o);return i&&o&&a(t,s,o),o};let c=class{constructor(){this.getTargetingProperties=()=>new Promise(((e,t)=>{this.httpClient.get("api/targetingproperties").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.getTargetingPropertyById=e=>new Promise(((t,s)=>{this.httpClient.get(`api/targetingproperties/${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.createTargetingProperty=e=>new Promise(((t,s)=>{this.httpClient.post("api/targetingproperties",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateTargetingProperty=e=>new Promise(((t,s)=>{this.httpClient.put("api/targetingproperties",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.removeTargetingProperty=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/targetingproperties/${e}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.getTargetingPropertyResult=()=>new Promise(((e,t)=>{this.httpClient.post("api/targetingproperties/result").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.terminateTargetingProperty=e=>new Promise(((t,s)=>{this.httpClient.post(`api/targetingproperties/terminate?id=${e}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.restoreTargetingProperty=e=>new Promise(((t,s)=>{this.httpClient.post(`api/targetingproperties/restore?id=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};o([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],c.prototype,"httpClient",2),c=o([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Transient})],c)},"./client/fx/services/userservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{UserService:()=>l});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=s("./client/fx/services/azureadservice.js"),n=s("./client/fx/services/localizationservice.js"),o=Object.defineProperty,c=Object.getOwnPropertyDescriptor,p=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?c(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&o(t,s,a),a};let l=class{constructor(){this.resolveCurrentUser=null,this.resolveCurrentUserPropertiesInfo=null,this.resolve=(...e)=>new Promise(((t,s)=>{this.httpClient.post("api/users/resolve",e).then((e=>{if(e.data.success&&e.data.data){for(const t of e.data.data)t.type!==r.UserTypes.AzureAdExternalUser&&t.type!==r.UserTypes.AzureAdInternalUser||this.azureAdService.populateUser(t);t(e.data.data)}else s(e.data.errorMessage)})).catch(s)})),this.resolveUsersPresence=(...e)=>new Promise(((t,s)=>{this.httpClient.post("api/users/resolve",e).then((e=>{if(e.data.success&&e.data.data){for(const t of e.data.data)t.type!==r.UserTypes.AzureAdExternalUser&&t.type!==r.UserTypes.AzureAdInternalUser||this.azureAdService.populateUser(t);t(e.data.data)}else s(e.data.errorMessage)})).catch(s)})),this.getCurrentUser=()=>new Promise(((e,t)=>{null==this.resolveCurrentUser&&(this.resolveCurrentUser=new Promise(((e,t)=>{this.httpClient.get("api/users/me").then((s=>{if(s.data.success&&s.data.data){const t=s.data.data;t.type!==r.UserTypes.AzureAdExternalUser&&t.type!==r.UserTypes.AzureAdInternalUser||this.azureAdService.populateUser(t),e(t)}else t(s.data.errorMessage)})).catch((()=>{t()}))}))),this.resolveCurrentUser.then((t=>e(i.Utils.clone(t)))).catch((()=>{this.resolveCurrentUser=null,t()}))})),this.getCurrentUserPropertiesInfo=e=>new Promise(((t,s)=>{null==this.resolveCurrentUserPropertiesInfo&&(this.resolveCurrentUserPropertiesInfo=new Promise(((t,s)=>{this.httpClient.post("api/users/mepropertiesinfo",e).then((e=>{if(e.data.success&&e.data.data){const s=e.data.data;t(s)}else s(e.data.errorMessage)})).catch((()=>{s()}))}))),this.resolveCurrentUserPropertiesInfo.then((e=>t(i.Utils.clone(e)))).catch((()=>{this.resolveCurrentUserPropertiesInfo=null,s()}))})),this.getUserAvatarSrc=(e="00000000-0000-0000-0000-000000000000")=>this.azureAdService.getUserAvatarSrc(e)}getUserPresenceIconName(e,t){switch(e){case"Available":case"AvailableIdle":return"fas fa-check";case"Away":case"BeRightBack":return"fas fa-clock";case"DoNotDisturb":return"fas fa-minus";case"Offline":return"OffWork"==t?"fas fa-arrow-circle-left":"fas fa-times";default:return""}}getUserPresenceIconColor(e,t){switch(e){case"Available":case"AvailableIdle":return"#92c353";case"Away":case"BeRightBack":return"#fdb913";case"Busy":case"BusyIdle":case"DoNotDisturb":return"#c4314b";case"PresenceUnknown":case"Offline":return"OffWork"==t?"#c84cb9":"#808285";default:return"#ffffff"}}getUserPresenceStatusName(e){return this.localizationService.get("Omnia.Ux.TeamsPresence.Activities."+e)}};p([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],l.prototype,"httpClient",2),p([(0,i.Inject)(a.AzureAdService)],l.prototype,"azureAdService",2),p([(0,i.Inject)(n.LocalizationService)],l.prototype,"localizationService",2),l=p([(0,i.Injectable)({lifetime:r.InstanceLifetimes.Singelton})],l)},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AppLayoutService:()=>x.AppLayoutService,AppNamingPolicyService:()=>He,AppRouteService:()=>P,AppService:()=>$.AppService,AuditLogService:()=>ye.AuditLogService,AzureAdService:()=>F.AzureAdService,BusinessProfileService:()=>_.BusinessProfileService,EnterpriseGlossaryService:()=>Le.EnterpriseGlossaryService,EnterprisePropertyCategoryService:()=>Ie.EnterprisePropertyCategoryService,EnterprisePropertySetService:()=>X.EnterprisePropertySetService,ExtensionsService:()=>ce.ExtensionsService,FileStorageService:()=>ze,ImageProxyService:()=>De,LocalizationService:()=>L.LocalizationService,ManifestService:()=>he,MediaPickerService:()=>we.MediaPickerService,MicrosoftStreamService:()=>R,OrganizationTreeService:()=>xe.OrganizationTreeService,PermissionNode:()=>j,PermissionService:()=>n.PermissionService,PostService:()=>We.PostService,ProfileCardService:()=>Te.ProfileCardService,QueryablePropertiesService:()=>Ce.QueryablePropertiesService,QueueService:()=>Y,RealtimeService:()=>Ee.RealtimeService,SecretsService:()=>oe,SecurityRoles:()=>O,SecurityService:()=>T.SecurityService,SettingsService:()=>g,SiteService:()=>G.SiteService,TagsService:()=>fe,TargetingPropertyService:()=>N.TargetingPropertyService,TenantContactService:()=>Se,TimezoneService:()=>V,TranslationService:()=>ie,UserService:()=>H.UserService,VersionedDataService:()=>Ae,WebImageService:()=>k});var i=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),r=s("./client/fx/core/services/internalconfigurationservice.js"),a=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=s("./client/fx/services/permissions/permissionservice.js"),o=Object.defineProperty,c=Object.getOwnPropertyDescriptor,p=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?c(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&o(t,s,a),a};const l=class{constructor(e){this.httpClient=e,this.loadValue=e=>new Promise(((t,s)=>{l.SettingsKeyValueHashLoadPromise.then((i=>{const r=l.createKeyHash(e);l.SettingsKeyHashToKeyInformationMap.hasOwnProperty(r)?this.httpClient.get("api/settings/get",{params:{key:e,v:l.SettingsKeyHashToKeyInformationMap[r].contentHash}}).then((e=>{204==e.status?t(null):t(e.data)})).catch(s):t(null)})).catch(s)})),this.getCurrentSecurityRoleId=e=>new Promise(((t,s)=>{l.SettingsKeyValueHashLoadPromise.then((s=>{l.SettingsKeyHashToKeyInformationMap.hasOwnProperty(l.createKeyHash(e))?t(l.SettingsKeyHashToKeyInformationMap[l.createKeyHash(e)].securityRoleId):t(null)})).catch(s)})),this.reloadSettingsHash=()=>{l.SettingsKeyValueHashLoadPromise=new Promise(((e,t)=>{const s=r.InternalConfigurationService.getConfiguration();s&&s.enableSettingsService?this.httpClient.get("api/settings/hash").then((t=>{l.SettingsKeyHashToKeyInformationMap=t.data,e(!0)})).catch(t):e(!1)}))},null===l.SettingsKeyValueHashLoadPromise&&this.reloadSettingsHash()}};let d=l;d.SettingsKeyHashToKeyInformationMap={},d.SettingsKeyValueHashLoadPromise=null,d.ProviderIdUserAccessMapLoadPromise=null,d.md5Util=new i.MD5Util,d.createKeyHash=e=>(e&&(e=e.toLowerCase()),l.md5Util.md5(e));const h=r.InternalConfigurationService.getConfiguration();h&&h.enableSettingsService&&new d(i.ServiceContainer.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()}));class u{constructor(e){this.promise=e,this.data=null,this.dataHasBeenSet=!1}get value(){let e=this.data;return this.data&&(e=i.Utils.clone(this.data)),e}set value(e){this.data=e,this.dataHasBeenSet=!0}}let g=class{constructor(e){this.securityRoleId=e,this.settingsLoader=null,this.onKeyValueUpdated=e=>{const t=this.getKeyValuePublishSubscriber(e);return new i.MessageBusExposeOnlySubscription(t)},this.onSettingUpdated=()=>new i.MessageBusExposeOnlySubscription(g.SettingUpdatedPublishSubscriber),this.registerKeyProvider=(e,t)=>{if(!e)throw new Error("You can't use settings key empty/null or undefined.");if(null==t)throw new Error("You can't register key settings provider null for key: "+e);t.protectKeyWithSecurityRole(this.securityRoleId),g.KeyProviders[d.createKeyHash(e)]=t},this.suggestKeyRenderer=(e,t)=>{const s=this.getKeyProvider(e);s&&s.getSuggestedKeyRenderer&&s.suggestKeyRenderer?s.suggestKeyRenderer(e,t):g.SuggestedKeyRenderers[e]?g.SuggestedKeyRenderers[e].waitingResolver&&g.SuggestedKeyRenderers[e].waitingResolver(t):g.SuggestedKeyRenderers[e]={keyRendererPromise:new Promise((e=>{e(t)}))}},this.getSuggestedKeyRenderer=e=>{let t=null;const s=this.getKeyProvider(e);if(s&&s.getSuggestedKeyRenderer&&s.suggestKeyRenderer)t=s.getSuggestedKeyRenderer(e);else{if(!g.SuggestedKeyRenderers[e]){let t=null;const s=new Promise((e=>{t=e}));g.SuggestedKeyRenderers[e]={keyRendererPromise:s,waitingResolver:t}}t=g.SuggestedKeyRenderers[e].keyRendererPromise}return t},this.getKeyProvider=e=>{let t=null;return Object.keys(g.KeyProviders).length>0&&(t=g.KeyProviders[d.createKeyHash(e)]),t};g.SettingUpdatedPublishSubscriber=new i.MessageBusTopicMediator({namespace:"omnia.fx.services.settings",name:"settingupdated"}),this.settingsLoader=new d(this.httpClient)}canSetValue(e){return new Promise(((t,s)=>{this.permissionService.hasPermissionForRole(this.securityRoleId).then((s=>{const i=this.getKeyProvider(e);s&&null!=i?i.canSetValue(e).then((e=>{t(e)})):s?this.settingsLoader.getCurrentSecurityRoleId(e).then((e=>{null!=e?this.permissionService.hasPermissionForRole(e).then((e=>{t(e)})):t(s)})):t(s)})).catch(s)}))}setValue(e,t){if(!e)throw new Error("You can't use settings key empty/null or undefined.");let s=null;const i=this.getKeyProvider(e);return null==i?(s=new Promise(((s,i)=>{this.httpClient.post("api/settings/update",{key:e,value:t,securityRoleId:this.securityRoleId}).then((t=>{if(t.data.success){const i=g.LoadedValues[e];i.value=t.data.data,s(i.value),this.settingUpdated(e,i.value)}else i(t.data.errorMessage)})).catch(i)})),g.LoadedValues[e]=new u(s)):(i.protectKeyWithSecurityRole(this.securityRoleId),s=new Promise(((s,r)=>{i.setValue(e,t).then((t=>{this.settingUpdated(e,t),s(t)})).catch(r)}))),s}getValue(e){if(!e)throw new Error("You can't use settings key empty/null or undefined.");let t=null;const s=this.getKeyProvider(e);return null==s?g.LoadedValues[e]?t=g.LoadedValues[e].dataHasBeenSet?new Promise(((t,s)=>{t(g.LoadedValues[e].value)})):g.LoadedValues[e].promise:(t=new Promise(((t,s)=>{this.settingsLoader.loadValue(e).then((s=>{const i=g.LoadedValues[e];i.value=s,t(i.value)})).catch(s)})),g.LoadedValues[e]=new u(t)):t=s.getValue(e),t}settingUpdated(e,t){try{this.getKeyValuePublishSubscriber(e).publish(t)}catch(t){i.Console.logError("KeyValueUpdated subscriber had an error handling key: "+e+" error: "+t)}const s={value:t,key:e};try{g.SettingUpdatedPublishSubscriber.publish(s)}catch(t){i.Console.logError("SettingUpdated subscriber had an error handling key: "+e+" error: "+t)}}getKeyValuePublishSubscriber(e){const t={namespace:"omnia.fx.services.settings",name:e};return new i.MessageBusTopicMediator(t)}reloadSettingsHash(){this.settingsLoader.reloadSettingsHash(),g.LoadedValues={}}};g.SuggestedKeyRenderers={},g.KeyProviders={},g.KeyValueUpdatedPublishSubscribers={},g.LoadedValues={},g.SettingUpdatedPublishSubscriber=null,p([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],g.prototype,"httpClient",2),p([(0,i.Inject)(n.PermissionService)],g.prototype,"permissionService",2),g=p([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],g);var m=Object.defineProperty,f=Object.getOwnPropertyDescriptor,y=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?f(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&m(t,s,a),a};let P=class{constructor(){this.baseUrl="api/approutes",this.getByPath=e=>new Promise(((t,s)=>{this.httpClient.get(`${this.baseUrl}?path=${encodeURIComponent(e)}`).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)})),this.getByAlias=(e,t="_")=>{const s=`/${t}/${e}`;return this.getByPath(s)},this.getRootRoute=()=>this.getByPath("/"),this.updateAppRoutePath=(e,t)=>new Promise(((s,i)=>{const r={[a.Parameters.AppInstanceId]:e.id,newPath:t};this.httpClient.post(`${this.baseUrl}/path`,null,{params:r}).then((e=>{e.data.success?s(e.data):i(e.data.errorMessage)})).catch(i)})),this.validateRoute=e=>new Promise(((t,s)=>{this.httpClient.post(`${this.baseUrl}/validation`,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)}))}};y([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],P.prototype,"httpClient",2),P=y([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],P);var v,b,S,I,C,w,x=s("./client/fx/services/applayoutservice.js"),T=s("./client/fx/services/securityservice.js"),L=s("./client/fx/services/localizationservice.js");class O{}O.Api=((v=class{}).FullControl="08cd2390-9f96-414b-99d9-8b55e938fcd8",v),O.Tenant=((b=class{}).Admin="67daa6ca-168e-458f-96c8-4162b77fc99f",b),O.SiteCollection=((S=class{}).Admin="3b7dc0fa-6343-4e69-9292-abf31b9156dd",S),O.Site=((I=class{}).Admin="83825019-4767-4b39-9813-0af8692e31a9",I),O.BusinessProfile=((C=class{}).Admin="64562087-f391-4244-a70b-81fcdbc2cc64",C),O.AppInstance=((w=class{}).Admin="f17d076c-d46b-43fd-94e2-e664dd43ed92",w.Contributor="e5ba2879-76a1-4d0a-ab71-6c7ca6cd4791",w.Reader="a0aa2eb1-859d-40d5-a377-586544ed45be",w);class j{}var _=s("./client/fx/services/businessprofileservice.js"),A=Object.defineProperty,M=Object.getOwnPropertyDescriptor,U=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?M(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&A(t,s,a),a};let R=class{constructor(){this.streamApiUrl="https://web.microsoftstream.com/oembed",this.getStreamVideo=e=>new Promise(((t,s)=>{this.httpClient.post("api/video/getmicrosoftstreaminfo",e).then((e=>{const s=e.data;s.success?t(s.data):t(null),t(null)})).catch(s)}))}};U([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],R.prototype,"httpClient",2),R=U([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],R);var D=Object.defineProperty,E=Object.getOwnPropertyDescriptor,B=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?E(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&D(t,s,a),a};let k=class{constructor(){this.getPredefinedSearch=()=>new Promise(((e,t)=>{k.predefinedSearchs?e(JSON.parse(JSON.stringify(k.predefinedSearchs))):this.httpClient.get("api/webimage/predefinedsearchs").then((s=>{const i=s.data;i.success?(i.data||(i.data=[]),this.generateOverlay(i.data),k.predefinedSearchs=i.data,e(JSON.parse(JSON.stringify(k.predefinedSearchs)))):t()}))})),this.download=e=>new Promise(((t,s)=>{const i={url:e};this.httpClient.get("api/webimage/download",{params:i}).then((e=>{const i=e.data;i.success?t(i.data):s()})).catch(s)})),this.getResizedImageBase64FromUrl=(e,t,s,i)=>new Promise(((r,a)=>{this.httpClient.get("api/webimage/resizeimage/base64result",{params:{imageUrl:e,maxDimension:t,formatTypeSettings:s,compressQuality:i}}).then((e=>{const t=e.data;t.success?r(t.data):a()})).catch(a)})),this.getResizedImageBase64FromFile=(e,t,s,i)=>new Promise(((r,a)=>{const n=new FormData;n.set("imageFile",e),this.httpClient.post("api/webimage/resizeimage/base64result",n,{params:{maxDimension:t,formatTypeSettings:s,compressQuality:i}}).then((e=>{const t=e.data;t.success?r(t.data):a()})).catch(a)})),this.getResizedImageBase64FromString=(e,t,s,i)=>new Promise(((r,a)=>{this.httpClient.post("api/webimage/resizeimage/base64resultfromstring",JSON.stringify(e),{params:{maxDimension:t,formatTypeSettings:s,compressQuality:i}}).then((e=>{const t=e.data;t.success?r(t.data):a()})).catch(a)})),this.generateOverlay=e=>{e.forEach((e=>{e.overlay=`rgba(0,0,0,${e.overlayOpacity})`}))}}};B([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],k.prototype,"httpClient",2),k=B([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],k);var $=s("./client/fx/services/appservice.js"),H=s("./client/fx/services/userservice.js"),F=s("./client/fx/services/azureadservice.js"),G=s("./client/fx/services/siteservice.js"),N=s("./client/fx/services/targetingpropertyservice.js"),z=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),W=Object.defineProperty,K=Object.getOwnPropertyDescriptor,q=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?K(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&W(t,s,a),a};let V=class{constructor(){this.getTimeZones=()=>this.httpClient.get("api/timezones").then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage)))}};q([(0,i.Inject)(z.OmniaContext)],V.prototype,"omniaContext",2),q([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],V.prototype,"httpClient",2),V=q([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],V);var J=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,Z=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Q(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&J(t,s,a),a};let Y=class{constructor(){this.getQueueMessageProgress=e=>new Promise(((t,s)=>{this.httpClient.get(`api/queues/messages/${e}/progress`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};Z([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],Y.prototype,"httpClient",2),Y=Z([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],Y);var X=s("./client/fx/services/enterprisepropertysetservice.js"),ee=Object.defineProperty,te=Object.getOwnPropertyDescriptor,se=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?te(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&ee(t,s,a),a};let ie=class{constructor(){this.translate=e=>new Promise(((t,s)=>{this.httpClient.post("api/translation/translate",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};se([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],ie.prototype,"httpClient",2),ie=se([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Singelton})],ie);var re=Object.defineProperty,ae=Object.getOwnPropertyDescriptor,ne=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ae(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&re(t,s,a),a};let oe=class{constructor(){this.getSecret=(e,t,s=null)=>new Promise(((i,r)=>{let a=`api/secrets/mask?key=${encodeURIComponent(e)}&serviceId=${encodeURIComponent(t.toString())}`;null!=s&&(a+=`&profileId=${encodeURIComponent(s.toString())}`),this.httpClient.get(a).then((e=>{const t=e.data;t.success?i(t.data):r(t.errorMessage)})).catch(r)})),this.setTenantSecret=e=>new Promise(((t,s)=>{this.httpClient.post("api/secrets",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.setBusinessProfileSecret=(e,t)=>new Promise(((s,i)=>{this.httpClient.post(`api/secrets/businessprofile?profileId=${t}`,e).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)}))}};ne([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],oe.prototype,"httpClient",2),oe=ne([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],oe);var ce=s("./client/fx/services/extensionsservice.js"),pe=s("10407664-c0c5-438b-94b2-507d58d190af"),le=Object.defineProperty,de=Object.getOwnPropertyDescriptor;let he=class{loadResourceManifestById(e){pe.InternalTopics.loadResourcesManifestWithId.publish(e)}loadResourceManifestByElementName(e){pe.InternalTopics.loadResourcesForElementName.publish(e)}};he=((e,t,s,i)=>{for(var r,a=i>1?void 0:i?de(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&le(t,s,a),a})([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Singelton})],he);var ue=Object.defineProperty,ge=Object.getOwnPropertyDescriptor,me=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ge(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&ue(t,s,a),a};let fe=class{async findTags(e){return""===(e=e.replace(/#/g,""))?Promise.resolve([]):new Promise(((t,s)=>{this.httpClient.get(`api/tags/find?name=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}async ensureTags(e){if(!e)throw"Tags is null";return new Promise(((t,s)=>{this.httpClient.post("api/tags/ensure",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};me([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],fe.prototype,"httpClient",2),fe=me([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],fe);var ye=s("./client/fx/services/auditlogservice.js"),Pe=Object.defineProperty,ve=Object.getOwnPropertyDescriptor,be=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ve(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Pe(t,s,a),a};let Se=class{constructor(){this.getTenantContact=()=>new Promise(((e,t)=>{this.httpClient.get("api/tenantcontact").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)})),this.updateTenantContact=e=>new Promise(((t,s)=>{this.httpClient.post("api/tenantcontact",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)}))}};be([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],Se.prototype,"httpClient",2),Se=be([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],Se);var Ie=s("./client/fx/services/enterprisepropertycategoryservice.js"),Ce=s("./client/fx/services/queryablepropertiesservice.js"),we=s("./client/fx/services/mediapickerservice.js"),xe=s("./client/fx/services/organizationtreeservice.js"),Te=s("./client/fx/services/profilecardservice.js"),Le=s("./client/fx/services/enterpriseglossaryservice.js"),Oe=Object.defineProperty,je=Object.getOwnPropertyDescriptor,_e=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?je(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Oe(t,s,a),a};let Ae=class{constructor(){this.extensionHttpClients={}}create(e){const t=this.getBaseUrl(e.dataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.post(`${t}/create`,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}checkIn(e){const t=this.getBaseUrl(e.dataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.post(`${t}/checkin`,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}publish(e){const t=this.getBaseUrl(e.dataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.post(`${t}/publish`,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}checkOut(e,t=!1){const s=this.getBaseUrl(e.dataTypeId),i=this.getHttpClientForServiceId(e.omniaServiceId),r={dataIdentifier:e,takeOver:t};return new Promise(((e,t)=>{i.post(`${s}/checkout`,r).then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)}))}getByVersionRef(e){const t=this.getBaseUrl(e.dataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.get(`${t}/getbyref?versionId=${e.versionId}&omniaserviceid=${e.omniaServiceId}`).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}getVersionInfo(e){const t=this.getBaseUrl(e.dataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.post(`${t}/getversioninfo`,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}getLatest(e){const t=this.getBaseUrl(e.dataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.post(`${t}/getlatest`,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}getLatestRef(e){const t=this.getBaseUrl(e.dataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.post(`${t}/getlatestversionref`,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}getHttpClientForServiceId(e){return this.extensionHttpClients[e]||(this.extensionHttpClients[e]=this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(e)})),this.extensionHttpClients[e]}getBaseUrl(e){return`api/omniaversioneddata/${e}`}};_e([(0,i.Inject)(i.ServiceContainerContext)],Ae.prototype,"serviceContainerContext",2),Ae=_e([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],Ae);var Me=Object.defineProperty,Ue=Object.getOwnPropertyDescriptor;const Re=class{static getUrlByImageApi(e,t,s){return`${i.ServiceLocator.getUrl(a.OmniaService.Id,!0).toLowerCase()}/api/webimage/imageproxy?webUrl=${encodeURIComponent(e)}&imageApiUrl=${encodeURIComponent(t)}&cache=${s?"true":"false"}`}static getUrlByImagePath(e,t,s){return`${i.ServiceLocator.getUrl(a.OmniaService.Id,!0).toLowerCase()}/api/webimage/imageproxy?webUrl=${encodeURIComponent(e)}&imageApiUrl=${encodeURIComponent(Re.buildGetPreviewUrl(e,t))}&cache=${s?"true":"false"}`}static tryToGetUrl(e,t,s){let r=t;return i.Utils.isOnPrem(this.omniaCtx.environment.backendRuntime)||Re.imageApiTypes.find((e=>t.indexOf(e)>=0))||(r=Re.buildGetPreviewUrl(e,t)),`${i.ServiceLocator.getUrl(a.OmniaService.Id,!0).toLowerCase()}/api/webimage/imageproxy?webUrl=${encodeURIComponent(e)}&imageApiUrl=${encodeURIComponent(r)}&cache=${s?"true":"false"}`}static buildGetPreviewUrl(e,t){return`${e}/_layouts/15/getpreview.ashx?path=${t}`}};let De=Re;De.imageApiTypes=["/api/","/_api/","getpreview.ashx"],((e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ue(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);i&&a&&Me(t,s,a)})([(0,i.Inject)(z.OmniaContext)],De,"omniaCtx",2);var Ee=s("./client/fx/shared/services/index.js"),Be=Object.defineProperty,ke=Object.getOwnPropertyDescriptor,$e=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ke(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Be(t,s,a),a};let He=class{constructor(){this.get=(e,t)=>new Promise(((s,i)=>{this.httpClient.get("api/apps/namingpolicies",{params:{[a.Parameters.BusinessProfileId]:e.toString(),[a.Parameters.AppDefinitionId]:t.toString()}}).then((e=>{const t=e.data;t.success?s(t.data):i(t.errorMessage)})).catch(i)})),this.add=(e,t,s)=>new Promise(((i,r)=>{this.httpClient.post("api/apps/namingpolicies",s,{params:{[a.Parameters.BusinessProfileId]:e.toString(),[a.Parameters.AppDefinitionId]:t.toString()}}).then((e=>{const t=e.data;t.success?i(t.data):r(t.errorMessage)})).catch(r)})),this.update=e=>new Promise(((t,s)=>{this.httpClient.put("api/apps/namingpolicies",e,{params:{[a.Parameters.BusinessProfileId]:e.businessProfileId}}).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.delete=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/apps/namingpolicies/${e.id}`,{params:{[a.Parameters.BusinessProfileId]:e.businessProfileId}}).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)}))}};$e([(0,i.Inject)(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig()})],He.prototype,"httpClient",2),He=$e([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Scoped})],He);var Fe=Object.defineProperty,Ge=Object.getOwnPropertyDescriptor,Ne=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ge(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Fe(t,s,a),a};let ze=class{constructor(){this.extensionHttpClients={}}createWithSharePointSource(e,t,s){const i=this.getBaseUrl(e.metadataTypeId),r=this.getHttpClientForServiceId(e.omniaServiceId),a=`siteUrl=${encodeURIComponent(t)}&fileUrl=${encodeURIComponent(s)}`;return new Promise(((t,s)=>{r.post(`${i}/sharepoint?${a}`,e).then((e=>{e.data.success?t(e.data.data):s(e.data.errorMessage)})).catch(s)}))}update(e){const t=this.getBaseUrl(e.metadataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.put(t,e).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}delete(e){const t=this.getBaseUrl(e.metadataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.delete(`${t}?${this.getQueryString(e)}`).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}get(e){const t=this.getBaseUrl(e.metadataTypeId),s=this.getHttpClientForServiceId(e.omniaServiceId);return new Promise(((i,r)=>{s.get(`${t}?${this.getQueryString(e)}`).then((e=>{e.data.success?i(e.data.data):r(e.data.errorMessage)})).catch(r)}))}uploadFile(e,t){const s=this.getBaseUrl(e.metadataTypeId),i=this.getHttpClientForServiceId(e.omniaServiceId),r=new FormData;return r.set("content",t),r.set("metadataJson",JSON.stringify(e)),new Promise(((e,t)=>{i.post(`${s}/file`,r).then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)}))}updateFile(e,t){const s=this.getBaseUrl(e.metadataTypeId),i=this.getHttpClientForServiceId(e.omniaServiceId),r=new FormData;return r.set("content",t),r.set("fileToUpdateJson",JSON.stringify(e)),new Promise(((e,t)=>{i.put(`${s}/file`,r).then((s=>{s.data.success?e(s.data.data):t(s.data.errorMessage)})).catch(t)}))}getFileUrl(e,t){const s=this.getBaseUrl(e.metadataTypeId),r=i.ServiceLocator.getUrl(e.omniaServiceId,!0).toLowerCase();let a=this.getQueryString(e);return"string"==typeof t&&t.length>0&&(a+=`&fileDownloadName=${encodeURIComponent(t)}`),`${r}/${s}/file?${a}`}getHttpClientForServiceId(e){return this.extensionHttpClients[e]||(this.extensionHttpClients[e]=this.serviceContainerContext.createInstance(i.HttpClient,{configPromise:i.HttpClient.createOmniaServiceRequestConfig(e)})),this.extensionHttpClients[e]}getBaseUrl(e){return`api/omniafilestorage/${e}`}getQueryString(e){return`fileId=${e.fileId}&metadataTypeId=${e.metadataTypeId}&omniaServiceId=${e.omniaServiceId}`}};Ne([(0,i.Inject)(i.ServiceContainerContext)],ze.prototype,"serviceContainerContext",2),ze=Ne([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],ze);var We=s("./client/fx/services/postservice.js")}
//! <omnia-transform-resource path="e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac" />
,"./client/fx/services/permissions/permissionservice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{PermissionService:()=>f});var i=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),r=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),a=s("./client/fx/services/appservice.js");class n{constructor(e){this.user=e}evaluateRoleWithContext(e){return new Promise(((t,s)=>{let n=!1,o=!1,c=!1,p=Promise.resolve();const l=e[i.Parameters.AppInstanceId.toLowerCase()];if(l){p=r.ServiceContainer.createInstance(a.AppService).getAppContextByAppInstanceId(l).then((e=>{o=e.appRouteWithProperties?.allowAnonymous||!1,c=e.appRouteWithProperties?.allowMobileLogin||!1}))}Promise.all([p,this.user]).then((([e,s])=>{n=!(!o&&s.type===i.UserTypes.Anonymous)&&!(!c&&s.type===i.UserTypes.MobileLogin),t(n)}))}))}}class o{constructor(e){this.user=e}evaluateRoleWithContext(e){return new Promise(((e,t)=>{let s=!1;this.user.then((t=>{s=t.type!==i.UserTypes.Anonymous&&t.type!==i.UserTypes.AzureAdExternalUser,e(s)}))}))}}class c{constructor(e){this.user=e}evaluateRoleWithContext(e){return new Promise(((e,t)=>{let s=!1;this.user.then((t=>{s=t.type===i.UserTypes.AzureAdInternalUser,e(s)}))}))}}class p{constructor(e){this.user=e}evaluateRoleWithContext(e){return new Promise(((e,t)=>{let s=!1;this.user.then((t=>{s=t.type===i.UserTypes.AzureAdExternalUser,e(s)}))}))}}class l{getRoleResourceWithContext(e){return Promise.resolve("tenant")}}var d=s("./client/fx/services/securityservice.js"),h=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),u=Object.defineProperty,g=Object.getOwnPropertyDescriptor,m=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?g(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&u(t,s,a),a};let f=class{constructor(){this.resourceEvaluators={},this.permissionEvaluators={},this.registeredKey={},this.context={},this.loadContextPermissionPromises={},this.loadRulePromise=null,this.loadPermissionBindingPromise=null,this.ensureRegisterBusinessProfileContextParam=()=>{const e=i.Parameters.BusinessProfileId;if(!this.registeredKey[e.toLowerCase()]){const t=this.ensureContextParam(e),s=this.omniaContext.businessProfile?this.omniaContext.businessProfile.id.toString().toLowerCase():"";t.update(s),this.omniaContext.onContextChanged().subscribe((e=>{const s=e.businessProfile?e.businessProfile.id.toString().toLowerCase():"";t.update(s)}))}},this.ensureRegisterAppInstanceContextParam=()=>{const e=i.Parameters.AppInstanceId;if(!this.registeredKey[e.toLowerCase()]){const t=this.ensureContextParam(e),s=this.omniaContext.appRoute&&this.omniaContext.appRoute.appInstance?this.omniaContext.appRoute.appInstance.id.toString().toLowerCase():"";t.update(s),this.omniaContext.onContextChanged().subscribe((e=>{const s=e.appRoute?e.appRoute.appInstance.id.toString().toLowerCase():"";t.update(s)}))}},this.getRoleIdKey=e=>e.toString().toLowerCase(),this.registerPermissionEvaluator(i.RoleDefinitions.AuthorizedUsers,new n(this.omniaContext.user)),this.registerResourceEvaluator(i.RoleDefinitions.AuthorizedUsers,new l),this.registerPermissionEvaluator(i.RoleDefinitions.InternalUsers,new o(this.omniaContext.user)),this.registerResourceEvaluator(i.RoleDefinitions.InternalUsers,new l),this.registerPermissionEvaluator(i.RoleDefinitions.InternalUsersExceptRestricted,new c(this.omniaContext.user)),this.registerResourceEvaluator(i.RoleDefinitions.InternalUsersExceptRestricted,new l),this.registerPermissionEvaluator(i.RoleDefinitions.ExternalUsers,new p(this.omniaContext.user)),this.registerResourceEvaluator(i.RoleDefinitions.ExternalUsers,new l),this.registerResourceEvaluator(i.RoleDefinitions.BusinessProfileAdmin,new i.BusinessProfileResourceEvaluator),this.registerResourceEvaluator(i.RoleDefinitions.AppInstanceAdmin,new i.AppInstanceResourceEvaluator),this.registerResourceEvaluator(i.RoleDefinitions.AppInstanceContributor,new i.AppInstanceResourceEvaluator),this.registerResourceEvaluator(i.RoleDefinitions.AppInstanceReader,new i.AppInstanceResourceEvaluator),this.ensureRegisterBusinessProfileContextParam(),this.ensureRegisterAppInstanceContextParam()}get contextChangedMsgBus(){return new r.MessageBusTopicMediator({namespace:"omniasecurityparamcontext",name:"changed"})}registerResourceEvaluator(e,t){this.resourceEvaluators[this.getRoleIdKey(e)]=t}registerPermissionEvaluator(e,t){this.permissionEvaluators[this.getRoleIdKey(e)]=t}ensureContextParam(e){e=e.toLowerCase(),this.registeredKey[e]=this.registeredKey[e]||r.Utils.generateGuid();const t=this.registeredKey[e];return{update:s=>{if(this.registeredKey[e]===t){const t=this.context[e];this.context[e]=s,t!==s&&this.contextChangedMsgBus.publish(null)}},unregister:()=>{delete this.registeredKey[e]}}}get onPermissionContextChanged(){return this.contextChangedMsgBus}async getPermissionBindings(e,t){const s=this.getMergedContextParams(t);return await this.securityService.getPermissionBindings(e,s)}async hasPermissionForRole(e,t){return await this.hasPermissionForRoles([e],t)}async hasPermissionForRoles(e,t){let s=!1;const i=this.getMergedContextParams(t),r=await this.ensurePermissionsForContext(i);for(const t of e)if(r[this.getRoleIdKey(t)]?.hasPermission){s=!0;break}return s}async addOrUpdatePermissionBindings(e,t,s){const i=this.getMergedContextParams(t);e.permissionContextParam=i,await this.securityService.addOrUpdatePermissionBindings(e,s),this.clearCache()}clearCache(){this.loadContextPermissionPromises={},this.loadPermissionBindingPromise=null}getMergedContextParams(e){const t=this.getContextParamsWithLowerKey(e);return Object.assign({},this.context,t)}getContextHash(e){return JSON.stringify(e)}async ensurePermissionsForContext(e){const t=this.getContextHash(e);return this.loadContextPermissionPromises[t]||(this.loadContextPermissionPromises[t]=this.getPermissionForContext(e)),await this.loadContextPermissionPromises[t]}async getPermissionForContext(e){const t=this.ensureLoadPermissionBindings(),s=this.ensureLoadRules(),r=await s,a=await t,n=a.filter((e=>e.identity!==i.SecurityIdentities.OverridenRulesBindingIdentity)),o=a.filter((e=>e.identity===i.SecurityIdentities.OverridenRulesBindingIdentity)),c={};for(const e of r)c[this.getRoleIdKey(e.id)]=e;const p=r,l=await this.resolveRoleResources(p,e);return await this.evaluateRoles(e,c,n,o,l),l}async evaluateRoles(e,t,s,i,r){this.evaluateWithIdentityBindings(t,s,r),await this.evaluateWithUserDefinedRulesBindings(e,t,i,r),await this.evaluateRequiredRoles(e,t,r)}async evaluateRequiredRoles(e,t,s){for(const i of Object.keys(t)){const r=t[i];await this.evaluateRole(e,r.id,t,s,!0)}}async evaluateWithUserDefinedRulesBindings(e,t,s,i){for(const r of s)if(i[this.getRoleIdKey(r.roleId)]&&i[this.getRoleIdKey(r.roleId)].resource.toLowerCase()===r.resource.toLowerCase()){const s=i[this.getRoleIdKey(r.roleId)];if(null===s.hasPermission||void 0===s.hasPermission){const a=[...r.userDefinedRules||[],...r.systemDefinedRules||[]];a.length>0&&(s.hasPermission=await this.evaluateSecurityRules(a,t,(async s=>await this.evaluateRole(e,s,t,i))))}}}async evaluateRole(e,t,s,i,r=!1){let a=null;const n=s[this.getRoleIdKey(t)];if(n){const o=i[this.getRoleIdKey(t)];o?(o.hasPermission||(o.hasPermission=await this.evaluateCustomPermissionEvaluatorRole(e,n)),!o.hasPermission&&r&&n.parentRole&&s[this.getRoleIdKey(n.parentRole)]&&(o.hasPermission=await this.evaluateRole(e,n.parentRole,s,i,r)),o.hasPermission||(o.hasPermission=await this.evaluateSecurityRules(n.rules,s,(async t=>await this.evaluateRole(e,t,s,i,r)))),a=o.hasPermission):a=await this.evaluateCustomPermissionEvaluatorRole(e,n)}return a}async evaluateCustomPermissionEvaluatorRole(e,t){let s=null;if(t.roleType===i.OmniaRoleType.Custom&&this.permissionEvaluators[this.getRoleIdKey(t.id)])try{const i=this.permissionEvaluators[this.getRoleIdKey(t.id)];if(void 0===i)return s;s=await i.evaluateRoleWithContext(e)}catch(e){s=!1}return s}async evaluateSecurityRules(e,t,s){let i=null,r=!1;if(e?.length>0){let a=null;for(const i of e)if(t[this.getRoleIdKey(i.roleId)]){let e=await s(i.roleId);null===e&&(r=!0,e=!1),a=null===a?e:"AND"===i.logicalOperator?a&&e:a||e}null!==a&&(a?i=!0:r||(i=!1))}return i}evaluateWithIdentityBindings(e,t,s){for(const e of t){const t=this.getRoleIdKey(e.roleId);s[t]&&s[t].resource.toLowerCase()===e.resource.toLowerCase()&&(s[t].hasPermission=!0)}}ensureLoadPermissionBindings(){return null===this.loadPermissionBindingPromise&&(this.loadPermissionBindingPromise=this.securityService.getAllPermissionBindings()),this.loadPermissionBindingPromise}async ensureLoadRules(){return null===this.loadRulePromise&&(this.loadRulePromise=this.securityService.getAllOmniaRoles()),this.loadRulePromise}async resolveRoleResources(e,t){const s={};for(const i of e){const e=await this.getResourceInfo(i,t);e&&(s[this.getRoleIdKey(i.id)]=e)}return s}async getResourceInfo(e,t){let s=null,r="";switch(e.roleType){case i.OmniaRoleType.Global:r="Global";break;case i.OmniaRoleType.Tenant:r="Tenant";break;case i.OmniaRoleType.Custom:r=await this.getCustomRoleResource(e,t);break;default:s=null}return r&&(s={roleId:e.id,resource:r}),s}async getCustomRoleResource(e,t){return(await(this.resourceEvaluators[this.getRoleIdKey(e.id)]?.getRoleResourceWithContext(t)))?.toLowerCase()}getContextParamsWithLowerKey(e){if(null==e)return null;const t={};for(const s in e)t[s.toLowerCase()]=e[s];return t}};m([(0,r.Inject)(d.SecurityService)],f.prototype,"securityService",2),m([(0,r.Inject)(h.OmniaContext)],f.prototype,"omniaContext",2),f=m([(0,r.Injectable)({lifetime:i.InstanceLifetimes.Singelton})],f),r.ServiceContainer.createInstance(f)},"./client/fx/stores/featurestore.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{FeatureStore:()=>u});var i=s("./client/fx/stores/store.js"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),n=s("./client/fx/services/featureservice.js"),o=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),c=s("./client/fx/services/localizationservice.js"),p=s("10407664-c0c5-438b-94b2-507d58d190af"),l=Object.defineProperty,d=Object.getOwnPropertyDescriptor,h=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?d(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&l(t,s,a),a};let u=class extends i.Store{constructor(){super(...arguments),this.activatedFeatureIds=this.state([]),this.featureDefinitions=this.state(),this.featureInstances=this.state(),this.editingFeatureInstance=this.state(),this.editingFeatureInstanceAction=this.state(),this.getters={isAnyFeaturesActivated:e=>{let t=!1;for(const s of e)if(this.activatedFeatureIds.state.indexOf(s.toString().toLowerCase())>=0){t=!0;break}return t},isAllFeaturesActivated:e=>{let t=e&&e.length>0;for(const s of e)if(-1==this.activatedFeatureIds.state.indexOf(s.toString().toLowerCase())){t=!1;break}return t},getFeatureDefinition:e=>{if(null==this.featureDefinitions.state)return null;const t=this.featureDefinitions.state.filter((t=>t.id==e));return t.length>0?t[0]:null},getFeatureInstance:e=>{if(null==this.featureInstances.state)return null;const t=this.featureInstances.state.filter((t=>t.featureId==e));return t.length>0?t[0]:null}},this.mutations={addOrUpdateFeatureInstance:this.mutation((e=>{this.featureInstances.mutate((t=>{const s=t.state.findIndex((t=>t.featureId==e.featureId));s>-1&&(t.state[s].status=e.status)}))})),setEditingFeatureInstance:e=>{null==e?this.editingFeatureInstance.mutate(null):this.editingFeatureInstance.mutate(Object.assign({},e))},setEditingFeatureInstanceAction:e=>{this.editingFeatureInstanceAction.mutate(e)}},this.actions={loadFeatureDefinitions:this.action((()=>new Promise(((e,t)=>{if(null!=this.featureDefinitions.state)e(this.featureDefinitions.state);else{const s=t=>{t.forEach((e=>{e.title=this.localizationService.transform(e.title),e.category=this.localizationService.transform(e.category),e.description=this.localizationService.transform(e.description)})),this.featureDefinitions.mutate([...t]),e(this.featureDefinitions.state)};this.featureService.getFeatureDefinitions().then(s).catch((e=>{t(e)}))}})))),loadFeatureInstances:this.action(((e,t)=>new Promise(((s,i)=>{this.featureService.getFeatureInstances(e,t).then((e=>{this.featureInstances.mutate([...e]),this.handleFeatureActivatedStatus(e),s(this.featureInstances.state)})).catch((e=>{i(e)}))})))),loadFeatureInstance:this.action((e=>new Promise(((t,s)=>{this.featureService.getFeatureInstanceByFeatureId(e).then((e=>{this.handleFeatureActivatedStatus([e]),t(e)})).catch((e=>{s(e)}))})))),activateFeature:this.action(((e,t)=>new Promise(((s,i)=>this.featureService.activeFeature(e,t).then((e=>{this.handleFeatureActivatedStatus([e]),s(e)})).catch((e=>{i(e)})))))),upgradeFeature:this.action(((e,t)=>new Promise(((s,i)=>this.featureService.upgradeFeature(e,t).then((e=>{this.handleFeatureActivatedStatus([e]),s(e)})).catch((e=>{i(e)})))))),removeFeature:this.action((e=>new Promise(((t,s)=>this.featureService.removeFeature(e).then((e=>{this.handleFeatureActivatedStatus([e]),t(e)})).catch((e=>{s(e)}))))))},this.handleFeatureActivatedStatus=e=>{this.activatedFeatureIds.mutate((t=>{for(const s of e){const e=s.featureId.toString().toLowerCase();s.isActivated?t.state.find((t=>t==e))||t.state.push(e):t.state=t.state.filter((t=>t!=e))}t.state=[...t.state]}))}}onActivated(){if(this.omniaContext.activatedFeatures){const e=this.omniaContext.activatedFeatures.map((e=>e.toString().toLowerCase()));this.activatedFeatureIds.mutate(e)}p.InternalTopics.activatedFeaturesUpdate.subscribe((e=>{const t=e.map((e=>e.toString().toLowerCase()));this.activatedFeatureIds.mutate(t)}))}onDisposing(){}};h([(0,a.Inject)(o.OmniaContext)],u.prototype,"omniaContext",2),h([(0,a.Inject)(n.FeatureService)],u.prototype,"featureService",2),h([(0,a.Inject)(c.LocalizationService)],u.prototype,"localizationService",2),u=h([(0,a.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],u)},"./client/fx/stores/localizationstore.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{LocalizationStore:()=>d});var i=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),r=s("./client/fx/stores/store.js"),a=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),n=s("./node_modules/vue/dist/vue.esm.js"),o=Object.defineProperty,c=Object.getOwnPropertyDescriptor,p=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?c(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&o(t,s,a),a};let l=class extends r.Store{constructor(){super(...arguments),this.localizations={state:{}},this.mutations={merge:this.mutation((e=>{this.mergeLoc(this.localizations.state,e),window.omnia.localization=this.localizations.state}))},this.mergeLoc=(e,t)=>{t&&Object.keys(t).forEach((s=>{e[s]?"string"==typeof t[s]?t[s]=e[s]:this.mergeLoc(e[s],t[s]):n.default.set(e,s,t[s])}))}}onActivated(){window.omnia.localization&&(this.mutations.merge.commit(window.omnia.localization),window.omnia.localization=this.localizations.state)}onDisposing(){}};l=p([(0,a.Injectable)({onStartup:e=>{r.Store.register(e,i.InstanceLifetimes.Singelton)}})],l);class d{}p([(0,a.Inject)(l)],d,"instance",2)},"./client/fx/stores/store.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Store:()=>d,StoreAction:()=>u,StoreLogTypes:()=>c,StoreLogger:()=>p,StoreMutation:()=>g,StoreState:()=>h,defineStore:()=>o});var i=s("./node_modules/vue/dist/vue.esm.js"),r=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),a=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=s("./node_modules/pinia/dist/pinia.esm-browser.js");function o(e,t){return(0,n.defineStore)(e.toString(),t)}var c=(e=>(e.mutation="Mutation",e.action="Action",e))(c||{});class p{constructor(e){this.enabled=!1,this._logState=e}add(e,t,s,i,r,a){const n={id:e,name:t,type:s,storeId:i,storeName:r,object:a,createdAt:new Date};this.enabled&&this._logState.push(n)}enable(){this.enabled=!0}disable(){this.enabled=!1}get log(){return this._logState}}const l=class{constructor(e){this._disposed=!1,this._storeDefinition={id:r.Utils.generateGuid(),className:e?.name||this.constructor.name},l.ensure()}static get logging(){return this.ensure(),this._logger||(this._logger=new p(this._log)),this._logger}get id(){return this._storeDefinition.id}onDisposing(){const e=this._storeDefinition.id.toString();l._state[e]&&(l._state[e]=void 0),this._disposed=!0}get isDisposed(){return this._disposed}state(e){return new h(e,l._state)}action(e){return new u(e,this._storeDefinition)}mutation(e){return new g(e,this._storeDefinition)}static register(e,t){const s=e.prototype._omniaInjectableOptions;if(!s)throw`A Store must be decorated with @Injectable. Update the ${e} with decorator.`;if(t===a.InstanceLifetimes.Transient)throw`A Store created using register is not allowed to have a Transient lifetime. use registerAsTransient if you know what you are doing or update the ${e} and use another lifetime`;this.registerInternal(e,t,s)}static registerAsTransient(e){const t=e.prototype._omniaInjectableOptions;this.registerInternal(e,a.InstanceLifetimes.Transient,t)}static get(e){const t=r.ServiceContainer.createInstance(e);if(!t)throw`Cant find any registered Stores with type ${e} make sure that you have registered it using Store.register`;return t}static registerInternal(e,t,s){s.lifetime=t,s.onInstanceCreated=e=>{l.initNewStore(e),e.onActivated&&e.onActivated()}}static initNewStore(e){return Object.keys(e).forEach((t=>{const s=e[t];s&&s.constructor&&s.constructor.name&&h.prototype.isPrototypeOf(s)&&s.__proto__.init(s,t,e._storeDefinition)})),e}static ensure(){l._vm||(this._vm=i.default.observable({$$state:l._state,$$log:l._log}))}};let d=l;d._state=Object.create(null),d._log=[];class h{constructor(e,t){this._globalState=t,this._val=e}init(e,t,s){e._propName=t,e._storeDefinition=s;const r=s.id.toString();e._globalState[r]||i.default.set(e._globalState,r,Object.create(null));const a=e._globalState[r];i.default.set(a,t,e._val)}get name(){return this.ensureInitialized(),this._propName}get state(){this.ensureInitialized();const e=this._storeDefinition.id.toString();return this._globalState[e][this._propName]}mutate(e){let t={},s={};if("function"==typeof e){"object"==typeof this._val?Object.assign(t,this._val):t=this._val;const i={state:this._val};e(i),s=i.state}else t=this._val,s=e;const r=this._storeDefinition.id.toString();this._beforeMutateSubscription&&this._beforeMutateSubscription.publish({oldState:t,newState:s}),this._globalState[r][this._propName]?this._globalState[r][this._propName]=s:i.default.set(this._globalState[r],this._propName,s),this._afterMutateSubscription&&this._afterMutateSubscription.publish({oldState:t,newState:s}),this._val=s,d.logging.enabled&&d.logging.add(a.Guid.newGuid(),this._propName,"Mutation",r,this._storeDefinition.className,{oldState:JSON.stringify(t),newState:JSON.stringify(s)})}get onMutating(){if(this._beforeMutateSubscription)return this._beforeMutateSubscription.subscribe;const e={namespace:`omnia.fx.stores.${this._storeDefinition.id.toString()}.state.onMutating`,name:this._propName};return this._beforeMutateSubscription=new r.MessageBusTopicMediator(e),this._beforeMutateSubscription.subscribe}get onMutated(){if(this._afterMutateSubscription)return this._afterMutateSubscription.subscribe;const e={namespace:`omnia.fx.stores.${this._storeDefinition.id.toString()}.state.onMutated`,name:this._propName};return this._afterMutateSubscription=new r.MessageBusTopicMediator(e),this._afterMutateSubscription.subscribe}ensureInitialized(){if(!this._propName)throw"Store State Access Error > Make sure the Store.register(StoreType) has been run and remember that its not allowed to access state in the store constructor"}}class u{constructor(e,t){this._storeDefinition=t;const s=this;this.dispatch=function(){const t=arguments;s._onDisplatchingSubscription&&s._onDisplatchingSubscription.publish(t);const i=e.apply(this,t);return i&&(s._onCompletedSubscription&&i.then((e=>{s._onCompletedSubscription.publish({result:e,args:t})})),s._onFailureSubscription&&i.catch((e=>{s._onFailureSubscription.publish({reason:e,args:t})}))),i}}onDispatching(e){const t=function(){e.apply(this,arguments[0])};if(this._onDisplatchingSubscription)return this._onDisplatchingSubscription.subscribe(t);const s={namespace:`omnia.fx.stores.${this._storeDefinition.id.toString()}.actions`,name:Math.random().toString(36).substring(2,15)};return this._onDisplatchingSubscription=new r.MessageBusTopicMediator(s),this._onDisplatchingSubscription.subscribe(t)}onDispatched(e){const t=function(){const t=arguments[0],s=[t.result].concat(Array.from(t.args));e.apply(this,s)};if(this._onCompletedSubscription)return this._onCompletedSubscription.subscribe(t);const s={namespace:`omnia.fx.stores.${this._storeDefinition.id.toString()}.actions`,name:Math.random().toString(36).substring(2,15)};return this._onCompletedSubscription=new r.MessageBusTopicMediator(s),this._onCompletedSubscription.subscribe(t)}onFailure(e){const t=function(){const t=arguments[0],s=[t.reason].concat(Array.from(t.args));e.apply(this,s)};if(this._onFailureSubscription)return this._onFailureSubscription.subscribe(t);const s={namespace:`omnia.fx.stores.${this._storeDefinition.id.toString()}.actions`,name:Math.random().toString(36).substring(2,15)};return this._onFailureSubscription=new r.MessageBusTopicMediator(s),this._onFailureSubscription.subscribe(t)}}class g{constructor(e,t){this._storeDefinition=t;const s=this;this.commit=function(){s._beforeMutateSubscription&&s._beforeMutateSubscription.publish(arguments),e.apply(this,arguments),s._afterMutateSubscription&&s._afterMutateSubscription.publish(arguments)}}onCommiting(e){const t=function(){e.apply(this,arguments[0])};if(this._beforeMutateSubscription)return this._beforeMutateSubscription.subscribe(t);const s={namespace:`omnia.fx.stores.${this._storeDefinition.id.toString()}.mutations`,name:Math.random().toString(36).substring(2,15)};return this._beforeMutateSubscription=new r.MessageBusTopicMediator(s),this._beforeMutateSubscription.subscribe(t)}onCommited(e){const t=function(){e.apply(this,arguments[0])};if(this._afterMutateSubscription)return this._afterMutateSubscription.subscribe(t);const s={namespace:`omnia.fx.stores.${this._storeDefinition.id.toString()}.mutations`,name:Math.random().toString(36).substring(2,15)};return this._afterMutateSubscription=new r.MessageBusTopicMediator(s),this._afterMutateSubscription.subscribe(t)}}},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AppLayoutStore:()=>Tt,AppNamingPolicyStore:()=>Gt,AppStore:()=>h,AuditLogStore:()=>_e,AzureAdStore:()=>Y,BlockTitleGlobalSettingsStore:()=>Ge,BlockTitleSettingsStore:()=>Ke,BusinessProfileStore:()=>pe,ClipboardStore:()=>Ut,CommentLikeStore:()=>k,DirectionRuleStore:()=>ke,EnterpriseGlossaryStore:()=>bt,EnterprisePropertyCategoryStore:()=>De,EnterprisePropertySetStore:()=>ge,EnterprisePropertyStore:()=>R,ExtensionStore:()=>ve,FeatureStore:()=>u.FeatureStore,LocalizationStore:()=>ie.LocalizationStore,MSTeamsStore:()=>_t,MediaPickerStore:()=>at,MultilingualStore:()=>j,OrganizationTreeStore:()=>lt,PostStore:()=>qt,ProfileCardStore:()=>mt,SiteStore:()=>N,Store:()=>i.Store,StoreAction:()=>i.StoreAction,StoreLogTypes:()=>i.StoreLogTypes,StoreLogger:()=>i.StoreLogger,StoreMutation:()=>i.StoreMutation,StoreState:()=>i.StoreState,SystemLogStore:()=>et,TargetingPropertyStore:()=>V,TimezonesStore:()=>xe,TokenStatus:()=>Et,TokenStore:()=>Bt,UserStore:()=>w,UserTargetingStore:()=>se,defineStore:()=>i.defineStore});var i=s("./client/fx/stores/store.js"),r=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=s("./client/fx/services/appservice.js"),n=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),o=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),c=s("./client/fx/services/permissions/permissionservice.js"),p=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?l(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&p(t,s,a),a};let h=class extends i.Store{constructor(){super(),this.TenantAppTemplatesKey="TenantAppTemplatesKey",this.appInstancesLoadPromiseMap={},this.appInstancesPromiseMap={},this.appDefinitions=this.state(),this.appTemplates=this.state({}),this.appInstances=this.state({}),this.appInstancesOld=this.state({}),this.editingAppTemplate=this.state(),this.preProcessedAppInstance=this.state(),this.ensureLoadAppInstancesByAppDefinitionIdPromises={},this.editingAppInstance=this.state(),this.getters={getTenantAppTemplates:()=>null==this.appTemplates.state[this.TenantAppTemplatesKey]?[]:this.appTemplates.state[this.TenantAppTemplatesKey],getAppTemplates:(e=null)=>{const t=e&&e!=r.Guid.empty?e.toString().toLowerCase():this.getProfileKey();if(null==this.appTemplates.state[t]){if(null==this.appTemplates.state[this.TenantAppTemplatesKey])return[];{const e=this.appTemplates.state[this.TenantAppTemplatesKey].filter((e=>e.businessProfileId.toString().toLowerCase()==t));this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[t]:[...e]}))}}return this.appTemplates.state[t]},getAppTemplatesByDefinition:(e,t=null)=>{const s=t&&t!=r.Guid.empty?t.toString().toLowerCase():this.getProfileKey();if(null==this.appTemplates.state[s]){if(null==this.appTemplates.state[this.TenantAppTemplatesKey])return[];{const e=this.appTemplates.state[this.TenantAppTemplatesKey].filter((e=>e.businessProfileId.toString().toLowerCase()==s));this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[s]:[...e]}))}}return this.appTemplates.state[s].filter((t=>t.appDefinitionId==e))},getAppDefinition:e=>{if(null==this.appDefinitions.state)return null;const t=this.appDefinitions.state.filter((t=>t.id==e));return t.length>0?t[0]:null},getAppTemplate:e=>{if(this.businessProfile){const t=this.getProfileKey();if(null==this.appTemplates.state[t]){if(null==this.appTemplates.state[this.TenantAppTemplatesKey])return null;{const e=this.appTemplates.state[this.TenantAppTemplatesKey].filter((e=>e.businessProfileId.toString().toLowerCase()==t));this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[t]:[...e]}))}}const s=this.appTemplates.state[t].filter((t=>t.id==e));if(s.length>0)return s[0]}return null},getAppInstanceById:e=>this.appInstances.state[e.toString()],getEditingAppInstance:()=>this.editingAppInstance.state},this.mutations={setEditingAppTemplate:e=>{this.editingAppTemplate.mutate(e)},setEditingAppInstance:this.mutation((e=>{null==e?this.editingAppInstance.mutate(null):this.editingAppInstance.mutate(Object.assign({},e))})),appInstanceFollowStatusUpdated:this.mutation(((e,t)=>{}))},this.actions={ensureAppProvisioning:this.action(((e,t=null)=>new Promise(((s,i)=>{this.appService.ensureAppInstanceProvisioning(e,t).then((t=>{t&&(this.appInstancesPromiseMap[e.toString()]=Promise.resolve(t),this.appInstances.mutate(Object.assign({},this.appInstances.state,{[e.toString()]:t}))),s(t)})).catch(i)})))),requestChangeProvisioning:this.action(((e,t=null)=>new Promise(((s,i)=>{this.appService.requestChangeProvisioning(e,t).then((t=>{t&&(this.appInstancesPromiseMap[e.toString()]=Promise.resolve(t),this.appInstances.mutate(Object.assign({},this.appInstances.state,{[e.toString()]:t}))),s(t)})).catch(i)})))),loadAppDefinitions:this.action((()=>new Promise(((e,t)=>{if(null!=this.appDefinitions.state)e(this.appDefinitions.state);else{const s=t=>{this.appDefinitions.mutate([...t]),e(this.appDefinitions.state)};this.appService.getAppDefinitions().then(s).catch((e=>{t(e)}))}})))),loadTenantAppTemplates:this.action((()=>new Promise(((e,t)=>{if(this.appTemplates.state[this.TenantAppTemplatesKey])e(this.appTemplates.state[this.TenantAppTemplatesKey]);else{const s=t=>{this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[this.TenantAppTemplatesKey]:[...t]})),e(this.appTemplates.state[this.TenantAppTemplatesKey])};this.appService.getTenantAppTemplates().then(s).catch((e=>{t(e)}))}})))),loadAppTemplates:this.action(((e=null)=>new Promise(((t,s)=>{const i=e&&e!=r.Guid.empty?e.toString().toLowerCase():this.getProfileKey();if(this.appTemplates.state[i])t(this.appTemplates.state[i]);else if(this.appTemplates.state[this.TenantAppTemplatesKey]){const e=this.appTemplates.state[this.TenantAppTemplatesKey].filter((e=>e.businessProfileId.toString().toLowerCase()==i));this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[i]:[...e]})),t(this.appTemplates.state[i])}else{const r=e=>{this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[i]:[...e]})),t(this.appTemplates.state[i])};this.appService.getAppTemplates(e).then(r).catch((e=>{s(e)}))}})))),loadAppInstance:this.action((e=>new Promise(((t,s)=>{this.appService.getAppInstanceById(e).then((e=>{t(null!=e?e:null)})).catch((e=>{t(null)}))})))),ensureAppInstance:this.action((e=>new Promise(((t,s)=>{void 0===this.appInstancesPromiseMap[e.toString()]&&(this.appInstancesPromiseMap[e.toString()]=this.appService.getAppInstanceById(e).then((t=>(t&&this.appInstances.mutate(Object.assign({},this.appInstances.state,{[e.toString()]:t})),t))).catch((e=>(s(e),null)))),this.appInstancesPromiseMap[e.toString()].then(t,s)})))),refreshAppInstance:this.action((e=>(this.appInstancesPromiseMap[e.toString()]=void 0,this.actions.ensureAppInstance.dispatch(e)))),loadAppInstanceProgress:this.action((e=>new Promise(((t,s)=>{this.appService.getAppInstanceProgressByTransactionId(e).then((e=>{if(null!=e&&null!=e.appInstance){const s=e.appInstance;this.appInstances.mutate(Object.assign({},this.appInstances.state,{[s.toString()]:s})),t(e)}else t(null)})).catch((e=>{s(e)}))})))),addOrUpdateAppTemplate:this.action((e=>new Promise(((t,s)=>{this.appService.addOrUpdateAppTemplate(e).then((e=>{const s=this.getProfileKey();let i;if(this.appTemplates.state[s]){i=[...this.appTemplates.state[s].filter((t=>t.id!=e.id)),e]}else i=[e];this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[s]:i})),t(e)})).catch((e=>{s(e)}))})))),removeAppTemplate:this.action((e=>new Promise(((t,s)=>{this.appService.removeAppTemplate(e).then((()=>{const s=this.getProfileKey(),i=this.appTemplates.state[s].filter((t=>t.id!==e));this.appTemplates.mutate(Object.assign({},this.appTemplates.state,{[s]:[...i]})),t(null)}),s).catch((e=>{s(e)}))})))),createAppInstance:this.action(((e,t=null,s=!1)=>new Promise(((i,r)=>{this.appService.createAppInstance(e.appTemplateId,e.inputInfo,e.contextParams,t,s).then((e=>{this.permissionService.clearCache();const s=this.getProfileAppDefinitionKey(e.appDefinitionId,t);let r;if(this.appInstancesOld.state[s]){r=[...this.appInstancesOld.state[s].appInstances.filter((t=>t.id!==e.id)),e]}else r=[e];this.appInstancesOld.mutate(Object.assign({},this.appInstancesOld.state,{[s]:Object.assign({},this.appInstancesOld.state[s],{appInstances:r})})),i(e)})).catch((e=>{r(e)}))})))),updateAppInstance:this.action((e=>new Promise(((t,s)=>{this.appService.updateAppInstance(e.appInstanceId,e.inputInfo,e.contextParams).then((e=>{this.appInstances.mutate(Object.assign({},this.appInstances.state,{[e.id.toString()]:e})),t(e)})).catch((e=>{s(e)}))})))),removeAppInstance:this.action((e=>new Promise(((t,s)=>{this.appService.removeAppInstance(e).then((s=>{const i=this.appInstances.state;i[e.toString()]=void 0,this.appInstances.mutate(Object.assign({},i)),t(s)})).catch((e=>{s(e)}))})))),approveAppInstance:this.action(((e,t)=>new Promise(((s,i)=>{t.contextParams&&delete t.contextParams[r.Parameters.AppInstanceId.toLowerCase()],this.appService.approveAppInstance(e,t.inputInfo,t.contextParams).then((e=>{const t=this.getProfileAppDefinitionKey(e.appDefinitionId);let i;if(this.appInstancesOld.state[t]){i=[...this.appInstancesOld.state[t].appInstances.filter((t=>t.id!==e.id)),e]}else i=[e];this.appInstancesOld.mutate(Object.assign({},this.appInstancesOld.state,{[t]:Object.assign({},this.appInstancesOld.state[t],{appInstances:i})})),s(e)})).catch((e=>{i(e)}))})))),rejectAppInstance:this.action((e=>new Promise(((t,s)=>{this.appService.rejectAppInstance(e.appInstanceId,e).then((s=>{const i=this.getProfileAppDefinitionKey(s.appDefinitionId);let r=[];if(this.appInstancesOld.state[i]){r=[...this.appInstancesOld.state[i].appInstances.filter((t=>t.id!==e.appInstanceId))]}else r=[s];this.appInstancesOld.mutate(Object.assign({},this.appInstancesOld.state,{[i]:Object.assign({},this.appInstancesOld.state[i],{appInstances:r})})),t(s)})).catch((e=>{s(e)}))})))),updateAppInstanceProperties:this.action((e=>new Promise(((t,s)=>{this.appService.updateAppInstanceProperties(e.appInstanceId,e.inputInfo).then((e=>{this.appInstances.mutate(Object.assign({},this.appInstances.state,{[e.id.toString()]:e})),t(e)})).catch((e=>{s(e)}))})))),followAppInstance:this.action((e=>new Promise(((t,s)=>{this.appService.followAppInstance(e).then((()=>{t(),this.mutations.appInstanceFollowStatusUpdated.commit(e,!0)})).catch((e=>{s(e)}))})))),unfollowAppInstance:this.action((e=>new Promise(((t,s)=>{this.appService.unfollowAppInstance(e).then((()=>{t(),this.mutations.appInstanceFollowStatusUpdated.commit(e,!1)})).catch((e=>{s(e)}))})))),addOrUpdateLastVisited:this.action((e=>new Promise(((t,s)=>{this.appService.addOrUpdateLastVisited(e).then(t).catch((e=>{s(e)}))}))))},this.getProfileAppDefinitionKey=(e,t=null)=>{const s=e.toString().toLowerCase();return t||(t=this.businessProfile.id),`${t.toString().toLowerCase()}-${s}`},this.getProfileKey=()=>this.businessProfile.id.toString().toLowerCase(),this.businessProfile=this.omniaContext.businessProfile,this.omniaContext.onContextChanged().subscribe((e=>{this.businessProfile=e.businessProfile}))}onActivated(){}onDisposing(){}};d([(0,n.Inject)(a.AppService)],h.prototype,"appService",2),d([(0,n.Inject)(o.OmniaContext)],h.prototype,"omniaContext",2),d([(0,n.Inject)(c.PermissionService)],h.prototype,"permissionService",2),h=d([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],h);var u=s("./client/fx/stores/featurestore.js"),g=s("./client/fx/services/localizationservice.js"),m=Object.defineProperty,f=Object.getOwnPropertyDescriptor,y=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?f(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&m(t,s,a),a};let P=class{constructor(){this.getEnterprisePropertyDataTypes=(e="")=>new Promise(((t,s)=>{this.httpClient.get("api/enterpriseproperties/datatypes"+(n.Utils.isNullOrEmpty(e)?"":"?hash="+e)).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getEnterprisePropertyDefinitions=(e="")=>new Promise(((t,s)=>{this.httpClient.get("api/enterpriseproperties"+(n.Utils.isNullOrEmpty(e)?"":"?hash="+e)).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getEnterprisePropertyDefinitionById=e=>new Promise(((t,s)=>{this.httpClient.get(`api/enterpriseproperties/${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.createEnterprisePropertyDefinition=e=>new Promise(((t,s)=>{this.httpClient.post("api/enterpriseproperties",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.updateEnterprisePropertyDefinition=e=>new Promise(((t,s)=>{this.httpClient.put("api/enterpriseproperties",e).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.removeEnterprisePropertyDefinition=e=>new Promise(((t,s)=>{this.httpClient.delete(`api/enterpriseproperties/${e}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.terminateEnterprisePropertyDefinition=e=>new Promise(((t,s)=>{this.httpClient.post(`api/enterpriseproperties/terminate?id=${e}`).then((e=>{const i=e.data;i.success?t():s(i.errorMessage)})).catch(s)})),this.restoreEnterprisePropertyDefinition=e=>new Promise(((t,s)=>{this.httpClient.post(`api/enterpriseproperties/restore?id=${e}`).then((e=>{const i=e.data;i.success?t(i.data):s(i.errorMessage)})).catch(s)})),this.getAllArchiveEnterprisePropertyDefinition=()=>new Promise(((e,t)=>{this.httpClient.get("api/enterpriseproperties/propertyarchives").then((s=>{const i=s.data;i.success?e(i.data):t(i.errorMessage)})).catch(t)}))}};y([(0,n.Inject)(n.HttpClient,{configPromise:n.HttpClient.createOmniaServiceRequestConfig()})],P.prototype,"httpClient",2),P=y([(0,n.Injectable)({lifetime:r.InstanceLifetimes.Transient})],P);var v=s("./client/fx/services/azureadservice.js"),b=s("./client/fx/services/userservice.js"),S=Object.defineProperty,I=Object.getOwnPropertyDescriptor,C=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?I(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&S(t,s,a),a};let w=class extends i.Store{constructor(){super(...arguments),this.resolvers={},this.resolvedIdentities=this.state({}),this.resolvedPresenceUsers=this.state({}),this.pendingGetUsersPresenceActions=[],this.getUserAvatarSrc=(e="00000000-0000-0000-0000-000000000000")=>this.userService.getUserAvatarSrc(e),this.getters={resolvedIdentities:(...e)=>e.map((e=>this.resolvedIdentities.state[e.uid.toLowerCase()])).filter((e=>e)),resolvedIdentity:e=>this.resolvedIdentities.state[e.uid.toLowerCase()]||null,resolvedPresenceUser:e=>this.resolvedPresenceUsers.state[e.toLowerCase()]||null},this.actions={ensureResolve:this.action(((...e)=>{const t=[],s=[],i=[];return e.forEach((e=>{if(!this.resolvers[e.uid.toLowerCase()]){const t=new r.Future(null);s.push(t),this.resolvers[e.uid.toLowerCase()]=t,i.push(e)}t.push(this.resolvers[e.uid.toLowerCase()])})),i.length>0&&this.userService.resolve(...i).then((e=>{const t={...this.resolvedIdentities.state};e.forEach((e=>{t[e.uid.toLowerCase()]=e})),this.resolvedIdentities.mutate(t)})).then((()=>{s.forEach((e=>e.resolve()))})),Promise.all(t)})),ensureUsersPresence:this.action((e=>{const t=new Promise(((t,s)=>{const i=[];e.forEach((e=>{const r=this.resolvedPresenceUsers.state[e.toString().toLowerCase()]||null;if(r?i.push(r):this.pendingGetUsersPresenceActions.push({objectIds:[e],resolve:t,reject:s}),this.pendingGetUsersPresenceActions.length>640){const e=this.pendingGetUsersPresenceActions,t=e.reduce(((e,t)=>e.concat(t.objectIds)),[]).filter(((e,t,s)=>s.indexOf(e)===t));this.pendingGetUsersPresenceActions=[],this.azureAdService.getUsersPresence(this.cloneEncodeObjectIds(t)).then((t=>{const s={...this.resolvedPresenceUsers.state};t.forEach((e=>{s[e.id.toLowerCase()]=e})),this.resolvedPresenceUsers.mutate(s),e.forEach((e=>e.resolve()))})).catch((t=>{e.forEach((e=>e.reject(t)))}))}}))}));return this.pendingGetUsersPresenceActions.length>0?(n.Utils.timebox("UserStore_ensureUsersPresenceAction",(()=>{const e=this.pendingGetUsersPresenceActions,t=e.reduce(((e,t)=>e.concat(t.objectIds)),[]).filter(((e,t,s)=>s.indexOf(e)===t));this.pendingGetUsersPresenceActions=[],this.azureAdService.getUsersPresence(this.cloneEncodeObjectIds(t)).then((t=>{const s={...this.resolvedPresenceUsers.state};t.forEach((e=>{s[e.id.toLowerCase()]=e})),this.resolvedPresenceUsers.mutate(s),e.forEach((e=>e.resolve()))})).catch((t=>{e.forEach((e=>e.reject(t)))}))}),500),t):new Promise(((e,t)=>{e()}))}))}}onActivated(){}onDisposing(){}get current(){return this.currentUserPromise||(this.omniaContext.environment.isOmniaApp?this.currentUserPromise=new Promise(((e,t)=>{e(this.azureAdService.populateCurrentUser(window.omnia.user))})):this.currentUserPromise=this.userService.getCurrentUser()),this.currentUserPromise}getUserPresenceIconName(e,t){return this.userService.getUserPresenceIconName(e,t)}getUserPresenceIconColor(e,t){return this.userService.getUserPresenceIconColor(e,t)}getUserPresenceStatusName(e){return this.userService.getUserPresenceStatusName(e)}cloneEncodeObjectIds(e){const t=[];return e&&e.forEach((e=>t.push(encodeURI(e)))),t}};C([(0,n.Inject)(b.UserService)],w.prototype,"userService",2),C([(0,n.Inject)(v.AzureAdService)],w.prototype,"azureAdService",2),C([(0,n.Inject)(o.OmniaContext)],w.prototype,"omniaContext",2),w=C([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],w);var x=s("./client/fx/core/services/internalconfigurationservice.js"),T=Object.defineProperty,L=Object.getOwnPropertyDescriptor,O=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?L(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&T(t,s,a),a};let j=class extends i.Store{constructor(){super(...arguments),this.subscriptionHandler=null,this.userPreferredLanguage=null,this.scopeLanguages=this.state({}),this.getters={languageSetting:e=>this.scopeLanguages.state[e]?this.scopeLanguages.state[e]:(this.scopeLanguages.state[e]=null,this.scopeLanguages.state[r.MultilingualScopes.Tenant]),onLanguageSettingUpdated:()=>this.scopeLanguages.onMutated,ensureMultilingualString:e=>{const t={isMultilingualString:!0};return e?e.isMultilingualString?e:"string"==typeof e||e instanceof String?(t["en-us"]=e,t):Object.assign(t,e):t},stringValue:(e,t=r.MultilingualScopes.BusinessProfile)=>{let s="";if(e){let i=null;i=t===r.MultilingualScopes.Tenant&&this.scopeLanguages.state[r.MultilingualScopes.Tenant]?this.scopeLanguages.state[r.MultilingualScopes.Tenant]:this.scopeLanguages.state[r.MultilingualScopes.BusinessProfile]||this.scopeLanguages.state[r.MultilingualScopes.Tenant];const a=i?i.userPreferredLanguageTag:null,n=i?i.defaultLanguageTag:null,o=i?i.availableLanguages:[];if(s=this.tryGetMultilingualValue(e,a,i),null!=s&&""!==s||(s=this.tryGetMultilingualValue(e,n,i)),null==s||""===s){const t=o.map((e=>e.name)).find((t=>e[t]));if(t)s=e[t];else{const t=Object.keys(e).map((t=>e[t])).find((e=>!(!e||"boolean"==typeof e||""===e)));t&&(s=t)}}}return s||""}},this.internalMutations={setScopeLanguageSetting:this.mutation(((e,t)=>{this.scopeLanguages.mutate((s=>s.state[e]=t))}))},this.actions={getLanguageSettings:this.action((e=>new Promise(((t,s)=>{this.userStore.current.then((s=>{this.userPreferredLanguage=s.preferredLanguage;const i=e.tenant.propertyBag.getModel(r.TenantLanguageSettings),a=e.businessProfile?e.businessProfile.propertyBag.getModel(r.BusinessProfileLanguageSettings):null;if(i){const e=!!i.excludeCountry&&void 0!==i.excludeCountry&&i.excludeCountry;this.internalMutations.setScopeLanguageSetting.commit(r.MultilingualScopes.Tenant,this.createScopedLanguageSetting(i.languages,e))}if(a){let e=a.languages,t=!!a.excludeCountry&&void 0!==a.excludeCountry&&a.excludeCountry;(a.inheritFromTenant||null==e||0==e.length)&&(e=i.languages),a.inheritFromTenant&&(t=!!i?.excludeCountry&&void 0!==i?.excludeCountry&&i?.excludeCountry),this.internalMutations.setScopeLanguageSetting.commit(r.MultilingualScopes.BusinessProfile,this.createScopedLanguageSetting(e,t))}t()})).catch(s)}))))},this.tryGetMultilingualValue=(e,t,s)=>{let i="";if(t)if(e[t]&&""!==e[t])i=e[t];else{const r=t.substring(0,2),a=Object.keys(e).filter((t=>""!==e[t]&&0===t.indexOf(r)));if(a.length>0){let t=a[0];if(null!=s)if(s.defaultLanguageTag&&a.indexOf(s.defaultLanguageTag)>=0)t=s.defaultLanguageTag;else if(s.availableLanguages&&s.availableLanguages.length>0){const e=s.availableLanguages.filter((e=>a.indexOf(e.name)>=0));e.length>0&&(t=e[0].name)}i=e[t]}}return i},this.createScopedLanguageSetting=(e,t)=>{(e=e?n.Utils.clone(e):[]).forEach((e=>{e.name=e.name.toLowerCase(),e.displayName=e.displayName}));let s=null;const i=e.find((e=>e.default));i&&(e.splice(e.indexOf(i),1),e.unshift(i),s=i.name),s||(s="en-us",0==e.length&&e.push({lcid:1033,default:!0,name:s,displayName:"English (United States)"}));let r=s;if(this.userPreferredLanguage){const t=e.find((e=>e.name==this.userPreferredLanguage.toLowerCase()));t&&(r=t.name)}return{availableLanguages:e,defaultLanguageTag:s,userPreferredLanguageTag:r,excludeCountry:t}}}onActivated(){const e=x.InternalConfigurationService.getConfiguration();e&&e.enableMultilingual&&(this.actions.getLanguageSettings.dispatch(this.omniaContext),this.subscriptionHandler=this.omniaContext.onContextChanged().subscribe((e=>{this.actions.getLanguageSettings.dispatch(e)})))}onDisposing(){this.subscriptionHandler.unsubscribe()}};O([(0,n.Inject)(g.LocalizationService)],j.prototype,"localizationService",2),O([(0,n.Inject)(o.OmniaContext)],j.prototype,"omniaContext",2),O([(0,n.Inject)(w)],j.prototype,"userStore",2),j=O([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],j);O([(0,n.Inject)(j)],class{},"store",2);var _=s("./client/fx/services/queryablepropertiesservice.js"),A=Object.defineProperty,M=Object.getOwnPropertyDescriptor,U=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?M(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&A(t,s,a),a};let R=class extends i.Store{constructor(){super(...arguments),this.ensuredLoadDataPromise=null,this.ensuredQueryablePropertiesLoadedPromise={},this.editingProperty=this.state({}),this.enterprisePropertyDefinitions=this.state([]),this.enterprisePropertyDataTypes=this.state([]),this.computedPropertyMapping=this.state({}),this.getters={enterprisePropertyDefinitionsByIndexedTypes:e=>this.enterprisePropertyDefinitions.state.filter((t=>t.enterprisePropertyDataType&&e.indexOf(t.enterprisePropertyDataType.indexedType)>=0)),enterprisePropertyDefinitions:()=>this.enterprisePropertyDefinitions.state.filter((e=>e.enterprisePropertyDataType)),enterprisePropertyDefinitionsGroupByCategory:()=>this.getters.enterprisePropertyDefinitions().reduce(((e,t)=>{const s=t.enterprisePropertyCategoryId?t.enterprisePropertyCategoryId.toString():r.Constants.enterprisepropertycategories.defaultCategoryId.toString();return e[s]=e[s]||[],e[s].push(t),e}),Object.create(null)),enterprisePropertyDataTypes:()=>this.enterprisePropertyDataTypes.state.filter((e=>e)),omniaSearchableEnterprisePropertyDataTypes:()=>this.enterprisePropertyDataTypes.state.filter((e=>e.omniaSearchable)),managedProperties:()=>this.enterprisePropertyDefinitions.state.filter((e=>e.enterprisePropertyDataType&&e.spSearchable&&e.managedPropertySettings&&e.managedPropertySettings.managedProperty)),queryableManagedProperties:()=>this.enterprisePropertyDefinitions.state.filter((e=>e.enterprisePropertyDataType&&e.spSearchable&&e.managedPropertySettings&&e.managedPropertySettings.managedProperty&&e.managedPropertySettings.queryable)),sortableManagedProperties:()=>this.enterprisePropertyDefinitions.state.filter((e=>e.enterprisePropertyDataType&&e.spSearchable&&e.managedPropertySettings&&e.managedPropertySettings.managedProperty&&e.managedPropertySettings.sortable)),retrievableManagedProperties:()=>this.enterprisePropertyDefinitions.state.filter((e=>e.enterprisePropertyDataType&&e.spSearchable&&e.managedPropertySettings&&e.managedPropertySettings.managedProperty&&e.managedPropertySettings.retrievable)),refinableManagedProperties:()=>this.enterprisePropertyDefinitions.state.filter((e=>e.enterprisePropertyDataType&&e.spSearchable&&e.managedPropertySettings&&e.managedPropertySettings.managedProperty&&e.managedPropertySettings.refinable)),queryableManagedPropertiesByIndexedTypes:e=>this.enterprisePropertyDefinitions.state.filter((t=>t.enterprisePropertyDataType&&e.indexOf(t.enterprisePropertyDataType.indexedType)>=0&&t.spSearchable&&t.managedPropertySettings&&t.managedPropertySettings.managedProperty&&t.managedPropertySettings.queryable)),sortableManagedPropertiesByIndexedTypes:e=>this.enterprisePropertyDefinitions.state.filter((t=>t.enterprisePropertyDataType&&e.indexOf(t.enterprisePropertyDataType.indexedType)>=0&&t.spSearchable&&t.managedPropertySettings&&t.managedPropertySettings.managedProperty&&t.managedPropertySettings.sortable)),retrievableManagedPropertiesByIndexedTypes:e=>this.enterprisePropertyDefinitions.state.filter((t=>t.enterprisePropertyDataType&&e.indexOf(t.enterprisePropertyDataType.indexedType)>=0&&t.spSearchable&&t.managedPropertySettings&&t.managedPropertySettings.managedProperty&&t.managedPropertySettings.retrievable)),refinableManagedPropertiesByIndexedTypes:e=>this.enterprisePropertyDefinitions.state.filter((t=>t.enterprisePropertyDataType&&e.indexOf(t.enterprisePropertyDataType.indexedType)>=0&&t.spSearchable&&t.managedPropertySettings&&t.managedPropertySettings.managedProperty&&t.managedPropertySettings.refinable)),editingProperty:()=>this.editingProperty.state,queryableEnterpriseProperties:(e,t="")=>{const s=e.toString();let i=this.computedPropertyMapping.state[s]?this.computedPropertyMapping.state[s].map((e=>e.enterprisePropertyId)):[];return""!==t&&(i=this.computedPropertyMapping.state[s]?this.computedPropertyMapping.state[s].filter((e=>e.tableName===t)).map((e=>e.enterprisePropertyId)):[]),this.enterprisePropertyDefinitions.state.filter((e=>i.indexOf(e.id)>=0))},queryableEnterprisePropertiesByIndexedTypes:(e,t,s="")=>{const i=e.toString();let r=this.computedPropertyMapping.state[i]?this.computedPropertyMapping.state[i].map((e=>e.enterprisePropertyId)):[];return""!==s&&(r=this.computedPropertyMapping.state[i]?this.computedPropertyMapping.state[i].filter((e=>e.tableName===s)).map((e=>e.enterprisePropertyId)):[]),this.enterprisePropertyDefinitions.state.filter((e=>r.indexOf(e.id)>=0&&e.enterprisePropertyDataType&&t.indexOf(e.enterprisePropertyDataType.indexedType)>=0))},queryableEnterprisePropertiesColumnMapping:(e,t="")=>{const s=e.toString();let i=[];i=""===t?this.computedPropertyMapping.state[s]?this.computedPropertyMapping.state[s].map((e=>e)):[]:this.computedPropertyMapping.state[s]?this.computedPropertyMapping.state[s].filter((e=>e.tableName===t)):[];const r=this.enterprisePropertyDefinitions.state.map((e=>e.id));return i.filter((e=>r.indexOf(e.enterprisePropertyId)>=0))}},this.mutations={resetEditingProperty:this.mutation((e=>{this.editingProperty.mutate(n.Utils.clone(e)||{})}))},this.actions={refresh:this.action((()=>(this.ensuredLoadDataPromise=null,this.actions.ensureLoadData.dispatch()))),ensureLoadData:this.action((()=>{if(!this.ensuredLoadDataPromise){const e=this.omniaContext.tenant.propertyBag.getModel(r.AllEnterprisePropertiesContentHashSettings),t=this.omniaContext.tenant.propertyBag.getModel(r.AllEnterprisePropertyDataTypesContentHashSettings),s=this.enterprisePropertyService.getEnterprisePropertyDefinitions(e?e.resultHash:""),i=this.enterprisePropertyService.getEnterprisePropertyDataTypes(t?t.resultHash:"");this.ensuredLoadDataPromise=Promise.all([s,i]).then((e=>{const t=e[0],s=e[1];return t.forEach((e=>{e.title&&Object.keys(e.title).forEach((t=>{"string"==typeof e.title[t]&&(e.title[t]=this.localizationService.transform(e.title[t]))})),e.multilingualTitle=this.multilingualTextsStore.getters.stringValue(e.title),e.enterprisePropertyDataType=s.filter((t=>t.id==e.enterprisePropertyDataTypeId))[0]})),t.sort(((e,t)=>e.multilingualTitle.toLowerCase()<t.multilingualTitle.toLowerCase()?-1:e.multilingualTitle.toLowerCase()>t.multilingualTitle.toLowerCase()?1:0)),this.enterprisePropertyDefinitions.mutate(t),this.enterprisePropertyDataTypes.mutate(s),this.ensureUniqueMultilingualTitle(),!0})).catch((()=>(this.ensuredLoadDataPromise=null,!1)))}return new Promise(((e,t)=>{Promise.all([this.ensuredLoadDataPromise]).then((()=>{e(!0)}))}))})),addEnterprisePropertyDefinition:this.action((e=>this.enterprisePropertyService.createEnterprisePropertyDefinition(e).then((e=>(e.multilingualTitle=this.multilingualTextsStore.getters.stringValue(e.title),e.enterprisePropertyDataType=this.enterprisePropertyDataTypes.state.filter((t=>t.id==e.enterprisePropertyDataTypeId))[0],this.enterprisePropertyDefinitions.mutate((t=>t.state=[...t.state.filter((t=>t.id!=e.id)),e])),this.ensureUniqueMultilingualTitle(),e))))),updateEnterprisePropertyDefinition:this.action((e=>this.enterprisePropertyService.updateEnterprisePropertyDefinition(e).then((e=>(e.multilingualTitle=this.multilingualTextsStore.getters.stringValue(e.title),e.enterprisePropertyDataType=this.enterprisePropertyDataTypes.state.filter((t=>t.id==e.enterprisePropertyDataTypeId))[0],this.enterprisePropertyDefinitions.mutate((t=>t.state=[...t.state.filter((t=>t.id!=e.id)),e])),this.ensureUniqueMultilingualTitle(),e))))),removeEnterprisePropertyDefinition:this.action((e=>this.enterprisePropertyService.removeEnterprisePropertyDefinition(e).then((()=>(this.enterprisePropertyDefinitions.mutate((t=>t.state=t.state.filter((t=>t.id!=e)))),this.ensureUniqueMultilingualTitle(),!0))))),getAllArchiveEnterprisePropertyDefinition:this.action((()=>new Promise(((e,t)=>this.enterprisePropertyService.getAllArchiveEnterprisePropertyDefinition().then((t=>{e(t)})).catch((e=>{t(e)})))))),terminateEnterprisePropertyDefinition:this.action((e=>this.enterprisePropertyService.terminateEnterprisePropertyDefinition(e).then((()=>!0)))),restoreEnterprisePropertyDefinition:this.action((e=>new Promise(((t,s)=>this.enterprisePropertyService.restoreEnterprisePropertyDefinition(e).then((e=>{e.multilingualTitle=this.multilingualTextsStore.getters.stringValue(e.title),e.enterprisePropertyDataType=this.enterprisePropertyDataTypes.state.filter((t=>t.id==e.enterprisePropertyDataTypeId))[0],this.enterprisePropertyDefinitions.mutate((t=>t.state=[...t.state.filter((t=>t.id!=e.id)),e])),this.ensureUniqueMultilingualTitle(),t()}),s).catch((e=>{s(e)})))))),ensureLoadQueryableProperties:this.action(((e,t="")=>{const s=e.toString();return this.ensuredQueryablePropertiesLoadedPromise[s]||(this.ensuredQueryablePropertiesLoadedPromise[s]=new Promise(((e,i)=>{if(this.computedPropertyMapping.state[s])e();else{const r=this.queryablePropertiesService.getQueryableProperties(t,s);if(!r)throw new Error(`Could not found load queryable properties implementation of ${s} `);r.then((t=>{this.computedPropertyMapping.mutate(Object.assign({},this.computedPropertyMapping.state,{[s]:[...t]})),e()})).catch(i)}}))),this.ensuredQueryablePropertiesLoadedPromise[s]})),removeQueryableProperties:this.action(((e,t)=>new Promise(((s,i)=>{const r=e.toString(),a=this.queryablePropertiesService.removeQueryableProperties(t,r);if(!a)throw new Error(`RemoveQueryableProperties must be regist as implementation of ${r} `);return a.then((()=>{const e=this.computedPropertyMapping.state[r].filter((e=>e.enterprisePropertyId!==t.enterprisePropertyId));this.computedPropertyMapping.mutate(Object.assign({},this.computedPropertyMapping.state,{[r]:[...e]})),s()}))})))),addQueryableProperties:this.action(((e,t)=>new Promise(((s,i)=>{const r=e.toString(),a=this.queryablePropertiesService.addQueryableProperties(t,r);if(!a)throw new Error(`RemoveQueryableProperties must be regist as implementation of ${r} `);return a.then((()=>{let e;if(this.computedPropertyMapping.state[r]){e=[...this.computedPropertyMapping.state[r].filter((e=>!t.some((t=>t.enterprisePropertyId===e.enterprisePropertyId)))),...t]}else e=[...t];this.computedPropertyMapping.mutate(Object.assign({},this.computedPropertyMapping.state,{[r]:e})),s()}))}))))}}ensureUniqueMultilingualTitle(){const e={},t=this.enterprisePropertyDefinitions.state;for(const s of t)if(s.uniqueMultilingualTitle=s.multilingualTitle,void 0===e[s.multilingualTitle.toLowerCase()])e[s.multilingualTitle.toLowerCase()]=s;else if(null===e[s.multilingualTitle.toLowerCase()])s.uniqueMultilingualTitle=s.multilingualTitle+` (${s.internalName})`;else{const t=e[s.multilingualTitle.toLowerCase()];t.uniqueMultilingualTitle=t.multilingualTitle+` (${t.internalName})`,s.uniqueMultilingualTitle=s.multilingualTitle+` (${s.internalName})`,e[s.multilingualTitle.toLowerCase()]=null}this.enterprisePropertyDefinitions.mutate(t)}onActivated(){}onDisposing(){}};U([(0,n.Inject)(P)],R.prototype,"enterprisePropertyService",2),U([(0,n.Inject)(g.LocalizationService)],R.prototype,"localizationService",2),U([(0,n.Inject)(j)],R.prototype,"multilingualTextsStore",2),U([(0,n.Inject)(_.QueryablePropertiesService)],R.prototype,"queryablePropertiesService",2),U([(0,n.Inject)(o.OmniaContext)],R.prototype,"omniaContext",2),R=U([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],R);var D=Object.defineProperty,E=Object.getOwnPropertyDescriptor,B=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?E(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&D(t,s,a),a};let k=class extends i.Store{constructor(){super(...arguments),this.likes=this.state({}),this.comments=this.state({}),this.getters={likes:(e,t)=>{let s=this.likes.state[e];return s&&(s=s.filter((e=>e.commentId==t)),s.sort(((e,t)=>{if(e.modifiedAt&&t.modifiedAt){const s=new Date(e.modifiedAt),i=new Date(t.modifiedAt);return s.getTime()<i.getTime()?1:-1}return(e.createdByUser?e.createdByUser.displayName:e.createdBy)>(t.createdByUser?t.createdByUser.displayName:t.createdBy)?1:-1}))),s},topComments:e=>{let t=this.comments.state[e];return t&&(t=t.filter((e=>!e.parentId))),t},repliedComments:(e,t)=>{let s=this.comments.state[e];return s&&(s=s.filter((e=>e.parentId===t))),s},comment:(e,t)=>{const s=this.comments.state[e];return s?s.filter((e=>e.id==t))[0]:null},comments:e=>this.comments.state[e]},this.mutations={},this.actions={toggleLike:this.action(((e,t,s,i,r)=>{let a=this.likes.state[t.toLowerCase()];return a=a.filter((e=>e.commentId!=s||e.createdBy.toLowerCase()!=r.uid.toLowerCase())),i?this.likes.mutate(Object.assign({},this.likes.state,{[t]:[...a,{commentId:s,topicId:t,createdBy:r.uid,createdByUser:r}]})):this.likes.mutate(Object.assign({},this.likes.state,{[t]:a})),new Promise(((r,a)=>{r(null),e.toggleLike(t,s,i).then((()=>{})).catch((()=>{console.log("toggle like failed")}))}))})),addOrUpdateComment:this.action(((e,t)=>{if(t.id){const s=this.comments.state[t.topicId].filter((e=>e.id!==t.id));return this.comments.mutate(Object.assign({},this.comments.state,{[t.topicId]:[...s,t]})),e.updateComment(t).then((e=>(e.createdByUser=t.createdByUser,e.structureParentId=t.structureParentId,Promise.resolve(e))))}return t.createdAt=(new Date).toISOString(),this.comments.mutate(Object.assign({},this.comments.state,{[t.topicId]:[...this.comments.state[t.topicId],t]})),e.addComment(t).then((e=>(t.id=e.id,t={...t},Promise.resolve(e))))})),deleteComment:this.action(((e,t,s)=>e.deleteComment(t).then((()=>{const e=this.comments.state[t.topicId].filter((e=>e.id===t.id))[0];if(e){e.deletedBy=s.uid,e.deletedByUser=s;const i=this.comments.state[t.topicId].filter((e=>e.id!==t.id));this.comments.mutate(Object.assign({},this.comments.state,{[t.topicId]:[...i,e]}))}return Promise.resolve(null)})))),toggleBestReply:this.action(((e,t,s,i)=>e.markBestReply(t,s).then((()=>{const e=this.comments.state[t].filter((e=>e.id===s))[0],i=this.comments.state[t].filter((e=>e.bestReply))[0],r=[];e.bestReply=!e.bestReply,r.push(e),i&&i.id!==e.id&&e.bestReply&&(i.bestReply=!1,r.push(i));const a=this.comments.state[t].filter((e=>!r.some((t=>t.id===e.id))));return this.comments.mutate(Object.assign({},this.comments.state,{[t]:[...a,...r]})),Promise.resolve(null)})))),loadData:this.action(((e,t)=>new Promise(((s,i)=>{e.getCommentLike(t).then((e=>{const r=e.comments,a=e.likes,n={},o={};r.forEach((e=>n[e.id]=e.parentId));for(const e in n)if(!o[e]){const t=[];let s=e;for(;n[s];)t.push(s),s=n[s];t.forEach((e=>o[e]=s))}const c=r.map((e=>e.createdBy)).concat(a.map((e=>e.createdBy)));this.userService.resolveUsersByPrincipalNames(c).then((e=>{const i={};e.forEach((e=>i[e.uid.toLowerCase()]=e)),r.forEach((e=>{e.structureParentId=o[e.id],e.createdByUser=i[e.createdBy.toLowerCase()],e.deletedByUser=e.deletedBy?i[e.deletedBy.toLowerCase()]:null})),a.forEach((e=>{e.createdByUser=i[e.createdBy.toLowerCase()]})),this.comments.mutate(Object.assign({},this.comments.state,{[t]:r})),this.likes.mutate(Object.assign({},this.likes.state,{[t]:a})),s(null)})).catch(i)})).catch(i)}))))}}onActivated(){}onDisposing(){}};B([(0,n.Inject)(v.AzureAdService)],k.prototype,"userService",2),k=B([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],k);var $=s("./client/fx/services/siteservice.js"),H=Object.defineProperty,F=Object.getOwnPropertyDescriptor,G=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?F(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&H(t,s,a),a};let N=class extends i.Store{constructor(){super(...arguments),this.ensuredLoadSiteLogo={},this.siteLogos=this.state({}),this.getters={siteLogo:e=>(e=e.toLowerCase(),this.siteLogos.state[e])},this.mutations={},this.actions={ensureLoadSiteLogo:this.action((e=>(e=e.toLowerCase(),this.ensuredLoadSiteLogo[e]||(this.ensuredLoadSiteLogo[e]=this.siteService.getSiteLogo([e]).then((e=>{if(e){const t=Object.assign({},this.siteLogos.state);e.forEach((e=>{t[e.siteUrl.toLowerCase()]=e})),this.siteLogos.mutate(t)}}))),this.ensuredLoadSiteLogo[e])))}}onActivated(){}onDisposing(){}};G([(0,n.Inject)($.SiteService)],N.prototype,"siteService",2),N=G([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],N);var z=s("./client/fx/services/targetingpropertyservice.js"),W=Object.defineProperty,K=Object.getOwnPropertyDescriptor,q=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?K(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&W(t,s,a),a};let V=class extends i.Store{constructor(){super(...arguments),this.ensuredLoadDataPromise=null,this.ensuredUserTargetingResultPromise=null,this.targetingProperties=this.state([]),this.targetingPropertyResult=this.state({}),this.getters={properties:()=>this.targetingProperties.state,propertiesForEnterpriseProperty:e=>this.targetingProperties.state.filter((t=>t.enterprisePropertyDefinitionId==e)),property:e=>this.targetingProperties.state.filter((t=>t.id==e))[0],userTargetingResult:e=>{const t=[];for(const s of e){const e=this.targetingPropertyResult.state[s.enterprisePropertyDefinitionId.toString()];if(null!=e){let i=[];if(null!=e.values){let t=[];if(null!=s.targetingPropertyIds?s.targetingPropertyIds.forEach((s=>{e.targetingPropertyValues[s.toString()]&&e.targetingPropertyValues[s.toString()].forEach((e=>{null==t.find((t=>t.id===e.id))&&t.push(e)}))})):t=n.Utils.clone(e.values),s.includeChildTerms)for(const e of t){let t=e;for(;null!=t;)i.push(t.id),t=t.parent}else i=t.map((e=>e.id))}t.push({values:i,enterprisePropertyDefinitionId:e.enterprisePropertyDefinitionId,internalName:e.internalName,includeChildTerms:s.includeChildTerms,languages:e.languages})}}return t}},this.mutations={},this.actions={ensureLoadData:this.action((()=>(this.ensuredLoadDataPromise||(this.ensuredLoadDataPromise=this.targetingPropertyService.getTargetingProperties().then((e=>(this.targetingProperties.mutate(e),!0))).catch((()=>(this.ensuredLoadDataPromise=null,!1)))),this.ensuredLoadDataPromise))),addTargetingProperty:this.action((e=>this.targetingPropertyService.createTargetingProperty(e).then((e=>(this.targetingProperties.mutate((t=>t.state=[...t.state.filter((t=>t.id!=e.id)),e])),e))))),updateTargetingProperty:this.action((e=>this.targetingPropertyService.updateTargetingProperty(e).then((e=>(this.targetingProperties.mutate((t=>t.state=[...t.state.filter((t=>t.id!=e.id)),e])),e))))),removeTargetingProperty:this.action((e=>this.targetingPropertyService.removeTargetingProperty(e).then((()=>(this.targetingProperties.mutate((t=>t.state=t.state.filter((t=>t.id!=e)))),!0))))),ensureUserTargetingResult:this.action((()=>(this.ensuredUserTargetingResultPromise||(this.ensuredUserTargetingResultPromise=this.targetingPropertyService.getTargetingPropertyResult().then((e=>{const t={};for(const s of e)t[s.enterprisePropertyDefinitionId.toString()]=s;return this.targetingPropertyResult.mutate(t),!0})).catch((()=>(this.ensuredUserTargetingResultPromise=null,!1)))),this.ensuredUserTargetingResultPromise))),terminateTargetingProperty:this.action((e=>this.targetingPropertyService.terminateTargetingProperty(e).then((()=>!0)))),restoreTargetingProperty:this.action((e=>this.targetingPropertyService.restoreTargetingProperty(e).then((e=>(this.targetingProperties.mutate((t=>t.state=[...t.state.filter((t=>t.id!=e.id)),e])),e)))))}}onActivated(){}onDisposing(){}};q([(0,n.Inject)(z.TargetingPropertyService)],V.prototype,"targetingPropertyService",2),V=q([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],V);var J=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,Z=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Q(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&J(t,s,a),a};let Y=class extends i.Store{constructor(){super(...arguments),this.resolvedUserGroupData=this.state({users:[],groups:[]}),this.cachedKey="omnia.fx.azureadstore.resolvedusergroup",this.resolvedIdsFromCached=!1,this.getters={resolvedUserGroup:e=>{if(!this.resolvedIdsFromCached){this.resolvedIdsFromCached=!0;const e=n.LocalStorage.get(this.cachedKey);e&&e.length>0&&this.actions.ensureUsersByUIDs.dispatch(e)}const t={users:[],groups:[]};return e!==r.AzureAdObjectPrincipalTypes.Group&&(t.users=n.Utils.clone(this.resolvedUserGroupData.state.users)),e!==r.AzureAdObjectPrincipalTypes.Member&&e!==r.AzureAdObjectPrincipalTypes.MemberAndGuest&&(t.groups=n.Utils.clone(this.resolvedUserGroupData.state.groups)),t}},this.actions={ensureUsersByPrincipalNames:this.action((e=>this.azureAdService.resolveUsersByPrincipalNames(e).then((e=>{const t=e;return this.updateResolvedUserGroup(t),e})))),ensureUsersByUIDs:this.action((e=>this.azureAdService.resolveUsersByUIDs(e).then((e=>(this.updateResolvedUserGroup(e.users,e.groups),e))))),searchUsers:this.action(((e,t,s)=>this.azureAdService.searchUsers(e,t,s)))},this.updateResolvedUserGroup=(e,t)=>{let s=!1,i=this.resolvedUserGroupData.state.users,r=this.resolvedUserGroupData.state.groups;if(e){const t=e.filter((e=>void 0===i.find((t=>t.uid===e.uid))));t&&t.length>0&&(i=i.concat(t).sort(((e,t)=>e.displayName>t.displayName?1:-1)),s=!0)}if(t){const e=t.filter((e=>void 0===r.find((t=>t.uid===e.uid))));e&&e.length>0&&(r=r.concat(e).sort(((e,t)=>e.displayName>t.displayName?1:-1)),s=!0)}if(s){let e=[];e=r.map((e=>e.uid)),e.length>25&&(e=e.slice(0,24)),e=e.concat(i.map((e=>e.uid))),e.length>50&&(e=e.slice(0,50)),n.LocalStorage.set(this.cachedKey,e),this.resolvedUserGroupData.mutate({users:i,groups:r})}}}onActivated(){}onDisposing(){}};Z([(0,n.Inject)(v.AzureAdService)],Y.prototype,"azureAdService",2),Z([(0,n.Inject)(b.UserService)],Y.prototype,"userService",2),Y=Z([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],Y);var X=Object.defineProperty,ee=Object.getOwnPropertyDescriptor,te=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ee(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&X(t,s,a),a};let se=class extends i.Store{constructor(){super(...arguments),this.ensureDataPromise=null,this.enterprisePropertiesByInternalName={},this.getters={targetingToUser:(e,t=!0)=>{const s=[];if(Object.keys(e).forEach((t=>{const i=e[t],a=this.enterprisePropertiesByInternalName[t];a&&i&&(a.enterprisePropertyDataType.indexedType==r.PropertyIndexedType.Language&&i.languages&&i.languages.length>0||a.enterprisePropertyDataType.indexedType==r.PropertyIndexedType.Taxonomy&&i.termIds&&i.termIds.length>0)&&s.push({enterprisePropertyDefinitionId:a.id,includeChildTerms:i.includeChildTerms,targetingPropertyIds:i.targetingPropertyIds})})),s.length>0){const i=this.targetingPropertyStore.getters.userTargetingResult(s);return!(!t&&0==i.length)&&i.every((t=>{if(null==t)return!1;let s=!0;const i=e[t.internalName],a=this.enterprisePropertiesByInternalName[t.internalName];return a&&i&&(a.enterprisePropertyDataType.indexedType==r.PropertyIndexedType.Language?s=s&&t.languages&&i.languages.some((e=>t.languages.indexOf(e)>=0)):a.enterprisePropertyDataType.indexedType==r.PropertyIndexedType.Taxonomy&&(s=s&&i.termIds.some((e=>t.values.indexOf(e)>=0)))),s}))?r.TargetUser.Target:r.TargetUser.NotTarget}return r.TargetUser.Target}},this.actions={ensureData:this.action((()=>(this.ensureDataPromise||(this.ensureDataPromise=Promise.all([this.targetingPropertyStore.actions.ensureUserTargetingResult.dispatch(),this.enterprisePropertyStore.actions.ensureLoadData.dispatch().then((()=>{this.buildEnterpriseProperties()}))]).then((()=>null))),this.ensureDataPromise)))}}onActivated(){}onDisposing(){}buildEnterpriseProperties(){this.enterprisePropertyStore.getters.enterprisePropertyDefinitions().filter((e=>e.enterprisePropertyDataType.indexedType==r.PropertyIndexedType.Taxonomy||e.enterprisePropertyDataType.indexedType==r.PropertyIndexedType.Language)).forEach((e=>{this.enterprisePropertiesByInternalName[e.internalName]=e}))}};te([(0,n.Inject)(R)],se.prototype,"enterprisePropertyStore",2),te([(0,n.Inject)(V)],se.prototype,"targetingPropertyStore",2),se=te([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],se);var ie=s("./client/fx/stores/localizationstore.js"),re=s("./client/fx/services/businessprofileservice.js"),ae=s("10407664-c0c5-438b-94b2-507d58d190af"),ne=Object.defineProperty,oe=Object.getOwnPropertyDescriptor,ce=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?oe(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&ne(t,s,a),a};let pe=class extends i.Store{constructor(){super(...arguments),this.allProfiles=this.state([]),this.profileProperties=this.state({}),this.businessProfile=null,this.ensureAllProfilesPromise=null,this.ensureProfilesWithPropertiesPromises={},this.ensureProfilesPromises={},this.getters={profiles:()=>this.allProfiles.state,profile:e=>(e=e.toLowerCase(),this.allProfiles.state.filter((t=>t.id.toString().toLowerCase()==e))[0]),profileWithProperties:e=>{e=e.toLowerCase();let t=this.allProfiles.state.filter((t=>t.id.toString().toLowerCase()==e))[0];if(t){const s=this.profileProperties.state[e]||[];t=Object.assign({},t,{properties:s})}return t}},this.mutations={removeProfiles:this.mutation(((...e)=>{e=e.map((e=>e.toLowerCase())),this.allProfiles.mutate((t=>{t.state=t.state.filter((t=>e.indexOf(t.id.toString().toLowerCase())<0))}))})),addOrUpdateProfiles:this.mutation((e=>{const t=e.map((e=>e.id.toString().toLowerCase()));this.allProfiles.mutate((s=>{s.state=s.state.filter((e=>t.indexOf(e.id.toString().toLowerCase())<0)),s.state=s.state.concat(e)}))})),addOrUpdateProfilesWithProperties:this.mutation((e=>{const t=e.map((e=>({id:e.id,name:e.name})));this.profileProperties.mutate((t=>{e.forEach((e=>{t.state[e.id.toString().toLowerCase()]=e.properties}))})),this.mutations.addOrUpdateProfiles.commit(t)}))},this.actions={createProfile:this.action((e=>new Promise(((t,s)=>{this.profileService.createProfile(e).then((e=>{this.mutations.addOrUpdateProfiles.commit([e]),t(e)}))})))),updateProfile:this.action(((e,t)=>this.profileService.updateProfile(e,t).then((t=>(this.mutations.addOrUpdateProfiles.commit([t]),this.publishBusinessProfileUpdateIfNeeded(e)))))),deleteProfile:this.action((e=>this.profileService.deleteProfile(e).then((()=>(this.mutations.removeProfiles.commit(e),this.publishBusinessProfileUpdateIfNeeded(e,!0)))))),ensureAllProfiles:this.action((e=>(!e&&this.ensureAllProfilesPromise||(this.ensureAllProfilesPromise=this.profileService.getProfiles().then((e=>(this.mutations.addOrUpdateProfiles.commit(e),null)))),this.ensureAllProfilesPromise))),ensureProfile:this.action(((e,t)=>(e=e.toLowerCase(),!t&&this.ensureProfilesWithPropertiesPromises[e]?this.ensureProfilesWithPropertiesPromises[e]:(!t&&this.ensureProfilesPromises[e]||(this.ensureProfilesPromises[e]=this.profileService.getProfile(e).then((e=>(e&&this.mutations.addOrUpdateProfiles.commit([e]),null)))),this.ensureProfilesPromises[e])))),ensureProfileWithProperties:this.action(((e,t)=>(e=e.toLowerCase(),!t&&this.ensureProfilesWithPropertiesPromises[e]||(this.ensureProfilesWithPropertiesPromises[e]=this.profileService.getProfileWithProperties(e).then((e=>(this.mutations.addOrUpdateProfilesWithProperties.commit([e]),null)))),this.ensureProfilesWithPropertiesPromises[e])))}}onActivated(){this.businessProfile=this.omniaContext.businessProfile,this.subscriptionHandler.add(this.omniaContext.onContextChanged().subscribe((e=>{this.businessProfile=e.businessProfile})))}onDisposing(){this.subscriptionHandler.unsubscribe()}publishBusinessProfileUpdateIfNeeded(e,t){return this.businessProfile&&this.businessProfile.id&&this.businessProfile.id.toString().toLowerCase()==e.toLowerCase()?t?(ae.InternalTopics.businessProfileUpdate.publish(null),Promise.resolve(null)):this.actions.ensureProfileWithProperties.dispatch(e,!0).then((()=>{const t=this.getters.profileWithProperties(e);return ae.InternalTopics.businessProfileUpdate.publish(t),null})):Promise.resolve(null)}};ce([(0,n.Inject)(re.BusinessProfileService)],pe.prototype,"profileService",2),ce([(0,n.Inject)(o.OmniaContext)],pe.prototype,"omniaContext",2),ce([(0,n.Inject)(n.SubscriptionHandler)],pe.prototype,"subscriptionHandler",2),pe=ce([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],pe);var le=s("./client/fx/services/enterprisepropertysetservice.js"),de=Object.defineProperty,he=Object.getOwnPropertyDescriptor,ue=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?he(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&de(t,s,a),a};let ge=class extends i.Store{constructor(){super(...arguments),this.ensuredLoadSetsPromise=null,this.enterprisePropertySets=this.state([]),this.getters={enterprisePropertySets:()=>this.enterprisePropertySets.state,enterprisePropertySetsGroupByCategory:()=>this.getters.enterprisePropertySets().reduce(((e,t)=>{const s=t.enterprisePropertyCategoryId?t.enterprisePropertyCategoryId.toString():r.Constants.enterprisepropertycategories.defaultCategoryId.toString();return e[s]=e[s]||[],e[s].push(t),e}),Object.create(null))},this.mutations={updateEnterprisePropertySets:this.mutation((()=>{}))},this.actions={ensureLoadAllSets:this.action((()=>(this.ensuredLoadSetsPromise||(this.ensuredLoadSetsPromise=this.enterprisePropertySetService.getEnterprisePropertySets().then((e=>(this.addOrUpdateSets(e),null)))),this.ensuredLoadSetsPromise))),addEnterprisePropertySet:this.action((e=>this.enterprisePropertySetService.createEnterprisePropertySet(e).then((e=>(this.addOrUpdateSets([e]),null))))),updateEnterprisePropertySet:this.action((e=>this.enterprisePropertySetService.updateEnterprisePropertySet(e).then((e=>(this.addOrUpdateSets([e]),null))))),removeEnterprisePropertySet:this.action((e=>this.enterprisePropertySetService.removeEnterprisePropertySet(e.id).then((()=>(this.addOrUpdateSets([e],!0),null))))),terminateEnterprisePropertySet:this.action((e=>this.enterprisePropertySetService.terminateEnterprisePropertySet(e).then((()=>null)))),restoreEnterprisePropertySet:this.action((e=>this.enterprisePropertySetService.restoreEnterprisePropertySet(e).then((e=>(this.addOrUpdateSets([e]),null)))))}}addOrUpdateSets(e,t){const s={};e.forEach((e=>s[e.id.toString()]=!0)),this.enterprisePropertySets.mutate((i=>{i.state=i.state.filter((e=>!s[e.id.toString()])),t||(e.forEach((e=>e.multilingualTitle=this.multilingualTextsStore.getters.stringValue(e.title))),i.state=i.state.concat(e),i.state.sort(((e,t)=>e.multilingualTitle>t.multilingualTitle?1:-1)))})),this.mutations.updateEnterprisePropertySets.commit()}onActivated(){}onDisposing(){}};ue([(0,n.Inject)(le.EnterprisePropertySetService)],ge.prototype,"enterprisePropertySetService",2),ue([(0,n.Inject)(j)],ge.prototype,"multilingualTextsStore",2),ge=ue([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],ge);var me=s("./client/fx/services/extensionsservice.js"),fe=Object.defineProperty,ye=Object.getOwnPropertyDescriptor,Pe=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ye(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&fe(t,s,a),a};let ve=class extends i.Store{constructor(){super(...arguments),this.ensureLoadDeployedExtensionsPromise=null,this.deployedExtensions=this.state([]),this.getters={deployedExtensions:()=>this.deployedExtensions.state},this.actions={ensureLoadDeployedExtensions:this.action((()=>(this.ensureLoadDeployedExtensionsPromise||(this.ensureLoadDeployedExtensionsPromise=this.extensionsService.getDeployed().then((e=>{const t=e.find((e=>"aa000000-0000-aaaa-0000-0000000000aa"==e.extensionId));return t&&(e=[t,...e.filter((e=>e!=t))]),this.deployedExtensions.mutate(e),null}))),this.ensureLoadDeployedExtensionsPromise)))}}onActivated(){}onDisposing(){}};Pe([(0,n.Inject)(me.ExtensionsService)],ve.prototype,"extensionsService",2),ve=Pe([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],ve);var be=s("./node_modules/dayjs/dayjs.min.js"),Se=s.n(be),Ie=Object.defineProperty,Ce=Object.getOwnPropertyDescriptor,we=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ce(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Ie(t,s,a),a};let xe=class extends i.Store{constructor(){super(...arguments),this.timezones=this.state(),this.currentUser=null,this.getters={currentUsertime:e=>{let t=Se().utc(e).local();if(!this.currentUser||this.currentUser.type!==r.UserTypes.AzureAdExternalUser&&this.currentUser.type!==r.UserTypes.AzureAdInternalUser)return Se().utc(e).local();const s=this.currentUser.mailboxSettings?.timeZone;if(!s)return Se().utc(e).local();const i=this.timezones.state.find((e=>e.windowZone===s||e.IANA===s));return i&&(t=Se().utc(e).tz(i.IANA)),t}}}onActivated(){this.timezones.mutate([...r.MapTimezones]),this.userStore.current.then((e=>{this.currentUser=e}))}onDisposing(){}};we([(0,n.Inject)(w)],xe.prototype,"userStore",2),xe=we([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],xe);we([(0,n.Inject)(xe)],class{},"store",2);var Te=s("./client/fx/services/auditlogservice.js"),Le=Object.defineProperty,Oe=Object.getOwnPropertyDescriptor,je=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Oe(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Le(t,s,a),a};let _e=class extends i.Store{constructor(){super(...arguments),this.auditLogs=this.state([]),this.auditLogSettings=this.state(null),this.loadAuditLogSettingsPromise=null,this.getters={auditLogs:()=>this.auditLogs.state,settings:()=>this.auditLogSettings.state},this.actions={ensureLoadSettings:this.action((()=>(this.loadAuditLogSettingsPromise||(this.loadAuditLogSettingsPromise=this.auditLogService.getAuditLogSettings().then((e=>(e||(e={enableLogging:!1}),this.auditLogSettings.mutate(e),null))).catch((()=>{this.loadAuditLogSettingsPromise=null}))),this.loadAuditLogSettingsPromise))),addOrUpdateSettings:this.action((e=>this.auditLogService.addOrUpdateAuditLogSettings(e).then((()=>(this.auditLogSettings.mutate(e),null))))),loadAuditLogs:this.action((e=>new Promise(((t,s)=>{this.auditLogService.getAuditLogs(e).then((s=>{this.auditLogs.mutate([]);const i=this.handleLoadedAuditLogResult(e,s);t(i)})).catch(s)})))),loadAuditLogsNextPage:this.action((e=>{if(null===e)throw new Error("nextPageToken can not be null for loadTopicActivitiesNextPage");return new Promise(((t,s)=>{e.sourceRequestedParams||s("Can't use nextPageToken not generated from call to loadAuditLogs on this store");const i=e;this.auditLogService.getAuditLogsNextPage(i.next).then((e=>{const s=this.handleLoadedAuditLogResult(i.sourceRequestedParams,e);t(s)})).catch(s)}))})),loadById:this.action((e=>new Promise(((t,s)=>{this.auditLogService.getById(e).then((e=>{t(e)})).catch(s)})))),loadCategory:this.action((()=>new Promise(((e,t)=>{this.auditLogService.getCategories().then((t=>{e(t)})).catch(t)}))))},this.handleLoadedAuditLogResult=(e,t)=>{this.auditLogs.mutate((e=>{t.result.forEach((t=>{e.state.push(t)}))}));let s=null;return t.nextToken&&(s={sourceRequestedParams:e,next:t.nextToken}),s}}onActivated(){}onDisposing(){}};je([(0,n.Inject)(Te.AuditLogService)],_e.prototype,"auditLogService",2),_e=je([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],_e);var Ae=s("./client/fx/services/enterprisepropertycategoryservice.js"),Me=Object.defineProperty,Ue=Object.getOwnPropertyDescriptor,Re=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ue(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Me(t,s,a),a};let De=class extends i.Store{constructor(){super(...arguments),this.ensuredLoadCategoriesPromise=null,this.enterprisePropertyCategories=this.state([]),this.getters={enterprisePropertyCategories:()=>this.enterprisePropertyCategories.state},this.mutations={updateEnterprisePropertyCategories:this.mutation((()=>{}))},this.actions={ensureLoadAllCategories:this.action((()=>(this.ensuredLoadCategoriesPromise||(this.ensuredLoadCategoriesPromise=new Promise(((e,t)=>{this.enterprisePropertyCategoryService.getEnterprisePropertyCategories().then((t=>{this.enterprisePropertyCategories.mutate(t),e()})).catch(t)}))),this.ensuredLoadCategoriesPromise))),addEnterprisePropertyCategory:this.action((e=>new Promise(((t,s)=>{this.enterprisePropertyCategoryService.createEnterprisePropertyCategory(e).then((e=>{this.enterprisePropertyCategories.mutate((t=>{t.state.findIndex((t=>t.id==e.id))<0&&t.state.push(n.Utils.clone(e))})),this.mutations.updateEnterprisePropertyCategories.commit(),t()})).catch(s)})))),updateEnterprisePropertyCategory:this.action((e=>new Promise(((t,s)=>{this.enterprisePropertyCategoryService.updateEnterprisePropertyCategory(e).then((e=>{this.enterprisePropertyCategories.mutate((t=>{const s=t.state.findIndex((t=>t.id==e.id));s>=0&&(t.state[s]=n.Utils.clone(e))})),this.mutations.updateEnterprisePropertyCategories.commit(),t()})).catch(s)})))),updateEnterprisePropertyCategoryOrders:this.action((e=>new Promise(((t,s)=>{this.enterprisePropertyCategoryService.updateEnterprisePropertyCategoryOrders(e).then((()=>{setTimeout((()=>{this.ensuredLoadCategoriesPromise=null,this.actions.ensureLoadAllCategories.dispatch().then((()=>{this.mutations.updateEnterprisePropertyCategories.commit(),t()})).catch(s)}),1e3)})).catch(s)})))),removeEnterprisePropertyCategory:this.action((e=>new Promise(((t,s)=>{this.enterprisePropertyCategoryService.removeEnterprisePropertyCategory(e.id).then((()=>{this.enterprisePropertyCategories.mutate((t=>t.state=t.state.filter((t=>t.id!=e.id)))),this.mutations.updateEnterprisePropertyCategories.commit(),t()})).catch(s)}))))}}onActivated(){}onDisposing(){}};Re([(0,n.Inject)(Ae.EnterprisePropertyCategoryService)],De.prototype,"enterprisePropertyCategoryService",2),De=Re([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],De);var Ee=Object.defineProperty,Be=Object.getOwnPropertyDescriptor;let ke=class extends i.Store{constructor(){super(...arguments),this.directionRule=this.state(r.DirectionRules.ltr),this.getters={getDirectionRule:()=>this.directionRule.state},this.mutations={setDirectionRule:e=>{this.directionRule.mutate(e)}}}onActivated(){}onDisposing(){super.onDisposing()}};ke=((e,t,s,i)=>{for(var r,a=i>1?void 0:i?Be(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Ee(t,s,a),a})([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],ke);var $e=Object.defineProperty,He=Object.getOwnPropertyDescriptor,Fe=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?He(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&$e(t,s,a),a};let Ge=class extends i.Store{constructor(){super(...arguments),this.globalBlockTitleSettings=this.state(null),this.currentBusinessProfile=null,this.loadingPromise=null,this.getters={globalSettings:()=>this.globalBlockTitleSettings.state},this.mutations={updateGlobal:e=>{this.globalBlockTitleSettings.mutate((t=>{t.state=e}))}},this.actions={saveGlobal:this.action((()=>new Promise(((e,t)=>{this.currentBusinessProfile.propertyBag.addOrUpdate(Object.assign(new r.BusinessProfileBlockTitleSettings,this.globalBlockTitleSettings.state)).then((t=>{e()})).catch((e=>{}))})))),load:this.action((()=>(this.isRightToLeft=this.directionRuleStore.getters.getDirectionRule()===r.DirectionRules.rtl,null===this.loadingPromise&&(this.loadingPromise=new Promise(((e,t)=>{const s=this.currentBusinessProfile.propertyBag.getModel(r.BusinessProfileBlockTitleSettings);if(s)s.iconSettings||(s.iconSettings=this.createIconTitleSettings()),this.globalBlockTitleSettings.mutate(s);else{const e=this.createBlockTitleSettings();this.globalBlockTitleSettings.mutate(e)}e()}))),this.loadingPromise)))}}onActivated(){this.currentBusinessProfile=this.omniaContext.businessProfile,this.subcribeHandle=this.omniaContext.onContextChanged().subscribe((e=>{this.currentBusinessProfile=e.businessProfile,this.globalBlockTitleSettings.mutate((e=>{e.state=null})),this.loadingPromise=null,this.actions.load.dispatch()}))}onDisposing(){this.subcribeHandle&&this.subcribeHandle.unsubscribe(),super.onDisposing()}createIconTitleSettings(){return{elevation:"0",size:r.IconSizes.Medium,position:r.IconPositions.Right,bgColor:"",iconColor:"#424242",borderWidth:"0",borderColor:"",icon:void 0,spacing:null}}createBlockTitleSettings(){return{bgColor:"",fontSize:20,paddingBottom:30,paddingLeft:20,paddingRight:20,paddingTop:30,separatorColor:"",separatorSize:0,textAlign:this.isRightToLeft?r.TextAlignment.right:r.TextAlignment.left,borderRadius:0,followTheming:!1,separatorPosition:r.BorderPositions.bottom,textColor:"",iconSettings:this.createIconTitleSettings(),shapeDivider:null}}};Fe([(0,n.Inject)(o.OmniaContext)],Ge.prototype,"omniaContext",2),Fe([(0,n.Inject)(ke)],Ge.prototype,"directionRuleStore",2),Ge=Fe([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)},onDisposing:e=>e.onDisposing()})],Ge);var Ne=Object.defineProperty,ze=Object.getOwnPropertyDescriptor,We=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ze(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Ne(t,s,a),a};let Ke=class extends i.Store{constructor(){super(...arguments),this.layoutBlockTitleSettingsId=this.state(null),this.titleSettings=this.state({}),this.loadingPromise=null,this.getters={globalSettings:()=>this.blockTitleGlobalSettingsStore.getters.globalSettings(),layoutSettings:()=>this.layoutBlockTitleSettingsId.state&&this.titleSettings.state[this.layoutBlockTitleSettingsId.state]&&this.titleSettings.state[this.layoutBlockTitleSettingsId.state].customSettings?this.titleSettings.state[this.layoutBlockTitleSettingsId.state].blockTitleSettings:null,inheritedLayoutSettings:()=>this.getters.layoutSettings()?this.getters.layoutSettings():this.getters.globalSettings(),componentSettings:e=>{let t=this.titleSettings.state[e];return t&&t.blockTitleSettings||(this.titleSettings.mutate((t=>{t.state[e]={key:e,blockTitleSettings:this.getters.inheritedLayoutSettings(),icon:void 0,customSettings:!1}})),t=this.titleSettings.state[e]),t}},this.mutations={setLayoutInheritageToGlobalSettings:()=>{this.layoutBlockTitleSettingsId.mutate((e=>{e.state=null})),this.titleSettings.mutate((e=>{for(const t in e.state)e.state[t].customSettings||(e.state[t].blockTitleSettings=this.getters.globalSettings())}))},setLayoutInheritageToCurrentLayoutSettings:()=>{this.titleSettings.mutate((e=>{for(const t in e.state)e.state[t].customSettings||(e.state[t].blockTitleSettings=this.getters.layoutSettings())}))},setLayoutSettings:(e,t)=>{this.layoutBlockTitleSettingsId.state!==e&&this.layoutBlockTitleSettingsId.mutate((t=>{t.state=e})),this.mutations.setComponentSettings(e,t),this.mutations.setLayoutInheritageToCurrentLayoutSettings()},setLayoutInheritage:e=>{e===this.layoutBlockTitleSettingsId.state&&(this.titleSettings.state[e].customSettings?this.mutations.setLayoutInheritageToCurrentLayoutSettings():this.mutations.setLayoutInheritageToGlobalSettings())},setComponentIcon:(e,t)=>{this.titleSettings.mutate((s=>{s.state[e].icon=t}))},removeComponentIcon:e=>{this.titleSettings.mutate((t=>{t.state[e].icon=void 0}))},setComponentSettings:(e,t,s)=>{this.titleSettings.mutate((i=>{let r=!1;if(t?(t.paddingTop=t.paddingTop?t.paddingTop:0,t.paddingRight=t.paddingRight?t.paddingRight:0,t.paddingBottom=t.paddingBottom?t.paddingBottom:0,t.paddingLeft=t.paddingLeft?t.paddingLeft:0,t=Object.assign(this.blockTitleGlobalSettingsStore.createBlockTitleSettings(),t),r=!0):t=this.getters.inheritedLayoutSettings(),i.state[e]){if(s&&(i.state[e].icon=s),JSON.stringify(t)===JSON.stringify(i.state[e].blockTitleSettings))return;i.state[e].blockTitleSettings=t,i.state[e].customSettings=r}else i.state[e]={key:e,blockTitleSettings:t,icon:s,customSettings:r};this.mutations.setLayoutInheritage(e)}))},revertComponentToGlobalSettings:e=>{this.titleSettings.mutate((t=>{t.state[e].customSettings=!1,e!==this.layoutBlockTitleSettingsId.state&&(t.state[e].blockTitleSettings=this.getters.inheritedLayoutSettings())})),this.mutations.setLayoutInheritage(e)}},this.actions={load:this.action((()=>(null===this.loadingPromise&&(this.loadingPromise=new Promise(((e,t)=>{this.blockTitleGlobalSettingsStore.actions.load.dispatch().then((()=>{e()}))}))),this.loadingPromise)))}}onActivated(){}onDisposing(){this.subcribeHandle&&this.subcribeHandle.unsubscribe(),super.onDisposing()}};We([(0,n.Inject)(Ge)],Ke.prototype,"blockTitleGlobalSettingsStore",2),We([(0,n.Inject)(ke)],Ke.prototype,"directionStore",2),Ke=We([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Scoped)},onDisposing:e=>e.onDisposing()})],Ke);var qe=Object.defineProperty,Ve=Object.getOwnPropertyDescriptor,Je=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ve(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&qe(t,s,a),a};let Qe=class{constructor(){this.baseUrl="api/transactionlogs",this.getRegions=()=>new Promise(((e,t)=>{this.httpClient.get(this.baseUrl+"/getregions").then((s=>{200==s.status?s.data.success?e(s.data.data):t(s.data.errorMessage):t(s.statusText)})).catch(t)})),this.getTransactionLogsByFilter=e=>new Promise(((t,s)=>{this.httpClient.post(this.baseUrl+"/gettransactionlogsbyfilter",e).then((e=>{200==e.status?e.data.success?t(e.data.data):s(e.data.errorMessage):s(e.statusText)})).catch(s)}))}};Je([(0,n.Inject)(n.HttpClient,{configPromise:n.HttpClient.createOmniaServiceRequestConfig()})],Qe.prototype,"httpClient",2),Qe=Je([(0,n.Injectable)({lifetime:r.InstanceLifetimes.Transient})],Qe);var Ze=Object.defineProperty,Ye=Object.getOwnPropertyDescriptor,Xe=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ye(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Ze(t,s,a),a};let et=class extends i.Store{constructor(){super(...arguments),this.transactionLogs=this.state([]),this.providers={},this.isHaveNextPage=this.state(!1),this.getters={transactionLogs:()=>this.transactionLogs.state,isHaveNextPage:()=>this.isHaveNextPage.state},this.actions={getRegions:this.action((()=>new Promise(((e,t)=>{this.systemLogService.getRegions().then((t=>{e(t)})).catch(t)})))),getTransactionByFilterLogs:this.action((e=>new Promise(((t,s)=>{e.pageSize=e.pageSize+1,this.systemLogService.getTransactionLogsByFilter(e).then((s=>{1==e.curentPage&&this.transactionLogs.mutate([]),this.handleLoadedSystemLogResult(e,s),t(!0)})).catch(s)})))),getTemplateToRender:e=>this.providers?this.providers[e]:null},this.handleLoadedSystemLogResult=(e,t)=>{t.length>e.pageSize-1?(t=t.slice(0,t.length-1),this.isHaveNextPage.mutate(!0)):this.isHaveNextPage.mutate(!1),this.transactionLogs.mutate((e=>{t.forEach((t=>{e.state.push(t)}))}))},this.registerLogProvider=e=>{this.onNewProviderMessages(e)},this.onNewProviderMessages=e=>{this.providers[e.region]=e}}onActivated(){}onDisposing(){}};Xe([(0,n.Inject)(Qe)],et.prototype,"systemLogService",2),et=Xe([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],et);var tt=s("./client/fx/services/mediapickerservice.js"),st=Object.defineProperty,it=Object.getOwnPropertyDescriptor,rt=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?it(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&st(t,s,a),a};let at=class extends i.Store{constructor(){super(...arguments),this.imageRatios=this.state(),this.imageScalings=this.state(),this.mediapickerProviders=this.state([]),this.providerHooks=[],this.ensuredLoadImageRatiosPromise=null,this.ensuredLoadImageScalingsPromise=null,this.getters={imageRatios:()=>this.imageRatios.state,imageRatioByUniqueId:e=>{let t=null;return this.imageRatios.state&&(t=this.imageRatios.state.find((t=>t.uniqueId==e))),t},rollupRatios:()=>{let e=[];return this.imageRatios.state&&(e=this.imageRatios.state.filter((e=>e.enableInRollup))),e},imageScalings:()=>this.imageScalings.state,imageScalingByUniqueId:e=>{let t=null;return this.imageScalings.state&&(t=this.imageScalings.state.find((t=>t.uniqueId==e))),t},mediapickerProviders:()=>{let e=this.mediapickerProviders.state;return e=e.sort(((e,t)=>(null!=e.sortOrder&&null!=e.sortOrder?e.sortOrder:Number.MAX_SAFE_INTEGER)-(null!=t.sortOrder&&null!=t.sortOrder?t.sortOrder:Number.MAX_SAFE_INTEGER))),this.providerHooks.forEach((t=>{e=t(e)})),e},url:(e,t)=>{let s="";if(e.omniaMediaType==r.MediaPickerEnums.OmniaMediaTypes.Video)s=e.thumbnailUrl,s&&s.match(/https:\/\/img\.youtube\.com\/vi\/(.)+\/maxresdefault\.jpg/gm)&&(s=s.replace("/maxresdefault.jpg","/hqdefault.jpg"));else if(t){const i=this.getters.imageRatios()?.find((e=>e.uniqueId==t));s=this.mediaPickerService.getImageUrl(e,i?.id)}else s=this.mediaPickerService.getImageUrl(e);return s}},this.mutations={registerMediaPickerProvider:this.mutation((e=>{this.mediapickerProviders.mutate((t=>{t.state||(t.state=[]);let s=[];n.Utils.isArray(e)?s=e:s.push(e),s.forEach((e=>{if(e.id){t.state.find((t=>t.id==e.id))||t.state.push(e)}}))}))})),registerMediaPickerConfigurationHook:this.mutation((e=>{this.providerHooks.push(e)}))},this.actions={ensureImageScalings:this.action((()=>(this.ensuredLoadImageScalingsPromise||(this.ensuredLoadImageScalingsPromise=new Promise(((e,t)=>{this.mediaPickerService.getAllImageScalings().then((t=>{this.imageScalings.mutate(t),e()})).catch(t)}))),this.ensuredLoadImageScalingsPromise))),addImageScaling:this.action((e=>new Promise(((t,s)=>{this.imageScalings.state.find((t=>t.uniqueId==e.uniqueId))?s():this.mediaPickerService.addImageScaling(e).then((e=>{this.imageScalings.mutate((t=>{t.state.push(e)})),t()})).catch(s)})))),updateImageScaling:this.action(((e,t)=>new Promise(((s,i)=>{this.imageScalings.state.find((t=>t.id==e.id))?this.mediaPickerService.updateImageScaling(e,t).then((t=>{this.imageScalings.mutate((s=>{const i=s.state.findIndex((t=>t.id==e.id));s.state.splice(i,1,t)})),s()})).catch(i):i()})))),deleteImageScaling:this.action((e=>new Promise(((t,s)=>{this.imageScalings.state.find((t=>t.id==e.id))?this.mediaPickerService.deleteImageScaling(e).then((()=>{this.imageScalings.mutate((t=>{t.state=t.state.filter((t=>t.id!=e.id))})),t()})).catch(s):s()})))),ensureImageRatios:this.action((()=>(this.ensuredLoadImageRatiosPromise||(this.ensuredLoadImageRatiosPromise=new Promise(((e,t)=>{this.mediaPickerService.getAllImageRatios().then((t=>{this.imageRatios.mutate(t),e()})).catch(t)}))),this.ensuredLoadImageRatiosPromise))),addImageRatio:this.action((e=>new Promise(((t,s)=>{this.imageRatios.state.find((t=>t.uniqueId==e.uniqueId))?s():this.mediaPickerService.addImageRatio(e).then((e=>{this.imageRatios.mutate((t=>{t.state.push(e)})),t()})).catch(s)})))),updateImageRatio:this.action(((e,t,s)=>new Promise(((i,r)=>{this.imageRatios.state.find((t=>t.id==e.id))?this.mediaPickerService.updateImageRatio(e,t,s).then((t=>{this.imageRatios.mutate((s=>{const i=s.state.findIndex((t=>t.id==e.id));s.state.splice(i,1,t)})),i()})).catch(r):r()})))),deleteImageRatio:this.action((e=>new Promise(((t,s)=>{this.imageRatios.state.find((t=>t.id==e.id))?this.mediaPickerService.deleteImageRatio(e).then((()=>{this.imageRatios.mutate((t=>{t.state=t.state.filter((t=>t.id!=e.id))}))})).catch(s):s()}))))}}onActivated(){}onDisposing(){}};rt([(0,n.Inject)(tt.MediaPickerService)],at.prototype,"mediaPickerService",2),at=rt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],at);var nt=s("./client/fx/services/organizationtreeservice.js"),ot=Object.defineProperty,ct=Object.getOwnPropertyDescriptor,pt=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ct(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&ot(t,s,a),a};let lt=class extends i.Store{constructor(){super(...arguments),this.orgTree=this.state({}),this.getters={getOrgTreeByUser:e=>null===this.orgTree.state[e]?null:this.orgTree.state[e]},this.mutations={},this.actions={loadOrgTreeByUserName:this.action((e=>new Promise(((t,s)=>{if(this.orgTree.state[e])t(this.orgTree.state[e]);else{const i=s=>{this.orgTree.mutate(Object.assign({},this.orgTree.state,{[e]:s})),t(this.orgTree.state[e])};this.organizationTreeService.getOrgTreeByUserName(e).then(i).catch((e=>{s(e)}))}})))),loadOrgTreeByUser:this.action((e=>new Promise(((t,s)=>{if(this.orgTree.state[e.userPrincipalName])t(this.orgTree.state[e.userPrincipalName]);else{const i=s=>{this.orgTree.mutate(Object.assign({},this.orgTree.state,{[e.userPrincipalName]:s})),t(this.orgTree.state[e.userPrincipalName])};this.organizationTreeService.getOrgTreeByUser(e).then(i).catch((e=>{s(e)}))}}))))}}onActivated(){}onDisposing(){}};pt([(0,n.Inject)(nt.OrganizationTreeService)],lt.prototype,"organizationTreeService",2),pt([(0,n.Inject)(o.OmniaContext)],lt.prototype,"omniaContext",2),lt=pt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],lt);var dt=s("./client/fx/services/profilecardservice.js"),ht=Object.defineProperty,ut=Object.getOwnPropertyDescriptor,gt=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?ut(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&ht(t,s,a),a};let mt=class extends i.Store{constructor(){super(...arguments),this.user=this.state({}),this.userInformation=this.state({}),this.enablePeopleInformation=this.state(this.initEnablePeopleInformation()),this.profileCardDialogTabs=this.state([this.localizationService.get("Omnia.Ux.Profilecard.aboutTab"),this.localizationService.get("Omnia.Ux.Profilecard.organizationTab")]),this.tenantPeopleInfomation=this.state(this.initTenantPeopleInformation()),this.getters={getUser:e=>null===this.user.state[e]?null:this.user.state[e],getUserProperties:e=>null===this.userInformation.state[e]?null:this.userInformation.state[e],getEnablePeopleInformation:()=>this.enablePeopleInformation.state,getProfileCardDialogTabs:()=>this.profileCardDialogTabs.state,getTenantPeopleInformationModel:()=>this.tenantPeopleInfomation.state},this.mutations={setEnablePeopleInformation:this.mutation((e=>{this.enablePeopleInformation.mutate(e)})),setProfieCardDialogTabs:this.mutation((e=>{this.profileCardDialogTabs.mutate(e)})),setTenantPeopleInformation:this.mutation((e=>{this.tenantPeopleInfomation.mutate(e)}))},this.actions={loadUser:this.action((e=>new Promise(((t,s)=>{if(this.user.state[e])t(this.user.state[e]);else{const i=s=>{this.user.mutate(Object.assign({},this.user.state,{[e]:s})),t(this.user.state[e])};this.profileCardService.getUser(e).then(i).catch((e=>{s(e)}))}})))),loadUserProperties:this.action(((e,t)=>new Promise(((s,i)=>{if(!t&&this.userInformation.state[e])s(this.userInformation.state[e]);else{const t=t=>{this.userInformation.mutate(Object.assign({},this.userInformation.state,{[e]:t})),s(this.userInformation.state[e])};this.profileCardService.getUserInformation(e).then(t).catch((e=>{i(e)}))}}))))}}onActivated(){}onDisposing(){}initEnablePeopleInformation(){const e=this.omniaContext.tenant.propertyBag.getModel(r.TenantPeopleInformation);return!e||void 0===e.enablePeopleInformation||e.enablePeopleInformation}initTenantPeopleInformation(){const e=this.omniaContext.tenant.propertyBag.getModel(r.TenantPeopleInformation);return e?(e&&void 0!==e.enablePeopleInformation&&void 0!==e.showLinkToDelve||(e.showLinkToDelve=!1,e.showMySubscriptions=!1,e.enablePeopleInformation=!0),e):new r.TenantPeopleInformation}};gt([(0,n.Inject)(dt.ProfileCardService)],mt.prototype,"profileCardService",2),gt([(0,n.Inject)(o.OmniaContext)],mt.prototype,"omniaContext",2),gt([(0,n.Inject)(g.LocalizationService)],mt.prototype,"localizationService",2),mt=gt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],mt);var ft=s("./client/fx/services/enterpriseglossaryservice.js"),yt=Object.defineProperty,Pt=Object.getOwnPropertyDescriptor,vt=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Pt(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&yt(t,s,a),a};let bt=class extends i.Store{constructor(){super(...arguments),this.resolvableAllEnterpriseGlossaries=null,this.resolvableEnterpriseGlossaries={},this.resolvableEnterpriseGlossaryMappings={},this.pendingEnterpriseGlossaryMappingIds=[],this.enterpriseGlossaryMappings=this.state({}),this.allEnterpriseGlossaries=this.state([]),this.triggeredEnterpriseGlossaryInformation=this.state(null),this.getters={getEnterpriseGlossaryMapping:e=>e&&this.enterpriseGlossaryMappings.state[e.toString()],enterpriseGlossaries:()=>this.allEnterpriseGlossaries.state,enterpriseGlossary:e=>this.allEnterpriseGlossaries.state.find((t=>t.id==e)),getTriggeredEnterpriseGlossaryInformation:()=>this.triggeredEnterpriseGlossaryInformation.state},this.mutations={addEnterpriseGlossaries:this.mutation((e=>{e.map((e=>e.id.toString().toLowerCase()));this.allEnterpriseGlossaries.mutate((t=>{const s=e.filter((e=>void 0===t.state.find((t=>t.id==e.id))));t.state=t.state.concat(s)}))})),updateEnterpriseGlossaries:this.mutation((e=>{this.allEnterpriseGlossaries.mutate((t=>{t.state.find((t=>t.id==e.id)).enterpriseGlossary=e.enterpriseGlossary}))})),removeEnterpriseGlossaries:this.mutation((e=>{this.allEnterpriseGlossaries.mutate((t=>{t.state=t.state.filter((t=>t.id!=e.id))}))}))},this.actions={resolveTitle:this.action((e=>new Promise(((t,s)=>{n.Extend.fx.enterpriseGlossary.registrations.then((i=>{i.getEnterpriseGlossaryProviders().find((t=>t.type===e.type)).getTitle(e).then(t,s)}))})))),getAll:this.action((()=>(null===this.resolvableAllEnterpriseGlossaries&&(this.resolvableAllEnterpriseGlossaries=new r.Future(null),this.enterpriseGlossaryService.getAllEnterpriseGlossaries().then((e=>{e&&this.mutations.addEnterpriseGlossaries.commit(e),this.resolvableAllEnterpriseGlossaries.resolve(this.getters.enterpriseGlossaries())}),this.resolvableAllEnterpriseGlossaries.reject)),this.resolvableAllEnterpriseGlossaries))),ensureEnterpriseGlossary:this.action((e=>{const t=e.toString();return void 0===this.resolvableEnterpriseGlossaries[t]&&(this.resolvableEnterpriseGlossaries[t]=new r.Future(null),this.enterpriseGlossaryService.getEnterpriseGlossary(e).then((e=>{e&&this.mutations.addEnterpriseGlossaries.commit([e]),this.resolvableEnterpriseGlossaries[t].resolve()}))),this.resolvableEnterpriseGlossaries[t]})),ensureEnterpriseGlossaryMapping:this.action((e=>{const t=e.toString();return void 0===this.resolvableEnterpriseGlossaryMappings[t]&&(this.resolvableEnterpriseGlossaryMappings[t]=new r.Future(null),this.pendingEnterpriseGlossaryMappingIds.push(e),setTimeout((()=>{const e=this.pendingEnterpriseGlossaryMappingIds.slice();this.pendingEnterpriseGlossaryMappingIds=[],this.enterpriseGlossaryService.getEnterpriseGlossaryMappings(e).then((t=>{t&&this.enterpriseGlossaryMappings.mutate((e=>{t.forEach((t=>{e.state[t.id.toString()]||(e.state[t.id.toString()]=t)}))})),e.forEach((e=>{this.resolvableEnterpriseGlossaryMappings[e.toString()].resolve()}))}))}),50)),this.resolvableEnterpriseGlossaryMappings[t]})),addEnterpriseGlossary:this.action((e=>new Promise(((t,s)=>{this.enterpriseGlossaryService.addEnterpriseGlossary(e).then((e=>{if(e){const t=this.omniaContext.tenant.propertyBag.getModel(r.TenantEnterpriseGlossary);t?.ids&&!t?.ids.find((t=>t==e.id))&&(t.ids.push(e.id),this.omniaContext.tenant.propertyBag.addOrUpdate(t)),this.mutations.addEnterpriseGlossaries.commit([e])}t(e)}),s)})))),updateEnterpriseGlossary:this.action((e=>new Promise(((t,s)=>{this.enterpriseGlossaryService.updateEnterpriseGlossary(e).then((e=>{this.mutations.updateEnterpriseGlossaries.commit(e),t(e)}))})))),removeEnterpriseGlossary:this.action((e=>new Promise(((t,s)=>{this.enterpriseGlossaryService.removeEnterpriseGlossary(e).then((s=>{this.mutations.removeEnterpriseGlossaries.commit(e),t()}))})))),addOrUpdateEnterpriseGlossaryMapping:this.action((e=>new Promise(((t,s)=>{this.enterpriseGlossaryService.addOrUpdateEnterpriseGlossaryMapping(e).then((e=>{t(e)}))})))),removeEnterpriseGlossaryMappings:this.action((e=>new Promise(((t,s)=>{this.enterpriseGlossaryService.removeEnterpriseGlossaryMappings(e).then((e=>{t()}))})))),triggerEnterpriseGlossaryInformation:this.action(((e,t)=>new Promise((async(s,i)=>{this.triggeredEnterpriseGlossaryInformation.mutate((s=>s.state={sourceInformation:t,providerInformationSourceSettings:e.enterpriseGlossary.providerInformationSourceSettings}));const r=await omniaApi.fx.enterpriseGlossary.providers,a=await r.getInformationProvider(e.enterpriseGlossary.providerInformationSourceSettings.providerId),o=this.serviceContainerContext.createInstance(a).triggered(t,e.enterpriseGlossary.providerInformationSourceSettings);n.Utils.isPromise(o)?o.then(s,i):s()})))),queryEnterpriseGlossaryMappings:this.action((e=>new Promise(((t,s)=>{this.enterpriseGlossaryService.queryEnterpriseGlossaryMappings(e).then((e=>{t(e)}))}))))}}onActivated(){}onDisposing(){}};vt([(0,n.Inject)(ft.EnterpriseGlossaryService)],bt.prototype,"enterpriseGlossaryService",2),vt([(0,n.Inject)(n.ServiceContainerContext)],bt.prototype,"serviceContainerContext",2),vt([(0,n.Inject)(o.OmniaContext)],bt.prototype,"omniaContext",2),bt=vt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],bt);var St=s("./client/fx/services/applayoutservice.js"),It=Object.defineProperty,Ct=Object.getOwnPropertyDescriptor,wt=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ct(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&It(t,s,a),a};let xt=class extends i.Store{constructor(){super(...arguments),this.loadingPromises={},this.loadingDefinitionPromises={},this.loadingLatestRefPromises={},this.loadingLayoutWithIdentifierPromises={},this.loadingLayoutWithIdPromises={},this.loadingDisplayBreakpointAlternateLayoutMappingPromises={},this.layouts=this.state({}),this.layoutDefinitions=this.state({}),this.latestRefs=this.state({}),this.dataIdentifierToLayoutMapping={},this.displayBreakpointAlternateLayoutMappings=this.state({})}onActivated(){}};xt=wt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],xt);let Tt=class extends i.Store{constructor(){super(...arguments),this.getters={getLayout:e=>this.internal.layouts.state[e]||null,getLayoutByIdentifer:e=>{const t=this.internal.dataIdentifierToLayoutMapping[e.dataId];return t&&this.internal.layouts.state[t]||null},getLayoutDefinition:e=>this.internal.layoutDefinitions.state[e.versionId]||null,getLatestRef:e=>this.internal.latestRefs.state[e.dataId]||null,getLayoutWithDefinition:(e,t)=>{const s=this.internal.layouts.state,i=(new t).layoutTypeId;return Object.keys(s).map((e=>s[e])).filter((t=>t.appInstanceId===e&&t.layoutTypeId===i))}},this.actions={ensureLoad:this.action((e=>(this.internal.loadingPromises[e.toString().toLowerCase()]||(this.internal.loadingPromises[e.toString().toLowerCase()]=new Promise(((t,s)=>{this.appLayoutService.getLayoutsByAppId(e).then((s=>{this.replaceAllLayouts(e,s),t()})).catch(s)}))),this.internal.loadingPromises[e.toString().toLowerCase()]))),ensureLoadLayoutDefinitionLatestRef:this.action(((e,t=!0)=>(this.internal.loadingLatestRefPromises[e.dataId]&&t||(this.internal.loadingLatestRefPromises[e.dataId]=new Promise(((t,s)=>{this.appLayoutService.getLayoutDefinitionLatestRef(e).then((s=>{this.internal.latestRefs.mutate(Object.assign({},this.internal.latestRefs.state,{[e.dataId]:s})),t()})).catch(s)}))),this.internal.loadingLatestRefPromises[e.dataId]))),ensureLoadByIdentifier:this.action(((e,t=!0)=>(this.internal.loadingLayoutWithIdentifierPromises[e.dataId]&&t||(this.internal.loadingLayoutWithIdentifierPromises[e.dataId]=new Promise(((t,s)=>{this.appLayoutService.getLayoutByIdentifier(e).then((e=>{this.addOrUpdateLayouts(e),t()})).catch(s)}))),this.internal.loadingLayoutWithIdentifierPromises[e.dataId]))),ensureLoadById:this.action(((e,t=!0)=>(this.internal.loadingLayoutWithIdPromises[e]&&t||(this.internal.loadingLayoutWithIdPromises[e]=new Promise(((t,s)=>{this.appLayoutService.getLayoutById(e).then((e=>{this.addOrUpdateLayouts(e),t()})).catch(s)}))),this.internal.loadingLayoutWithIdPromises[e]))),ensureLoadDefinition:this.action((e=>(this.internal.loadingDefinitionPromises[e.versionId]||(this.internal.loadingDefinitionPromises[e.versionId]=new Promise(((t,s)=>{this.appLayoutService.getLayoutDefinitionVersion(e).then((e=>{this.addOrUpdateDefinitions(e),t()})).catch(s)}))),this.internal.loadingDefinitionPromises[e.versionId]))),ensureLoadDisplayBreakpointMapping:this.action(((e,t=!0)=>new Promise(((s,i)=>{this.internal.loadingDisplayBreakpointAlternateLayoutMappingPromises[e.id]&&t||(this.internal.loadingDisplayBreakpointAlternateLayoutMappingPromises[e.id]=new Promise(((t,s)=>{this.appLayoutService.getDisplayBreakpointAlternateLayoutMappings(e.id).then((s=>{this.addOrUpdateMappings(s),this.addOrUpdateMappingIntoAppRouteCache(e,s[e.id]),t()})).catch(s)}))),this.internal.loadingDisplayBreakpointAlternateLayoutMappingPromises[e.id].then((()=>{s(this.internal.displayBreakpointAlternateLayoutMappings.state[e.id])}))})))),setDisplayBreakpointMapping:this.action(((e,t)=>new Promise(((s,i)=>{this.appLayoutService.setDisplayBreakpointAlternateLayoutMapping(e.id,t).then((()=>{this.addOrUpdateMappings({[e.id]:t}),this.addOrUpdateMappingIntoAppRouteCache(e,t),s()})).catch(i)})))),create:this.action(((e,t,s)=>new Promise(((i,r)=>{this.appLayoutService.createLayout(e,t,s).then((({appInstanceLayout:e,checkedOutVersionedData:t})=>{this.addOrUpdateLayouts(e),this.addOrUpdateDefinitions(t),this.addOrUpdateLayoutIntoAppRouteCache(e),i({appInstanceLayout:e,checkedOutVersionedData:t})})).catch(r)})))),createAlternate:this.action(((e,t,s)=>new Promise(((i,r)=>{this.appLayoutService.createAlternateLayout(e,t,s).then((({appInstanceLayout:e,appInstanceAlternateLayout:t,checkedOutVersionedData:s})=>{this.addOrUpdateLayouts(e),this.addOrUpdateDefinitions(s),this.addOrUpdateLayoutIntoAppRouteCache(e),i({appInstanceLayout:e,appInstanceAlternateLayout:t,checkedOutVersionedData:s})})).catch(r)})))),publishDefinition:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.publishLayoutDefinition(e).then((({appInstanceLayout:e,publishedVersionedData:s})=>{this.addOrUpdateLayouts(e),this.addOrUpdateDefinitions(s),this.removeLatestRef(s),this.addOrUpdateLayoutIntoAppRouteCache(e),t(s)})).catch(s)})))),updateDefinition:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.updateLayoutDefinition(e).then((e=>{t(e)})).catch(s)})))),checkOutDefinition:this.action(((e,t=!1)=>new Promise(((s,i)=>{this.appLayoutService.checkOutLayoutDefinition(e,t).then((e=>{this.removeLatestRef(e),s(e)})).catch(i)})))),checkInDefinition:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.checkInLayoutDefinition(e).then((s=>{this.addOrUpdateDefinitions(s),this.removeLatestRef(e),t(s)})).catch(s)})))),discardDefinition:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.discardLayoutDefinition(e).then((s=>{this.removeDefinitions(e),this.removeLatestRef(s),t(s)})).catch(s)})))),delete:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.deleteLayout(e).then((()=>{this.removeLayous(e),this.removeLayoutFromAppRouteCache(e),t(e)})).catch(s)})))),deleteAlternate:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.deleteAlternateLayout(e).then((e=>{this.addOrUpdateLayouts(e),t(e)})).catch(s)})))),updateAlternateLayout:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.updateAlternateLayout(e).then((e=>{this.addOrUpdateLayouts(e),t(e)})).catch(s)})))),updateLayout:this.action((e=>new Promise(((t,s)=>{this.appLayoutService.updateLayout(e).then((e=>{this.addOrUpdateLayouts(e),t(e)})).catch(s)}))))}}addOrUpdateDefinitions(...e){const t=Object.assign({},this.internal.layoutDefinitions.state);e.forEach((e=>{t[e.versionId]=e})),this.internal.layoutDefinitions.mutate(t)}addOrUpdateLayouts(...e){const t=Object.assign({},this.internal.layouts.state);e.forEach((e=>{t[e.id]=e,this.internal.dataIdentifierToLayoutMapping[e.versionedDataIdentifier.dataId]=e.id,this.internal.loadingLayoutWithIdentifierPromises[e.versionedDataIdentifier.dataId]||(this.internal.loadingLayoutWithIdentifierPromises[e.versionedDataIdentifier.dataId]=Promise.resolve()),this.internal.loadingLayoutWithIdPromises[e.id]||(this.internal.loadingLayoutWithIdPromises[e.id]=Promise.resolve())})),this.internal.layouts.mutate(t)}addOrUpdateMappings(e){const t=Object.assign({},this.internal.displayBreakpointAlternateLayoutMappings.state);Object.keys(e).forEach((s=>{t[s]=e[s],this.internal.loadingDisplayBreakpointAlternateLayoutMappingPromises[s]||(this.internal.loadingDisplayBreakpointAlternateLayoutMappingPromises[s]=Promise.resolve())})),this.internal.displayBreakpointAlternateLayoutMappings.mutate(t)}removeLayous(...e){const t=Object.assign({},this.internal.layouts.state);e.forEach((e=>{delete t[e.id],delete this.internal.loadingLayoutWithIdentifierPromises[e.versionedDataIdentifier.dataId],delete this.internal.dataIdentifierToLayoutMapping[e.versionedDataIdentifier.dataId]})),this.internal.layouts.mutate(t)}removeDefinitions(...e){const t=Object.assign({},this.internal.layoutDefinitions.state);e.forEach((e=>{delete t[e.versionId]})),this.internal.layoutDefinitions.mutate(t)}replaceAllLayouts(e,t){const s=this.internal.layouts.state,i=Object.keys(s).map((e=>s[e])).filter((t=>t.appInstanceId===e)).filter((e=>!t.find((t=>t.id===e.id))));this.addOrUpdateLayouts(...t),this.removeLayous(...i)}removeLatestRef(e){this.internal.latestRefs.mutate((t=>{delete t.state[e.dataId]})),delete this.internal.loadingLatestRefPromises[e.dataId]}removeLayoutFromAppRouteCache(e){Object.keys(a.AppService.routes).forEach((t=>{const s=a.AppService.routes[t];if(s.appRouteWithProperties?.appInstance?.id===e.appInstanceId){const t=s.appRouteWithProperties.layouts.findIndex((t=>t.id===e.id));t>=0&&s.appRouteWithProperties.layouts.splice(t,1)}}))}addOrUpdateLayoutIntoAppRouteCache(e){Object.keys(a.AppService.routes).forEach((t=>{const s=a.AppService.routes[t];if(s.appRouteWithProperties?.appInstance?.id===e.appInstanceId){const t=s.appRouteWithProperties.layouts.find((t=>t.id===e.id));t?Object.assign(t,e):s.appRouteWithProperties.layouts.push(e)}}))}addOrUpdateMappingIntoAppRouteCache(e,t){Object.keys(a.AppService.routes).forEach((s=>{const i=a.AppService.routes[s];if(i.appRouteWithProperties?.appInstance?.id===e.appInstanceId){const s=i.appRouteWithProperties.displayBreakpointAlternateLayoutMappings[e.id];s?(Object.keys(s).forEach((e=>{delete s[e]})),Object.assign(s,t)):i.appRouteWithProperties.displayBreakpointAlternateLayoutMappings[e.id]=t}}))}loadDataFromContext(){const e=this.omniaContext.appRoute?.appInstance?.id;if(e){const t=this.omniaContext.appRoute.layouts;this.replaceAllLayouts(e,t);const s=this.omniaContext.appRoute.displayBreakpointAlternateLayoutMappings;this.addOrUpdateMappings(s),this.internal.loadingPromises[e.toString().toLowerCase()]||(this.internal.loadingPromises[e.toString().toLowerCase()]=Promise.resolve())}}onActivated(){this.loadDataFromContext(),this.subscriptionHandler.add(this.omniaContext.onContextChanged().subscribe((()=>{this.loadDataFromContext()})))}onDisposing(){this.subscriptionHandler.unsubscribe(),super.onDisposing()}};wt([(0,n.Inject)(St.AppLayoutService)],Tt.prototype,"appLayoutService",2),wt([(0,n.Inject)(o.OmniaContext)],Tt.prototype,"omniaContext",2),wt([(0,n.Inject)(xt)],Tt.prototype,"internal",2),wt([(0,n.Inject)(n.SubscriptionHandler)],Tt.prototype,"subscriptionHandler",2),Tt=wt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Scoped)},onDisposing:e=>e.onDisposing()})],Tt);var Lt=Object.defineProperty,Ot=Object.getOwnPropertyDescriptor,jt=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ot(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Lt(t,s,a),a};let _t=class extends i.Store{constructor(){super(...arguments),this.allowMSTeams=this.state(!0),this.getters={allowMSTeams:()=>this.allowMSTeams.state},this.mutations={setAllowMSTeams:this.mutation((e=>{this.allowMSTeams.mutate(e)}))},this.actions={}}onActivated(){}onDisposing(){}};jt([(0,n.Inject)(tt.MediaPickerService)],_t.prototype,"mediaPickerService",2),_t=jt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],_t);var At=Object.defineProperty,Mt=Object.getOwnPropertyDescriptor;let Ut=class extends i.Store{constructor(){super(...arguments),this.clipboards=this.state([]),this.dbName="OmniaClipboard_v1.0",this.dbKey="ClipboardKey_v1.0",this.getters={getClipboard:e=>{const t=this.getClipBoardStateIndex(e);return t>-1?this.clipboards.state[t].value:null}},this.mutations={ensureClipboard:this.mutation((e=>{this.getClipBoardStateIndex(e)>-1||this.clipboards.mutate((t=>{t.state.push({key:e,value:{clipboardItems:[]}})}))})),addClipboardItem:this.mutation(((e,t)=>{const s=this.getClipBoardStateIndex(e);if(s<0)throw Error("Clipboard not present");this.clipboards.mutate((e=>{e.state[s].value.clipboardItems.unshift(t)})),this.saveClipboard()})),updateClipboard:this.mutation(((e,t)=>{const s=this.getClipBoardStateIndex(e);s>-1&&this.clipboards.mutate((e=>{e.state[s].value=t})),this.saveClipboard()})),clearClipboard:this.mutation((e=>{this.clearClipboard(e),this.saveClipboard()})),saveClipboard:this.mutation((()=>{this.saveClipboard()})),appendClipboard:this.mutation(((e,t)=>{const s=this.getClipBoardStateIndex(e);s>-1&&this.clipboards.mutate((e=>{t.clipboardItems.forEach((t=>{e.state[s].value.clipboardItems.push(t)}))})),this.saveClipboard()})),reloadClipboard:this.mutation((e=>{this.loadClipboard(!0)}))}}onActivated(){this.loadClipboard(!1)}onDisposing(){}loadClipboard(e){try{const t=window.indexedDB.open(this.dbName,1);t.onsuccess=s=>{const i=t.result,r=i.transaction(this.dbName,"readonly"),a=r.objectStore(this.dbName).get(this.dbKey);a.onsuccess=t=>{const s=JSON.parse(a.result);s&&this.clipboards.mutate((t=>{s.forEach((s=>{const i=t.state.findIndex((e=>e.key==s.key));i>-1&&e?t.state[i].value=s.value:t.state.push(s)}))}))},r.oncomplete=()=>{i.close()}},t.onupgradeneeded=e=>{t.result.createObjectStore(this.dbName)}}catch(e){}}saveClipboard(){const e=window.indexedDB.open(this.dbName,1);e.onsuccess=t=>{const s=e.result,i=s.transaction(this.dbName,"readwrite");i.objectStore(this.dbName).put(JSON.stringify(this.clipboards.state),this.dbKey);i.oncomplete=()=>{s.close()}},e.onupgradeneeded=t=>{e.result.createObjectStore(this.dbName)}}getClipBoardStateIndex(e){return this.clipboards.state.findIndex((t=>t.key.toString()===e.toString()))}clearClipboard(e){const t=this.getClipBoardStateIndex(e);t>-1&&this.clipboards.mutate((e=>{e.state[t].value.clipboardItems=[]}))}};Ut=((e,t,s,i)=>{for(var r,a=i>1?void 0:i?Mt(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&At(t,s,a),a})([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],Ut);var Rt=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor,Et=(e=>(e[e.Registered=1]="Registered",e[e.NotRegistered=2]="NotRegistered",e[e.HasValue=4]="HasValue",e))(Et||{});let Bt=class extends i.Store{constructor(){super(...arguments),this.tokenValues=this.state({}),this.getters={getValues:e=>[],validateTokenString:e=>!1,replaceWithTokenValues:(e,t)=>{this.getters.validateTokenString(e)}},this.mutations={setValue:this.mutation(((e,...t)=>{this.tokenValues.mutate((s=>{s.state[(new e).prefixToken]=t}))}))}}setValue(e,...t){}onActivated(){}};Bt=((e,t,s,i)=>{for(var r,a=i>1?void 0:i?Dt(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&Rt(t,s,a),a})([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Scoped)}})],Bt);var kt=s("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),$t=Object.defineProperty,Ht=Object.getOwnPropertyDescriptor,Ft=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Ht(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&$t(t,s,a),a};let Gt=class extends i.Store{constructor(){super(...arguments),this.loadPromises={},this.policies=this.state([]),this.getters={getByAppDefinitionId:e=>this.policies.state.filter((t=>t.appDefinitionId===e.toString())),getById:e=>this.policies.state.find((t=>t.id===e))},this.actions={ensureLoad:this.action((e=>(this.loadPromises[e.toString().toLowerCase()]||(this.loadPromises[e.toString().toLowerCase()]=this.appNamingPolicyService.get(this.omniaContext.businessProfile.id,e).then((e=>{this.addOrUpdate(...e)}))),this.loadPromises[e.toString().toLowerCase()]))),ensureLoadById:this.action((e=>(this.loadPromises[e.toString().toLowerCase()]||(this.loadPromises[e.toString().toLowerCase()]=this.appNamingPolicyService.get(this.omniaContext.businessProfile.id,e).then((e=>{this.addOrUpdate(...e)}))),this.loadPromises[e.toString().toLowerCase()]))),add:this.action(((e,t)=>this.appNamingPolicyService.add(this.omniaContext.businessProfile.id,e,t).then((e=>{this.addOrUpdate(e)})))),update:this.action((e=>this.appNamingPolicyService.update(e).then((e=>{this.addOrUpdate(e)})))),delete:this.action((e=>this.appNamingPolicyService.delete(e).then((()=>{this.remove(e)}))))}}addOrUpdate(...e){const t=[...this.policies.state];for(const s of e){const e=t.findIndex((e=>e.id===s.id));e>=0?t.splice(e,1,s):t.push(s)}this.sortItems(t),this.policies.mutate(t)}remove(...e){const t=[...this.policies.state];for(const s of e){const e=t.findIndex((e=>e.id===s.id));e>=0&&t.splice(e,1)}this.policies.mutate(t)}sortItems(e){e.sort(((e,t)=>e.definition.title>t.definition.title?1:-1))}onActivated(){}onDisposing(){}};Ft([(0,n.Inject)(o.OmniaContext)],Gt.prototype,"omniaContext",2),Ft([(0,n.Inject)(kt.AppNamingPolicyService)],Gt.prototype,"appNamingPolicyService",2),Gt=Ft([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Scoped)}})],Gt);var Nt=s("./client/fx/services/postservice.js"),zt=Object.defineProperty,Wt=Object.getOwnPropertyDescriptor,Kt=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?Wt(t,s):t,n=e.length-1;n>=0;n--)(r=e[n])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&zt(t,s,a),a};let qt=class extends i.Store{constructor(){super({name:"220c882e-a7c6-488e-94b5-9b85a351c3e2"}),this.posts=this.state({}),this.userHash={},this.topPostsIds={},this.topPostLastActivity={},this.getters={topPosts:e=>{let t=this.posts.state[e];return t&&(t=t.filter((e=>!e.post.parentId))),t},replies:(e,t)=>{let s=this.posts.state[e];return s&&(s=s.filter((e=>e.post.parentId===t))),s},post:(e,t)=>{const s=this.posts.state[e];return s?s.filter((e=>e.postId==t))[0]:null},posts:e=>{const t=[];return e.forEach((e=>{t.push(...this.posts.state[e])})),this.getSortedPosts(t)}},this.mutations={},this.actions={toggleLike:this.action(((e,t)=>new Promise(((t,s)=>{this.postService.toggleLike(e).then((s=>{const i=e.post.context.getTopicId(),r=this.posts.state[i.toString()]?this.posts.state[i.toString()].filter((t=>t.postId!==e.postId)):[];r.push(s),this.posts.mutate(Object.assign({},this.posts.state,{[e.post.context.getTopicId().toString()]:r})),t(s)})).catch((e=>{console.log("toggle like failed:",e)}))})))),createPost:this.action(((e,t)=>{const s={parentId:e.parentId?e.parentId:null,mentionedUsers:e.mentionedUsers,...e};return new Promise(((e,t)=>{this.postService.create(s).then((t=>{const i=this.posts.state[s.context.getTopicId().toString()];i.push(t),t.post.parentId!==r.Guid.empty.toString()&&(this.topPostsIds[t.postId.toString()]=this.topPostsIds[t.post.parentId.toString()]||t.post.parentId.toString()),this.calculateTopPostLastActivity(i),this.posts.mutate(Object.assign({},this.posts.state,{[s.context.getTopicId().toString()]:i})),e(t)})).catch((e=>{t(e),console.log("create post failed:",e)}))}))})),deletePost:this.action(((e,t)=>this.postService.delete(e).then((s=>{if(s){s.deletedBy=t;const i=this.posts.state[e.post.context.getTopicId().toString()].filter((t=>t.postId!==e.postId));this.calculateTopPostLastActivity(i),this.posts.mutate(Object.assign({},this.posts.state,{[e.post.context.getTopicId().toString()]:[...i,s]}))}return Promise.resolve(e)})))),updatePost:this.action((e=>this.postService.update(e).then((t=>{const s=e.post.context.getTopicId(),i=this.posts.state[s.toString()]?this.posts.state[s.toString()].filter((t=>t.postId!==e.postId)):[];return i.push(t),this.calculateTopPostLastActivity(i),this.posts.mutate(Object.assign({},this.posts.state,{[e.post.context.getTopicId().toString()]:i})),Promise.resolve(t)})))),loadData:this.action(((e,t,s,i)=>{const a=[];return s.forEach((s=>{a.push(new Promise(((a,o)=>{this.postService.getContext(e,t,s).then((e=>{e=n.Utils.clone(e).filter((e=>null!==e));const t={};e.forEach((e=>t[e.postId.toString()]=e.post.parentId.toString()===r.Guid.empty.toString()?null:e.post.parentId.toString()));for(const e in t)if(!this.topPostsIds[e]){const s=[];let i=e;for(;t[i];)s.push(i),i=t[i];s.forEach((e=>this.topPostsIds[e]=i))}const c=e.map((e=>e.createdBy));-1===c.indexOf(i)&&c.push(i),this.calculateTopPostLastActivity(e),this.userStore.actions.ensureResolve.dispatch(...c).then((()=>{this.userStore.getters.resolvedIdentities(...c).forEach((e=>this.userHash[e.uid.toLowerCase()]=e)),this.posts.mutate(Object.assign({},this.posts.state,{[s.toString()]:e})),a(null)})).catch(o)})).catch(o)})))})),Promise.all(a).then()}))}}calculateTopPostLastActivity(e){e.forEach((e=>{const t=this.topPostsIds[e.postId.toString()]||e.postId,s=this.topPostLastActivity[t.toString()],i=e.modifiedAt;(!s||i>s)&&(this.topPostLastActivity[t.toString()]=i)}))}getSortedPosts(e){const t=[],s=[];return e.forEach((e=>{e.post.parentId.toString()===r.Guid.empty.toString()?s.push(e):t.push(e)})),t.sort(((e,t)=>e.createdAt<t.createdAt?-1:1)),s.sort(((e,t)=>(this.topPostLastActivity[e.postId.toString()]||e.modifiedAt)<(this.topPostLastActivity[t.postId.toString()]||t.modifiedAt)?1:-1)),s.concat(t)}onActivated(){}onDisposing(){}};Kt([(0,n.Inject)(v.AzureAdService)],qt.prototype,"userService",2),Kt([(0,n.Inject)(w)],qt.prototype,"userStore",2),Kt([(0,n.Inject)(Nt.PostService)],qt.prototype,"postService",2),qt=Kt([(0,n.Injectable)({onStartup:e=>{i.Store.register(e,r.InstanceLifetimes.Singelton)}})],qt)}
//! <omnia-transform-resource path="5e618f4d-d014-414e-a681-89e34cbeda0f" />
,"c041fe9f-1e14-443d-9407-5aa8829fbc21":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Localize:()=>d,VueWebComponentSlot:()=>p,install:()=>g.install,useLocalize:()=>h,vueCustomElement:()=>g.vueCustomElement});var i=s("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),r=s("./node_modules/vue-tsx-support/dist/esm/index.js"),a=s("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=(e,t,s,i)=>{for(var r,a=i>1?void 0:i?o(t,s):t,c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i?r(t,s,a):r(a))||a);return i&&a&&n(t,s,a),a};let p=class extends r.Component{constructor(){super(...arguments),this.renderDefault=!1}mounted(){if(!this.providedBy)throw"VueWebComponentSlot requires providedBy";let e=this.wcSlot;if(e||(e="default"),this.providedBy.$parent.slots&&this.providedBy.$parent.slots[e]){const t=this.providedBy.$parent.slots[e],s=this.$el.parentNode;t.forEach((e=>{s.appendChild(e)}))}else this.renderDefault=!0}render(){return this.renderDefault&&this.$slots.default?this.$slots.default[0]:null}};c([(0,a.Prop)()],p.prototype,"providedBy",2),c([(0,a.Prop)()],p.prototype,"wcSlot",2),p=c([i.default],p);var l=s("5e618f4d-d014-414e-a681-89e34cbeda0f");function d(e){return function(t,s){Object.defineProperty(t,s,{get:function(){return u(e)}}),t.__proto__.$mount&&!t.constructor.__omnialocalize__&&(t.constructor.__omnialocalize__={}),t.__proto__.$mount&&t.constructor.__omnialocalize__&&(t.constructor.__omnialocalize__[s]=t[s])}}function h(e){return u(e)}function u(e){const t=l.LocalizationStore.instance.localizations.state;if(e){const s=e.indexOf(".")>-1?e.split("."):[e];let i=t;return s.forEach((e=>{i=i?i[e]:i})),i}return t}var g=s("./client/fx/vue/vuecustomelement/vuecustomelement.js")}
//! <omnia-transform-resource path="c041fe9f-1e14-443d-9407-5aa8829fbc21" />
,"./client/fx/vue/vuecustomelement/vuecustomelement.js":(e,t,s)=>{"use strict";function i(e,t={}){if("undefined"==typeof customElements)return;function s(){!0===t.shadow&&HTMLElement.prototype.attachShadow&&this.attachShadow({mode:"open"}),"function"==typeof t.constructorCallback&&t.constructorCallback.call(this)}class i extends HTMLElement{constructor(e){return super(),s.call(this),this}static get observedAttributes(){return t.observedAttributes()||[]}}i.prototype.connectedCallback=function(){"function"==typeof t.connectedCallback&&t.connectedCallback.call(this)},i.prototype.disconnectedCallback=function(){"function"==typeof t.disconnectedCallback&&t.disconnectedCallback.call(this)},i.prototype.attributeChangedCallback=function(e,s,i){"function"==typeof t.attributeChangedCallback&&t.attributeChangedCallback.call(this,e,s,i)},customElements.define(e,i);return i}s.r(t),s.d(t,{default:()=>x,install:()=>w,vueCustomElement:()=>I});const r=/-(\w)/g,a=e=>e.replace(r,((e,t)=>t?t.toUpperCase():"")),n=/([^-])([A-Z])/g;function o(e,t=0){let s=e.length-t;const i=new Array(s);for(;s--;)i[s]=e[s+t];return i}function c(e,t){let s=e;const i=["true","false"].indexOf(e)>-1,r=parseFloat(s),a=!isNaN(r)&&isFinite(s)&&"string"==typeof s&&!s.match(/^0+[^.]\d*$/g);return t&&t!==Boolean&&typeof s!==t?s=t(e):i||t===Boolean?s=""===s||"true"===s:a&&(s=r),s}function p(e,t){if(e&&e.length)e.forEach((e=>{const s=a(e);-1===t.camelCase.indexOf(s)&&t.camelCase.push(s)}));else if(e&&"object"==typeof e)for(const s in e){const i=a(s);-1===t.camelCase.indexOf(i)&&t.camelCase.push(i),e[i]&&e[i].type&&(t.types[s]=[].concat(e[i].type)[0])}}function l(e={}){const t={camelCase:[],hyphenate:[],types:{}};if(e.mixins&&e.mixins.forEach((e=>{p(e.props,t)})),e.extends&&e.extends.props){const{props:s}=e.extends;p(s,t)}return p(e.props,t),t.camelCase.forEach((e=>{t.hyphenate.push(e.replace(n,"$1-$2").replace(n,"$1-$2").toLowerCase())})),t}function d(e){const t={default:[]};for((/Trident\/|MSIE/.test(window.navigator.userAgent)||"undefined"==typeof Symbol||"undefined"==typeof Reflect||"undefined"==typeof Proxy||Object.isSealed(Proxy)?o(e.childNodes):e.childNodes).forEach((e=>{const s=1===e.nodeType?e.getAttribute("wcslot"):"";s?(t[s]||(t[s]=[]),t[s].push(e)):t.default.push(e)}));e.firstChild;)e.removeChild(e.firstChild);return t}function h(e,...t){const s=function(e,t){const s={bubbles:!1,cancelable:!1,detail:t};let i;return"function"==typeof window.CustomEvent?i=new CustomEvent(e,s):(i=document.createEvent("CustomEvent"),i.initCustomEvent(e,s.bubbles,s.cancelable,s.detail)),i}(t[0],[...t]);e.dispatchEvent(s)}function u(e,t,s,i,r){if(!e.__vue_custom_element__){const a=t.util.extend({},s.__hmrOptions?s.__hmrOptions:s),n=e.__props_data__||function(e,t,s){const i=t.propsData||{};return s.hyphenate.forEach(((t,r)=>{const a=s.camelCase[r];let n;void 0!==e[a]?n=e[a]:void 0!==e[a.toLowerCase()]?n=e[a.toLowerCase()]:void 0!==e.attributes[t]?n=e.attributes[t]:void 0!==e.attributes[a.toLowerCase()]?n=e.attributes[a.toLowerCase()]:void 0!==e.attributes[a]&&(n=e.attributes[a]);let o=null;s.types[a]&&(o=s.types[a]),n instanceof Attr?i[a]=c(n.value,o):void 0!==n&&(i[a]=n)})),i}(e,a,i),o=t.version&&parseInt(t.version.split(".")[0],10)||0,p=function(){this.$emit=function(...t){h(e,...t),this.__proto__&&this.__proto__.$emit.call(this,...t)}};if(a.beforeCreate=[].concat(a.beforeCreate||[],p),a._compiled){let e={};a._Ctor&&(e=a._Ctor[0].options),e.beforeCreate=a.beforeCreate}const l=d(e),u={propsData:n,props:i.camelCase,parent:e.__omwcparent__||document.body.__omwcroot__,computed:{reactiveProps(){const e={};return i.camelCase.forEach((t=>{void 0!==this[t]&&(e[t]=this[t])})),e}},beforeCreate(){e.__omvc__=this},created(){},render(e){this.slots=l;const t={props:this.reactiveProps};return s.__hmrOptions?(s.__hmrOptions.__hmrOriginalBeforeCreate||(s.__hmrOptions.__hmrOriginalBeforeCreate=!0,s.__hmrOptions.beforeCreate=[].concat(s.__hmrOptions.beforeCreate||[],p)),e(s.__hmrOptions,t,[])):e(a,t,[])}},g=o>=2?"<div></div>":`<div>${e.innerHTML}</div>`.replace(/vue-slot=/g,"slot=");if(r.shadow&&e.shadowRoot?(e.shadowRoot.innerHTML=g,u.el=e.shadowRoot.children[0]):(e.innerHTML=g,u.el=e.children[0]),e.__props_data__||(e.__props_data__=n),e.__bind_reactive_props__||(e.__bind_reactive_props__=!0,function(e,t){t.camelCase.forEach(((s,i)=>{Object.defineProperty(e,s,{get(){return this.__vue_custom_element__&&this.__vue_custom_element__[s]},set(e){if("object"!=typeof e&&"function"!=typeof e||!this.__vue_custom_element__){const s=t.types[t.camelCase[i]];this.setAttribute(t.hyphenate[i],c(e,s))}else{const s=t.camelCase[i];this.__vue_custom_element__&&(this.__vue_custom_element__[s]=e),this.__props_data__&&(this.__props_data__[s]=e)}},configurable:!0})}))}(e,i)),e.__vue_custom_element__=new t(u),e.__vue_custom_element_props__=i,r.shadow&&r.shadowCss&&e.shadowRoot){const t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(r.shadowCss)),e.shadowRoot.appendChild(t)}e.setAttribute("data-omfx",""),e.hidden=!1}}var g=s("97786ea9-4861-48bd-8a57-eae9bbdb4892"),m=s("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),f=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),y=s("10407664-c0c5-438b-94b2-507d58d190af");const P=g.ServiceContainer.createInstance(m.OmniaContext),v=new f.Future(null);let b,S;function I(e,t,s={}){s.destroyTimeout||(s.destroyTimeout=0),t.prototype&&(t.prototype.omwc=!0);"function"==typeof t&&(t=S.util.extend({},t).options);let r=C(t);return i(e,{constructorCallback(){"function"==typeof s.constructorCallback&&s.constructorCallback.call(this)},connectedCallback(){this.__detached__=!1;const e=()=>{if(!this.__detached__){const e=this.parentElement&&this.parentElement.closest("*[data-omvc]")||null;e&&(this.__omwcparent__=e.__omvc__?e.__omvc__.__omwc__||e.__omvc__:null);const i=false,a=i&&i.then&&"function"==typeof i.then;this.setAttribute("data-omwc",""),this.setAttribute("data-omvc",""),this.className&&-1!==this.className.indexOf("v-application")||(b&&b.isRTLDocument?this.className=`${this.className||""} v-application v-application--is-rtl`:this.className=`${this.className||""} v-application v-application--is-ltr`),this.__detached__||(a?i.then((e=>{const t=l(e);u(this,S,e,t,s)})):(t.__hmrOptions&&(r=C(t.__hmrOptions)),u(this,S,t,r,s)))}};setTimeout((()=>{v.resolved?e():v.then((t=>{e()}))}),0)},disconnectedCallback(){!1===this.__detached__&&(this.__detached__=!0),"function"==typeof s.disconnectedCallback&&s.disconnectedCallback.call(this);const e=e=>{e.__detached__&&e.__vue_custom_element__&&(e.__vue_custom_element__.$destroy(!0),e.__vue_custom_element__=null,e.__vue_custom_element_props__=null)};!s||s&&0===s.destroyTimeout?e(this):setTimeout((()=>{e(this)}),s.destroyTimeout||3e3)},attributeChangedCallback(e,t,i){if(this.__vue_custom_element__&&void 0!==i){let r=a(e);if(this.__vue_custom_element_props__&&this.__vue_custom_element_props__.camelCase){const e=this.__vue_custom_element_props__.camelCase.find((e=>e.toLowerCase()===r));void 0!==e&&(r=e)}"function"==typeof s.attributeChangedCallback&&s.attributeChangedCallback.call(this,e,t,i);const n=this.__vue_custom_element_props__.types[r];this.__vue_custom_element__[r]=c(i,n)}},observedAttributes:()=>r.hyphenate.concat(r.camelCase.map((e=>e.toLowerCase()))),shadow:!1})}function C(e){const t=l(e),s={themeTargetId:String,themeDefinitionId:String,inheritanceTheme:Object,themeDefinition:Object,onComponentCreated:Function};return["inheritanceTheme","themeTargetId","themeDefinitionId","themeDefinition","onComponentCreated"].forEach((e=>{-1===t.camelCase.indexOf(e)&&t.camelCase.push(e)})),["inheritance-theme","theme-target-id","theme-definition-id","theme-definition","on-component-created"].forEach((e=>{-1===t.hyphenate.indexOf(e)&&t.hyphenate.push(e)})),Object.keys(s).forEach((e=>{t.types[e]||(t.types[e]=s[e])})),t}function w(e){S=e}P.user.then((e=>{b=e.propertyBag.getModel(f.DocumentDirectionSettings),y.InternalTopics.omniaUXConfigurationCompleted.subscribe(v.resolve)}));const x=w;"undefined"!=typeof window&&window.Vue&&(window.Vue.use(w),w.installed&&(w.installed=!1))},"./client/fx/core/services/internalconfigurationservice.js":(e,t,s)=>{e.exports=s("dll-reference md9")("./client/fx/core/services/internalconfigurationservice.js")},"./client/fx/models/manifestids.js":(e,t,s)=>{e.exports=s("dll-reference md9")("./client/fx/models/manifestids.js")},"./client/fx/shared/services/index.js":(e,t,s)=>{e.exports=s("dll-reference md18")("./client/fx/shared/services/index.js")},"./node_modules/axios/dist/axios.js":(e,t,s)=>{e.exports=s("dll-reference md4")("./node_modules/axios/dist/axios.js")},"./node_modules/dayjs/dayjs.min.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/dayjs/dayjs.min.js")},"./node_modules/dayjs/plugin/duration.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/dayjs/plugin/duration.js")},"./node_modules/dayjs/plugin/relativetime.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/dayjs/plugin/relativetime.js")},"./node_modules/dayjs/plugin/timezone.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/dayjs/plugin/timezone.js")},"./node_modules/dayjs/plugin/utc.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/dayjs/plugin/utc.js")},"./node_modules/pinia/dist/pinia.esm-browser.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/pinia/dist/pinia.esm-browser.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"./node_modules/vue-tsx-support/dist/esm/index.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-tsx-support/dist/esm/index.js")},"./node_modules/vue/dist/vue.esm.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue/dist/vue.esm.js")},"10407664-c0c5-438b-94b2-507d58d190af":(e,t,s)=>{e.exports=s("dll-reference md9")("10407664-c0c5-438b-94b2-507d58d190af")},"46b8884f-20d6-40e6-b24e-54d8a6126ac9":(e,t,s)=>{e.exports=s("dll-reference md18")("46b8884f-20d6-40e6-b24e-54d8a6126ac9")},"4eeb27d5-906a-4edf-bd38-3d97048cda3d":(e,t,s)=>{e.exports=s("dll-reference md9")("4eeb27d5-906a-4edf-bd38-3d97048cda3d")},"5326a8ef-4e3c-49d6-b415-1ddf7fdcc830":(e,t,s)=>{e.exports=s("dll-reference md8")("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,s)=>{e.exports=s("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"9a75501c-254b-46d1-9010-7b13681e06f4":(e,t,s)=>{e.exports=s("dll-reference md18")("9a75501c-254b-46d1-9010-7b13681e06f4")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,s)=>{e.exports=s("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"ff061abc-7f0e-444b-b2b9-7ff71c5842c5":(e,t,s)=>{e.exports=s("dll-reference md9")("ff061abc-7f0e-444b-b2b9-7ff71c5842c5")},"dll-reference md4":e=>{"use strict";e.exports=omniaSharedVendor},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md18":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["6972ceca-544d-49c0-b575-67b1a5294812"]},"dll-reference md8":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a1602121-3070-4304-b4d8-0859e50c482b"]},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"])throw new Error("Error, already loaded manifest a5a89056-b5f5-475d-8518-a1f55090379d with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]=s;var t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s("c041fe9f-1e14-443d-9407-5aa8829fbc21"),s("./client/fx/bootstrapper.js"),s("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),s("5e618f4d-d014-414e-a681-89e34cbeda0f");s("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","a5a89056-b5f5-475d-8518-a1f55090379d")})()};