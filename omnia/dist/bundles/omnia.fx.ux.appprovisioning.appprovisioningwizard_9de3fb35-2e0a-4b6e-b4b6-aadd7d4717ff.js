if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff"])throw new Error("Error, already loaded manifest 9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff"]=function(){(()=>{var e={"./client/fx/ux/appprovisioning/appprovisioningwizard/appprovisioningwizard.tsx":(e,t,i)=>{"use strict";i.r(t),i.d(t,{AppProvisioningWizard:()=>P});var o=i("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff"),s=i("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),n=i("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),a=i("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),p=i("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff"),r=i("97786ea9-4861-48bd-8a57-eae9bbdb4892"),l=i("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),d=i("eff19cad-5557-434b-a477-1e1e2a70a2a0"),c=i("./client/fx/ux/appprovisioning/components/index.js"),h=i("./client/fx/ux/appprovisioning/components/summaryinfo/summaryinfostate.js"),m=Object.defineProperty,b=Object.getOwnPropertyDescriptor,f=(e,t,i,o)=>{for(var s,n=o>1?void 0:o?b(t,i):t,a=e.length-1;a>=0;a--)(s=e[a])&&(n=(o?s(t,i,n):s(n))||n);return o&&n&&m(t,i,n),n};const u=new l.FontAwesomeIcon("fas fa-chevron-left"),g=new l.FontAwesomeIcon("fas fa-chevron-right"),I=new l.FontAwesomeIcon("fas fa-paper-plane"),v=new l.FontAwesomeIcon("fas fa-check"),x=new l.FontAwesomeIcon("fas fa-times");let P=class extends c.AppProvisioningComponentBase{constructor(){super(),this.steps=null,this.isTemplateSelected=!1,this.isCompleted=!1,this.isProvisioningCompleted=!1,this.stepCallbacks={},this.showRejectDialog=!1,this.rejectComment="",this.isRejecting=!1,this.isCreating=!1,this.omniaUrl=r.ServiceLocator.getUrl(l.OmniaService.Id,!0),this.defaultStepIndex=0,this.onWizardInstanceCreated=e=>{this.wizardInstance=e},this.onGoToNext=e=>null!=this.stepCallbacks[e]&&null!=this.stepCallbacks[e].onGoToNext?this.stepCallbacks[e].onGoToNext():new Promise(((e,t)=>{e(!0)})),this.onGoToPrev=e=>null!=this.stepCallbacks[e]&&null!=this.stepCallbacks[e].onGoToPrev?this.stepCallbacks[e].onGoToPrev():new Promise(((e,t)=>{e(!0)})),this.renderAppProvisioningFeatureComponent=(e,t)=>(0,s.h)(c.AppInstanceFeatureVueComponent,{attrs:{context:e,elementToRender:t,registerOnGoToNext:t=>{this.registerOnGoToNext(e.stepId,t)},registerOnGoToPrev:t=>{this.registerOnGoToPrev(e.stepId,t)}}}),this.renderAppProvisioningStepComponent=(e,t)=>{const i={context:e,registerOnGoToNext:t=>{this.registerOnGoToNext(e.stepId,t)},registerOnGoToPrev:t=>{this.registerOnGoToPrev(e.stepId,t)}};return(0,s.h)(t,{domProps:i})},this.registerOnGoToNext=(e,t)=>{null==this.stepCallbacks[e.toString()]&&(this.stepCallbacks[e.toString()]={}),this.stepCallbacks[e.toString()].onGoToNext=t},this.registerOnGoToPrev=(e,t)=>{null==this.stepCallbacks[e.toString()]&&(this.stepCallbacks[e.toString()]={}),this.stepCallbacks[e.toString()].onGoToPrev=t}}async created(){super.created(),null!=this.initialAppTemplate&&null!=this.initialAppDefinition&&this.onTemplateSelected(this.initialAppTemplate,this.initialAppDefinition)}mounted(){p.WebComponentBootstrapper.registerElementInstance(this,this.$el),super.mounted(),this.formValidator=new o.FormValidator(this)}beforeDestroy(){super.beforeDestroy()}ensureData(){return new Promise(((e,t)=>{this.ensureDefaultEnterprisePropertyValues().then((()=>{Promise.all([this.appPolicyValidationState.ensureValidationStateWithAppInstance(this.appInstance),this.appNamingPolicyValidationState.ensureValidationStateWithAppInstance(this.appInstance)]).then((()=>{e()}))}))}))}onCompleteProvisioningSteps(e){null!=this.stepCallbacks[e]&&null!=this.stepCallbacks[e].onGoToNext?this.stepCallbacks[e].onGoToNext().then((e=>{e&&this.createOrSendApproval()})):this.createOrSendApproval()}approveAppInstance(){this.isCreating=!0;const e={contextParams:this.appInstance.properties.contextParams,appTemplateId:this.appInstance.appTemplateId,inputInfo:this.createAppInstanceInputInfo()};this.onCreateAppInstance(this.appInstance,e).then((e=>{this.appStore.actions.approveAppInstance.dispatch(this.appInstance.id,e).then((e=>{this.isCreating=!1,this.onProvisioningCompleted(e)}))}))}rejectAppInstance(){this.formValidator.validateAll()&&(this.isRejecting=!0,this.appStore.actions.rejectAppInstance.dispatch({appDefinitionId:this.appInstance.appDefinitionId,appInstanceId:this.appInstance.id,comment:this.rejectComment}).then((()=>{this.isRejecting=!1,this.onProvisioningCanceled()})))}createOrSendApproval(){this.isCreating=!0;const e={contextParams:this.appInstance.properties.contextParams,appTemplateId:this.appInstance.appTemplateId,inputInfo:this.createAppInstanceInputInfo()},t=this.appTemplate.properties.permissionLevel===l.AppTemplatePermissionLevel.Approval;this.onCreateAppInstance(this.appInstance,e).then((e=>{t&&(e.inputInfo.pendingRequestUrl+="#tab-pending"),this.appStore.actions.createAppInstance.dispatch(e,this.appTemplate.businessProfileId,!0).then((e=>{this.isCreating=!1,t?this.isCompleted=!0:setTimeout((()=>{const t=e.properties.properties.omniaPath,i=e.properties.properties.omniaRoutePrefix,o=t?`/${i}/${t}`:"";location.href=this.omniaUrl+o}),100)}))}))}createAppInstanceInputInfo(){return{title:this.appInstance.title,description:this.appInstance.description,showInPublicListings:this.appInstance.showInPublicListings,permissionIdentities:this.appInstance.permissionIdentities,outputInfo:this.appInstance.outputInfo,properties:this.appInstance.properties.properties,featureProperties:this.appInstance.properties.featureProperties,enterpriseProperties:this.appInstance.enterpriseProperties,image:this.appInstance.image}}ensureDefaultReactiveValues(){this.appInstance.properties||this.$set(this.appInstance,(0,r.propertyPath)()("properties"),{properties:{},featureProperties:{}}),this.appInstance.properties.properties||this.$set(this.appInstance.properties,(0,r.propertyPath)()("properties"),{}),this.appInstance.properties.featureProperties||this.$set(this.appInstance.properties,(0,r.propertyPath)()("featureProperties"),{}),this.appInstance.enterpriseProperties||this.$set(this.appInstance,(0,r.propertyPath)()("enterpriseProperties"),{})}onTemplateSelected(e,t){this.waitingAfterTemplateSelected=!0,this.initialAppInstance?(this.appInstance=this.initialAppInstance,this.appTemplate=e,this.appDefinition=t,this.appInstance.appDefinitionId=this.appDefinition.id,this.appInstance.appTemplateId=this.appTemplate.id,this.ensureDefaultReactiveValues(),this.getAppProvisioningSteps(e).then((e=>{this.ensureData().then((()=>{this.waitingAfterTemplateSelected=!1,this.isTemplateSelected=!0,this.steps=this.getAppProvisioningWizardSteps(e),this.initialAppInstance.id&&(this.defaultStepIndex=this.steps.length-1)}))}))):this.initAppInstanceInfo(e,t).then((()=>{this.getAppProvisioningSteps(e).then((e=>{this.ensureData().then((()=>{this.waitingAfterTemplateSelected=!1,this.isTemplateSelected=!0,this.steps=this.getAppProvisioningWizardSteps(e)}))}))}))}getAppProvisioningWizardSteps(e){const t=[];this.summaryInfoState.reset(),this.enableUserStep||(e=e.filter((e=>e.id!==l.AppProvisioningUserStepId)));for(let i=0;i<e.length;i++){const o=e[i];let s=!1,n=!1;0==i&&(s=!0),i==e.length-1&&(n=!0),t.push(this.getAppProvisioningWizardStep(o,s,n)),this.summaryInfoState.addStep(o.id.toString(),o.title,o.summaryElementToRender)}return this.summaryInfoState.registerInformationSummaryRenderer(this.getInformationSummaryRenderer()),t}getAppProvisioningWizardStep(e,t,i){const o=this.createAppProvisioningContextInstance(e),n=e.id.toString(),a={id:n,title:e.title,onGoToNext:()=>this.onGoToNext(n),onGoToPrev:()=>this.onGoToPrev(n),content:null};if(!t||null!=this.initialAppTemplate&&null!=this.initialAppDefinition||null!=this.templatesToShow&&1==this.templatesToShow.length||(a.beforeButtons=()=>[(0,s.h)("omfx-button",{domProps:{onClick:()=>{this.isTemplateSelected=!1},styles:{textColor:this.theming.body.fg.color.base},mode:l.ButtonModes.flat,icon:{position:l.ButtonIconPosition.Left,small:!0,iconType:this.directionStore.getters.getDirectionRule()===l.DirectionRules.rtl?g:u}},attrs:{text:this.omniaUxLoc.Common.Buttons.Previous}})]),i){const e=this.appTemplate.properties.permissionLevel===l.AppTemplatePermissionLevel.Approval,t=e?this.omniaUxLoc.Common.Buttons.SendRequest:this.omniaUxLoc.Common.Buttons.Create,i=e?I:v;a.afterButtons=()=>this.initialAppInstance?.id?[(0,s.h)("omfx-button",{domProps:{onClick:()=>{this.approveAppInstance()},styles:{bgColor:this.theming.body.fg.color.base},mode:l.ButtonModes.depressed,icon:{position:l.ButtonIconPosition.Right,small:!0,iconType:v}},attrs:{dark:this.theming.body.fg.dark,loading:this.isCreating,text:this.omniaUxLoc.Common.Buttons.Approve}}),(0,s.h)("omfx-button",{domProps:{onClick:()=>{this.showRejectDialog=!0},styles:{bgColor:this.theming.body.fg.color.base},mode:l.ButtonModes.flat,icon:{position:l.ButtonIconPosition.Right,small:!0,iconType:x}},attrs:{dark:this.theming.body.fg.dark,text:this.omniaUxLoc.Common.Buttons.Reject}})]:[(0,s.h)("omfx-button",{domProps:{onClick:()=>{this.onCompleteProvisioningSteps(n)},styles:{bgColor:this.theming.body.fg.color.base},mode:l.ButtonModes.depressed,icon:{position:l.ButtonIconPosition.Right,small:!0,iconType:i}},attrs:{dark:this.theming.body.fg.dark,loading:this.isCreating,text:t}})]}return e.isFeature?a.content=this.renderAppProvisioningFeatureComponent(o,e.elementToRender):a.content=this.renderAppProvisioningStepComponent(o,e.elementToRender),a}renderAppInstanceTemplatePickerComponent(e,t){return(0,s.h)(c.AppInstanceTemplatePickerVueComponent,{attrs:{appDefinitionId:e,showEnabledTemplatesOnly:t,handleTemplateSelected:this.onTemplateSelected,waitingAfterTemplateSelected:this.waitingAfterTemplateSelected,templatesToShow:this.templatesToShow}})}renderCompletedMessage(){return(0,s.h)("v-container",{class:"text-center",style:{maxWidth:"600px"}},[(0,s.h)("h2",{class:"my-10"},[this.omniaUxLoc.Apps.Messages.ApprovalRequestWasSent]),(0,s.h)("img",{style:{maxHeight:"30vh",maxWidth:"30vw"},attrs:{src:`${this.omniaUrl}/api/apps/image/app-request.svg?color=${encodeURIComponent(this.theming.body.fg.color.base)}`}}),(0,s.h)("h3",{class:"mt-8"},[this.omniaUxLoc.Apps.Messages.ApprovalConfirmation])])}renderRejectDialog(){const e=this.themeStore.getters.getThemingByTargetIdWithFallback(l.Constants.ux.themeTargetIds.layoutDialog.toString());return(0,s.h)("omfx-dialog",{attrs:{dark:e.body.bg.dark,valueBind:{visible:!0},maxWidth:"600",title:this.omniaUxLoc.Common.Buttons.Reject,themeTargetId:l.Constants.ux.themeTargetIds.layoutDialog.toString(),position:o.DialogPositions.Center},on:{close:()=>{this.showRejectDialog=!1}}},[(0,s.h)("v-card",{attrs:{dark:e.body.bg.dark,tile:!0,flat:!0}},[(0,s.h)("v-card-text",[(0,s.h)("v-textarea",{attrs:{dark:e.body.bg.dark,label:this.omniaUxLoc.Common.Comment},model:{value:this.rejectComment,callback:e=>{this.rejectComment=e}}}),(0,s.h)("div",{class:["v-text-field__details"],style:{minHeight:"24px"}},[(0,s.h)("omfx-field-validation",{domProps:{useValidator:this.formValidator,checkValue:this.rejectComment,rules:(new o.FieldValueValidation).IsRequired().getRules()}})])]),(0,s.h)("v-card-actions",[(0,s.h)("v-spacer"),(0,s.h)("omfx-button",{attrs:{dark:e.body.bg.dark,loading:this.isRejecting,contentClass:"shrink ml-2",text:this.omniaUxLoc.Common.Buttons.Ok},domProps:{mode:l.ButtonModes.flat,onClick:()=>{this.rejectAppInstance()}}}),(0,s.h)("omfx-button",{attrs:{dark:e.body.bg.dark,disabled:this.isRejecting,contentClass:"shrink ml-2",text:this.omniaUxLoc.Common.Buttons.Close},domProps:{mode:l.ButtonModes.flat,onClick:()=>{this.showRejectDialog=!1}}})])])])}render(){return this.isTemplateSelected?this.isCompleted?this.renderCompletedMessage():(0,s.h)("div",[(0,s.h)("omfx-wizard",{attrs:{horizontalMinHeight:this.horizontalMinHeight,isOnDialog:this.isOnDialog,defaultStepIndex:this.defaultStepIndex},domProps:{styles:this.styles,onInstanceCreated:this.onWizardInstanceCreated,steps:this.steps}}),this.showRejectDialog&&this.renderRejectDialog()]):this.renderAppInstanceTemplatePickerComponent(this.appDefinitionId,this.showEnabledTemplatesOnly)}};f([(0,a.Prop)()],P.prototype,"styles",2),f([(0,a.Prop)()],P.prototype,"initialAppTemplate",2),f([(0,a.Prop)()],P.prototype,"initialAppDefinition",2),f([(0,a.Prop)()],P.prototype,"initialAppInstance",2),f([(0,a.Prop)()],P.prototype,"templatesToShow",2),f([(0,a.Prop)({default:!1})],P.prototype,"isOnDialog",2),f([(0,a.Prop)()],P.prototype,"horizontalMinHeight",2),f([(0,p.Provide)(d.AppNamingPolicyValidationState)],P.prototype,"appNamingPolicyValidationState",2),f([(0,p.Provide)(o.AppPolicyValidationState)],P.prototype,"appPolicyValidationState",2),f([(0,p.Provide)(h.SummaryInfoState)],P.prototype,"summaryInfoState",2),f([(0,r.Inject)(o.ThemeStore)],P.prototype,"themeStore",2),P=f([n.default],P),p.WebComponentBootstrapper.registerElement((e=>{(0,p.vueCustomElement)(e.elementName,P)}))},"./client/fx/ux/appprovisioning/components/index.js":(e,t,i)=>{e.exports=i("dll-reference md32")("./client/fx/ux/appprovisioning/components/index.js")},"./client/fx/ux/appprovisioning/components/summaryinfo/summaryinfostate.js":(e,t,i)=>{e.exports=i("dll-reference md32")("./client/fx/ux/appprovisioning/components/summaryinfo/summaryinfostate.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,i)=>{e.exports=i("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,i)=>{e.exports=i("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,i)=>{e.exports=i("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,i)=>{e.exports=i("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,i)=>{e.exports=i("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"eff19cad-5557-434b-a477-1e1e2a70a2a0":(e,t,i)=>{e.exports=i("dll-reference md20")("eff19cad-5557-434b-a477-1e1e2a70a2a0")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md32":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["61540ff7-266a-4142-a42e-c62ba077f0b9"]},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]},"dll-reference md20":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff"])throw new Error("Error, already loaded manifest 9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["9de3fb35-2e0a-4b6e-b4b6-aadd7d4717ff"]=i;var t={};function i(o){var s=t[o];if(void 0!==s)return s.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};i("./client/fx/ux/appprovisioning/appprovisioningwizard/appprovisioningwizard.tsx")})()};