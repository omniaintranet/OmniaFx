if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["3cdfbb74-75f3-4a10-a9f1-7b63978d238b"])throw new Error("Error, already loaded manifest 3cdfbb74-75f3-4a10-a9f1-7b63978d238b with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["3cdfbb74-75f3-4a10-a9f1-7b63978d238b"]=function(){(()=>{var e={"./client/fx/ux/mediapickerproviders/centralimagelocationprovider/centralimagelocationprovider.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{CentralImageLocationProviderComponent:()=>I});var a,i=r("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),o=r("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),s=r("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),d=r("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","3cdfbb74-75f3-4a10-a9f1-7b63978d238b"),n=r("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),b=r("./client/fx/sp/services/index.js"),l=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d");(a||(a={})).namespace="Omnia.Ux.CentralImageLocationProvider";var m=r("./node_modules/typestyle/umd/typestyle.js");const c={foldersWrapper:(0,m.style)({display:"flex",flexWrap:"wrap"}),breadCrumbItem:(0,m.style)({$nest:{"&:hover":{transform:"scale(1.1);",cursor:"pointer"}}}),folderWrapper:(0,m.style)({width:"100px",textAlign:"center",$nest:{"&:hover":{transform:"scale(1.1);",cursor:"pointer"}}}),folderImage:(0,m.style)({maxHeight:"70px",maxWidth:"70px"}),folderImageInfo:(0,m.style)({display:"inline-block"})};var p=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),h=r("1682f669-2a99-45e6-aa8b-7ed3d4e538d5"),f=Object.defineProperty,u=Object.getOwnPropertyDescriptor,g=(e,t,r,a)=>{for(var i,o=a>1?void 0:a?u(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a?i(t,r,o):i(o))||o);return a&&o&&f(t,r,o),o};let I=class extends h.GridViewMediaProviderComponent{constructor(){super(),this.breadcrumb=[{title:"...",url:""}],this.itemLimit=100,this.folderItems=null,this.searchKeyword=null,this.nextPaginInfo=null,this.hasImageItem=!1,this.orderByFields=[{fieldName:"FSObjType",ascending:!1},{fieldName:"FileLeafRef",ascending:!0}],this.gridViewSlots={mediaSelectionTop:this.renderTopArea}}beforeSaved(e){return new Promise((t=>{t(e)}))}getMediaItems(e){return this.searchKeyword=e,new Promise(((e,t)=>{this.executeGettingItems().then((t=>{this.hasImageItem=t&&t.length>0,this.enableLoadMoreButton=this.folderItems&&this.folderItems.length>0||this.hasImageItem,e(t)})).catch(t)}))}getMoreMediaItems(e){return this.getMoreMediaItemsInternal()}getMediaInfo(e){return new Promise(((t,r)=>{e.mediaType==l.MediaPickerEnums.OmniaMediaTypes.Image&&this.getSPImageListItemBase64(e.id).then((r=>{e.fileName.split(".")[1];const a={mediaType:l.MediaPickerEnums.OmniaMediaTypes.Image,sizeInBytes:r.length*(3/4),base64:r,sourceUrl:e.imageUrl,fileName:e.fileName};t(a)})).catch(r)}))}created(){}mounted(){d.WebComponentBootstrapper.registerElementInstance(this,this.$el),this.initImages()}initImages(){this.toggleLoadingUI(!0,l.MediaPickerEnums.LoadingStyle.noOverlay),this.executeGettingItems().then((e=>{this.hasImageItem=e&&e.length>0,this.enableLoadMoreButton=this.folderItems&&this.folderItems.length>0||this.hasImageItem,this.setAllItems(e),this.toggleLoadingUI(!1)}))}executeGettingItems(e=!1){return e||(this.folderItems=[],this.nextPaginInfo="",this.hasImageItem=!1,this.enableLoadMoreButton=!1),new Promise(((e,t)=>{let r="";this.breadcrumb.length>1&&(r=this.breadcrumb[this.breadcrumb.length-1].url),this.listsService.getCentralImageLocationResult(this.imageLocationSettings.webUrl,this.imageLocationSettings.libraryId,this.searchKeyword,500,r,0,this.itemLimit,this.nextPaginInfo,this.orderByFields).then((t=>{if(t){t.items.forEach((e=>{e.thumbnailUrl&&!e.isFolder&&(e.thumbnailUrl=n.ImageProxyService.getUrlByImageApi(this.imageLocationSettings.webUrl,e.thumbnailUrl,!0))})),this.folderItems=this.folderItems.concat(t.items.filter((e=>e.isFolder)));const r=t.items.filter((e=>!e.isFolder));this.nextPaginInfo=t.nextPagingInfo,e(r)}else e([])})).catch(t)}))}getSPImageListItemBase64(e){return new Promise(((t,r)=>{this.toggleLoadingUI(!0,l.MediaPickerEnums.LoadingStyle.overlay),this.listsService.downloadImage(this.imageLocationSettings.webUrl,this.imageLocationSettings.libraryId,e).then((e=>{t(e)})).catch((()=>{this.toggleLoadingUI(!1),r()}))}))}getMoreMediaItemsInternal(){return new Promise(((e,t)=>{this.nextPaginInfo?this.executeGettingItems(!0).then((t=>{e(t)})).catch(t):e(null)}))}onSelectFolder(e){this.breadcrumb.push({title:e.name,url:e.serverRelativeUrl}),this.onCurrentFolderChanged()}onSelectBreadcrumb(e){this.breadcrumb=this.breadcrumb.filter((t=>t.url.length<e.url.length||t==e)),this.onCurrentFolderChanged()}onCurrentFolderChanged(){this.nextPaginInfo="",this.searchKeyword="",this.setSearchKeyword("")}renderTopArea(){return(0,i.h)("div",[this.renderBreadcrumb(),this.renderFolders()])}renderFolders(){if(!this.folderItems||0===this.folderItems.length)return null;const e=[],t=p.ServiceLocator.getUrl(l.OmniaService.Id,!0).toLowerCase();return this.folderItems.forEach((r=>{e.push((0,i.h)("div",{class:["mb-2",c.folderWrapper],on:{click:()=>{this.onSelectFolder(r)}}},[(0,i.h)("img",{class:c.folderImage,attrs:{src:`${t}/api/webimage/folder`}}),(0,i.h)("br"),(0,i.h)("div",{class:c.folderImageInfo},[r.name])]))})),(0,i.h)("div",{class:c.foldersWrapper},[e])}renderBreadcrumb(){return this.breadcrumb&&1!=this.breadcrumb.length?this.breadcrumb.map((e=>(0,i.h)("span",[(0,i.h)("a",{class:c.breadCrumbItem,on:{click:()=>{this.onSelectBreadcrumb(e)}}},[e.title]),"  / "]))):null}render(){return this.renderGridViewProvider()}};g([(0,s.Prop)()],I.prototype,"imageLocationSettings",2),g([(0,p.Inject)(b.ListsService)],I.prototype,"listsService",2),g([(0,d.Localize)(a.namespace)],I.prototype,"imageLocationLoc",2),I=g([o.default],I),d.WebComponentBootstrapper.registerElement((e=>{(0,d.vueCustomElement)(e.elementName,I)}))},"./client/fx/sp/services/index.js":(e,t,r)=>{e.exports=r("dll-reference md20")("./client/fx/sp/services/index.js")},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/typestyle/umd/typestyle.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/typestyle/umd/typestyle.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,r)=>{e.exports=r("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"1682f669-2a99-45e6-aa8b-7ed3d4e538d5":(e,t,r)=>{e.exports=r("dll-reference md66")("1682f669-2a99-45e6-aa8b-7ed3d4e538d5")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,r)=>{e.exports=r("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,r)=>{e.exports=r("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,r)=>{e.exports=r("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]},"dll-reference md20":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["3cdfbb74-75f3-4a10-a9f1-7b63978d238b"])throw new Error("Error, already loaded manifest 3cdfbb74-75f3-4a10-a9f1-7b63978d238b with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["3cdfbb74-75f3-4a10-a9f1-7b63978d238b"]=r;var t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};r("./client/fx/ux/mediapickerproviders/centralimagelocationprovider/centralimagelocationprovider.tsx")})()};