if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"])throw new Error("Error, already loaded manifest fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"]=function(){(()=>{var e={"eff19cad-5557-434b-a477-1e1e2a70a2a0":(e,t,r)=>{"use strict";r.r(t),r.d(t,{AppNamingPolicyHelperStore:()=>v.AppNamingPolicyHelperStore,AppNamingPolicyValidationState:()=>A,AssociatedGroup:()=>y.AssociatedGroup,CurrentTermToken:()=>v.CurrentTermToken,EnterpriseGlossaryTermInformation:()=>y.EnterpriseGlossaryTermInformation,EnterpriseKeywordDisplayStyles:()=>y.EnterpriseKeywordDisplayStyles,ListsService:()=>L.ListsService,Parameters:()=>y.Parameters,PrincipalService:()=>L.PrincipalService,ResourceEvaluators:()=>y.ResourceEvaluators,SecurityRoles:()=>u,SharePointBusinessProfileRelativePathValue:()=>y.SharePointBusinessProfileRelativePathValue,SharePointContext:()=>n.SharePointContext,SharePointPermissionRoles:()=>y.SharePointPermissionRoles,SharePointTaxonomyGlossary:()=>y.SharePointTaxonomyGlossary,SharePointTaxonomyGlossaryStore:()=>v.SharePointTaxonomyGlossaryStore,SharePointTermEnterpriseGlossaryStyles:()=>y.SharePointTermEnterpriseGlossaryStyles,SharePointTermGlossarySelectedMessage:()=>y.SharePointTermGlossarySelectedMessage,SharepointDateTimeFormatter:()=>S,SiteService:()=>L.SiteService,StringMatchOption:()=>L.StringMatchOption,TargetingFilterStyles:()=>y.TargetingFilterStyles,TaxonomyDisplayStyles:()=>y.TaxonomyDisplayStyles,TaxonomyFieldSettingsStyles:()=>y.TaxonomyFieldSettingsStyles,TermItemRendererMode:()=>O,TermNavigationStore:()=>v.TermNavigationStore,TermOrganizationFilterByCustomProperty:()=>y.TermOrganizationFilterByCustomProperty,TermOrganizationFilterByTermId:()=>y.TermOrganizationFilterByTermId,TermOrganizationFilterType:()=>y.TermOrganizationFilterType,TermPickerStyles:()=>y.TermPickerStyles,TermService:()=>L.TermService,TermSetPickerStyles:()=>y.TermSetPickerStyles,TermStore:()=>v.TermStore,TermToken:()=>w,TermTreeComponentBase:()=>j,TermTreeStyles:()=>y.TermTreeStyles,UserService:()=>L.UserService});var s=r("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"),i=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),a=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=r("85942510-7199-4382-9e25-082d1ebc7ab0"),o=Object.defineProperty,l=Object.getOwnPropertyDescriptor;let p=class extends i.HttpClient{constructor(){super(i.HttpClient.createSPServiceRequestConfig(i.ServiceContainer.createInstance(n.SharePointContext).enviroment.authorityUrl))}};var m,c,d,h;p=((e,t,r,s)=>{for(var i,a=s>1?void 0:s?l(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&o(t,r,a),a})([(0,i.Injectable)({lifetime:a.InstanceLifetimes.Transient})],p),s.omniaScriptApi.spfx={sharepointClient:new Promise((e=>{e(i.ServiceContainer.createInstance(p))}))};class u{}u.SharePointSiteCollection=((m=class{}).Admin="3b7dc0fa-6343-4e69-9292-abf31b9156dd",m),u.SharePointSite=((c=class{}).Admin="83825019-4767-4b39-9813-0af8692e31a9",c),u.SharePointList=((d=class{}).FullControl="83825019-4767-4b39-9813-0af8692e31a9",d),u.SharePointListItem=((h=class{}).FullControl="9c36be2b-ab36-4fd9-bcfb-23c7a952f0b4",h.Editor="f401a8c8-2066-4505-84e3-08940f2878d1",h);var g=Object.defineProperty,f=Object.getOwnPropertyDescriptor;class S{constructor(){this.getFormatter=()=>({timeformat:this.spContext.pageContext.legacyPageContext.userTime24?"24hr":"ampm",locale:this.spContext.pageContext.cultureInfo.currentUICultureName,firstdayofweek:this.spContext.pageContext.legacyPageContext.webFirstDayOfWeek})}}((e,t,r,s)=>{for(var i,a=s>1?void 0:s?f(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);s&&a&&g(t,r,a)})([(0,s.Inject)(n.SharePointContext)],S.prototype,"spContext",2);
//! <omnia-transform-resource path="76ee2aef-c893-407c-8e37-05b8e556caf0" />
var y=r("bf86b3f8-7274-47e4-9e27-87ae1cf65a23"),b=r("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),T=r("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),P=r("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"),v=r("./client/fx/sp/stores/index.js"),I=r("5e618f4d-d014-414e-a681-89e34cbeda0f");P.StyleFlow.define(y.TermTreeStyles,{termItemContainer:{width:"100%"},termItemInner:{display:"flex",alignItems:"center"},expansionCell:{flex:"0 0 40px",width:"40px",height:"36px"},termNameCell:{flex:"1 1 auto"},termMapperCell:{flex:"0 0 auto"},childTermContainer:{paddingLeft:"5px",width:"100%"}});var x=Object.defineProperty,C=Object.getOwnPropertyDescriptor,D=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?C(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&x(t,r,a),a};//! <omnia-transform-resource path="407fff02-ae37-4cb3-a79e-88e177e417b2" />
class j extends P.VueComponentBase{constructor(){super(),this.lcid=null,this.expandedTerms=[],this.termTreeStyles=P.StyleFlow.use(y.TermTreeStyles),this.termStore=i.ServiceContainer.createInstance(v.TermStore),this.multilingualStore=i.ServiceContainer.createInstance(I.MultilingualStore),this.lcid=this.termStore.getters.getDisplayLCID()}renderTerm(e){const t=this.expandedTerms.findIndex((t=>t==e.id))>=0;return(0,b.h)("div",{class:this.termTreeStyles.termItemContainer},[(0,b.h)("div",{class:[this.termTreeStyles.termItemInner,"py-1"]},[(0,b.h)("div",{class:this.termTreeStyles.expansionCell},[e.termsCount>0&&(0,b.h)("omfx-button",{attrs:{dark:this.theming.body.bg.dark,small:!0,contentClass:"ml-0 mr-0"},domProps:{mode:a.ButtonModes.icon,onClick:t=>{const r=this.expandedTerms.findIndex((t=>t==e.id));r>=0?this.expandedTerms.splice(r,1):(this.expandedTerms.push(e.id),this.termStore.actions.ensureChildTerms.dispatch(this.termSetId,e.id))},icon:{iconType:t?new a.FontAwesomeIcon("keyboard_arrow_up"):new a.FontAwesomeIcon("keyboard_arrow_down")}}})]),(0,b.h)("div",{class:this.termTreeStyles.termNameCell},[this.lcid?this.termStore.getters.getDisplayTermByLanguage(this.lcid,this.termSetId,e.id):e.name]),this.actionButtons&&(0,b.h)("div",{class:this.termTreeStyles.termMapperCell},[this.actionButtons(e)])]),this.renderChildTerms(e)])}renderChildTerms(e){if(!(this.expandedTerms.findIndex((t=>t==e.id))>=0))return null;const t=this.termStore.getters.getChildrenTerms(this.termSetId,e.id,this.lcid);return t&&0!=t.length?(0,b.h)("div",{class:this.termTreeStyles.childTermContainer},[t.map((e=>this.renderTerm(e)))]):(0,b.h)("div",{class:this.termTreeStyles.childTermContainer},[(0,b.h)("div",{class:"text-center"},[(0,b.h)("v-progress-circular",{attrs:{indeterminate:!0}})])])}renderBase(){const e=this.termStore.getters.getChildrenTerms(this.termSetId,null,this.lcid);return(0,b.h)("div",[e&&e.map((e=>this.renderTerm(e)))])}}D([(0,T.Prop)()],j.prototype,"termSetId",2),D([(0,T.Prop)()],j.prototype,"actionButtons",2);var O=(e=>(e[e.Normal=0]="Normal",e[e.Compact=1]="Compact",e))(O||{}),L=r("./client/fx/sp/services/index.js");class w extends a.TokenDefinition{constructor(){super(...arguments),this.prefixToken="CurrentTerm"}}class N{resolve(e){return new a.TokenValue(w,"",{})}}(0,s.extendApi)((e=>e.fx.tokens.providers),(e=>{e.register(new a.TokenProviderRegistration([w],N))}));var M=Object.defineProperty,G=Object.getOwnPropertyDescriptor,k=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?G(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&M(t,r,a),a};let A=class{constructor(){this.validationStateChangedMessageBus=new s.MessageBusTopicMediator({namespace:"omnia.namingpolicyvalidation",name:"statechanged"+s.Utils.generateGuid()}),this.validationState=null,this.onValidationStateChanged=this.validationStateChangedMessageBus}ensureValidationStateWithAppInstance(e){return new Promise(((t,r)=>{Promise.all([this.appNamingPolicyStore.actions.ensureLoad.dispatch(e.appDefinitionId),this.appStore.actions.loadAppTemplates.dispatch(e.businessProfileId),this.appNamingPolicyHelperStore.ensureReady(e)]).then((()=>{const r=this.appStore.getters.getAppTemplate(e.appTemplateId);if(r.properties.policies?.namingPolicyId){const t=this.appNamingPolicyStore.getters.getById(r.properties.policies.namingPolicyId);this.ensureValidationState(e,t)}else this.ensureValidationState(e,null);t()}))}))}ensureValidationStateWithAppInstanceAndPolicy(e,t){return new Promise(((r,s)=>{this.appNamingPolicyHelperStore.ensureReady(e).then((()=>{this.ensureValidationState(e,t),r()}))}))}parseTitle(e){return this.validationState?this.appNamingPolicyHelperStore.parseByPolicy(e,this.validationState.titlePrefix,this.validationState.titleSuffix,this.validationState.namingPolicy.definition.blockedWords):null}parseAlias(e){return this.validationState?(e=s.Utils.makeFriendlyUrl(e,!1),this.appNamingPolicyHelperStore.parseByPolicy(e,this.validationState.aliasPrefix,this.validationState.aliasSuffix,this.validationState.namingPolicy.definition.blockedWords)):null}getExistingBlockWord(e){return this.validationState&&e?this.appNamingPolicyHelperStore.getExistingBlockWord(e,this.validationState.namingPolicy.definition.blockedWords):null}ensureValidationState(e,t){if(t){const r=this.appNamingPolicyHelperStore.getAppAffixDefinitionValues(e.enterpriseProperties,t);this.ensureProxy(r,e),this.ensureValidationStateWithNamingPolicy(t,r)}else this.validationState=null}ensureProxy(e,t){for(const r of e)r.type===a.PropertyIndexedType.Taxonomy||r.type===a.PropertyIndexedType.EnterpriseKeywords?Object.defineProperty(r,(0,i.propertyPath)()("termIds"),{get:()=>t.enterpriseProperties[r.internalName]||[],set:e=>{t.enterpriseProperties[r.internalName]=e,this.ensureValidationStateWithNamingPolicy(this.validationState.namingPolicy,this.validationState.appAffixDefinitionValues),this.validationStateChangedMessageBus.publish()}}):r.type===a.PropertyIndexedType.Number&&Object.defineProperty(r,(0,i.propertyPath)()("numberValue"),{get:()=>t.enterpriseProperties[r.internalName]||null,set:e=>{t.enterpriseProperties[r.internalName]=e,this.ensureValidationStateWithNamingPolicy(this.validationState.namingPolicy,this.validationState.appAffixDefinitionValues),this.validationStateChangedMessageBus.publish()}})}ensureValidationStateWithNamingPolicy(e,t){this.validationState={appAffixDefinitionValues:t,namingPolicy:e,...this.appNamingPolicyHelperStore.getAffixes(e,t),generateAliasByTitle:e=>{const t=this.parseTitle(e);return this.parseAlias(t.value).value}}}};k([(0,s.Inject)(v.AppNamingPolicyHelperStore)],A.prototype,"appNamingPolicyHelperStore",2),k([(0,s.Inject)(I.AppStore)],A.prototype,"appStore",2),k([(0,s.Inject)(I.AppNamingPolicyStore)],A.prototype,"appNamingPolicyStore",2),A=k([(0,s.Injectable)({lifetime:a.InstanceLifetimes.Scoped})],A)}
//! <omnia-transform-resource path="eff19cad-5557-434b-a477-1e1e2a70a2a0" />
,"./client/fx/sp/services/listsservice.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{ListsService:()=>p});var s=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),i=r("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),a=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,l=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?o(t,r):t,l=e.length-1;l>=0;l--)(i=e[l])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&n(t,r,a),a};let p=class{constructor(){this.resolveLibraryUrl=(e,t)=>this.httpClient.get("api/lists/libraries?spUrl="+e+"&libraryUrl="+t).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.resolveLibraryFromAbsoluteUrl=e=>this.httpClient.get("api/lists/libraries/absoluteurl",{params:{absoluteUrl:e}}).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.downloadImage=(e,t,r)=>{const s={SPUrl:e,id:r,listId:t};return this.httpClient.get(`api/lists/libraries/${t.toString()}/image`,{params:s}).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage)))},this.getCentralImageLocationResult=(e,t,r,s,i="",n=0,o=-1,l="",p=[])=>{const m={itemLimit:o,skipId:n,TextSearch:r,pagingInfo:l,orderByFields:p},c={SPUrl:e,folderServerRelativeUrl:r?"":i,recursive:!!r};return this.httpClient.post(`api/lists/libraries/${t.toString()}/centralimagelocationresult`,m,{params:c}).then((e=>e.data.success?(e.data.data.items.forEach((e=>{const t=e;e.name=t.fileName,e.thumbnailUrl=t.imageThumbnailUrl,e.mediaType=a.MediaPickerEnums.OmniaMediaTypes.Image})),Promise.resolve(e.data.data)):Promise.reject(e.data.errorMessage)))}}};l([(0,s.Inject)(i.OmniaContext)],p.prototype,"omniaContext",2),l([(0,s.Inject)(s.HttpClient,{configPromise:s.HttpClient.createOmniaServiceRequestConfig()})],p.prototype,"httpClient",2),p=l([(0,s.Injectable)({lifetime:a.InstanceLifetimes.Transient})],p)},"./client/fx/sp/services/principalservice.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{PrincipalService:()=>l});var s=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),i=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,r,s)=>{for(var i,o=s>1?void 0:s?n(t,r):t,l=e.length-1;l>=0;l--)(i=e[l])&&(o=(s?i(t,r,o):i(o))||o);return s&&o&&a(t,r,o),o};let l=class{constructor(){this.getSiteGroupView=e=>new Promise(((t,r)=>{this.httpClient.post("api/sharepointprincipal/getsitegroupview",e).then((e=>{e.data.success?t(e.data.data):r(e.data.errorMessage)}))})),this.updateSiteGroupMembership=e=>new Promise(((t,r)=>{this.httpClient.post("api/sharepointprincipal/updatesitegroupmembership",e).then((e=>{e.data.success?t():r(e.data.errorMessage)}))}))}};o([(0,s.Inject)(s.HttpClient,{configPromise:s.HttpClient.createOmniaServiceRequestConfig()})],l.prototype,"httpClient",2),l=o([(0,s.Injectable)({lifetime:i.InstanceLifetimes.Singelton})],l)},"./client/fx/sp/services/siteservice.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{SiteService:()=>p});var s=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),i=r("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),a=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,l=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?o(t,r):t,l=e.length-1;l>=0;l--)(i=e[l])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&n(t,r,a),a};let p=class{constructor(){this.getSiteContext=e=>this.httpClient.get(`api/sites/context?spUrl=${encodeURIComponent(e)}`).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.checkSiteCollectionStatus=e=>this.httpClient.get(`api/sites/checksitecollectionstatus?siteUrl=${encodeURIComponent(e)}`).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.validateSiteAlias=e=>new Promise(((t,r)=>{this.httpClient.post("api/sites/validatesitealias",e).then((e=>{e.data.success?t(e.data.data):r(e.data.errorMessage)})).catch(r)})),this.validateM365GroupNamingPolicy=e=>new Promise(((t,r)=>{this.httpClient.post("api/sites/validatem365groupnamingpolicy",e).then((e=>{e.data.success?t(e.data.data):r(e.data.errorMessage)})).catch(r)}))}};l([(0,s.Inject)(i.OmniaContext)],p.prototype,"omniaContext",2),l([(0,s.Inject)(s.HttpClient,{configPromise:s.HttpClient.createOmniaServiceRequestConfig()})],p.prototype,"httpClient",2),p=l([(0,s.Injectable)({lifetime:a.InstanceLifetimes.Transient})],p)},"./client/fx/sp/services/termservice.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{StringMatchOption:()=>p,TermService:()=>m});var s=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),i=r("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),a=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,l=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?o(t,r):t,l=e.length-1;l>=0;l--)(i=e[l])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&n(t,r,a),a},p=(e=>(e[e.StartsWith=0]="StartsWith",e[e.ExactMatch=1]="ExactMatch",e))(p||{});let m=class{constructor(){this.getTermByQuery=e=>this.httpClient.post("api/terms/query",e).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getTermStoreWorkingLanguages=()=>this.httpClient.get("api/terms/termstoreworkinglanguages").then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getTermStoreDefaultLanguage=()=>this.httpClient.get("api/terms/termstoredefaultlanguage").then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getTermSetWithTermsById=e=>this.httpClient.get("api/terms/termsetid?termSetId="+e+"&includeTerms=true").then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getTermSetById=e=>this.httpClient.get(`api/terms/termsets/${e}`,{params:{termSetId:e}}).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getKeywordTermSet=()=>this.httpClient.get("api/terms/keywordstermset").then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getByIds=e=>this.httpClient.post("api/terms/ids",e).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getChildTermsInTermSet=(e,t)=>this.httpClient.get(`api/terms/termsets/${e}/childs`,{params:{termSetId:e,termId:t}}).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.addTerm=(e,t,r)=>this.httpClient.post("api/terms/add",null,{params:{termSetId:e,parentTermId:r,termName:t}}).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.searchTerm=(e,t,r)=>this.httpClient.get("api/terms/search",{params:{termSetId:e,searchText:t,lcid:r}}).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.getAllTermGroupsWithTermSets=()=>this.httpClient.get("api/terms/termgroups/all?includeTermSets=true").then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.addOrUpdateTermCustomProperties=(e,t)=>this.httpClient.post(`api/terms/customproperty/${e}`,t).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage))),this.removeTermCustomProperties=(e,t)=>this.httpClient.post("api/terms/customproperty",t,{params:{termId:e}}).then((e=>e.data.success?Promise.resolve(e.data.data):Promise.reject(e.data.errorMessage)))}};l([(0,s.Inject)(i.OmniaContext)],m.prototype,"omniaContext",2),l([(0,s.Inject)(s.HttpClient,{configPromise:s.HttpClient.createOmniaServiceRequestConfig()})],m.prototype,"httpClient",2),m=l([(0,s.Injectable)({lifetime:a.InstanceLifetimes.Transient})],m)},"./client/fx/sp/services/userservice.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{UserService:()=>l});var s=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),i=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,r,s)=>{for(var i,o=s>1?void 0:s?n(t,r):t,l=e.length-1;l>=0;l--)(i=e[l])&&(o=(s?i(t,r,o):i(o))||o);return s&&o&&a(t,r,o),o};let l=class{constructor(){this.currentProfileProperties=null,this.getSPProfilePropertyNames=()=>(this.currentProfileProperties||this.ensureSPProfilePropertiesFromServer(),this.currentProfileProperties.then((e=>Object.keys(e)))),this.getSPProfileProperties=()=>(this.currentProfileProperties||this.ensureSPProfilePropertiesFromServer(),this.currentProfileProperties.then((e=>s.Utils.clone(e)))),this.setupUserProfile=()=>new Promise(((e,t)=>{this.httpClient.post("api/users/setupuserprofile").then((r=>{r.data.success?e():t()})).catch((e=>{t()}))})),this.ensureSPProfilePropertiesFromServer=()=>{this.currentProfileProperties=this.httpClient.get("api/users/sharepoint/profileproperties").then((e=>{if(e.data.success)return e.data.data;throw e.data.errorMessage}))},this.getSharePointUserName=e=>e?new Promise(((t,r)=>{this.httpClient.get("api/users/getsharepointusername?principalName="+e).then((e=>{e.data.success?t(e.data.data):r()})).catch((e=>{r()}))})):Promise.resolve("")}};o([(0,s.Inject)(s.HttpClient,{configPromise:s.HttpClient.createOmniaServiceRequestConfig()})],l.prototype,"httpClient",2),l=o([(0,s.Injectable)({lifetime:i.InstanceLifetimes.Singelton})],l)},"./client/fx/sp/services/index.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{ListsService:()=>n.ListsService,PrincipalService:()=>o.PrincipalService,SiteService:()=>a.SiteService,StringMatchOption:()=>s.StringMatchOption,TermService:()=>s.TermService,UserService:()=>i.UserService});var s=r("./client/fx/sp/services/termservice.js"),i=r("./client/fx/sp/services/userservice.js"),a=r("./client/fx/sp/services/siteservice.js"),n=r("./client/fx/sp/services/listsservice.js"),o=r("./client/fx/sp/services/principalservice.js")},"./client/fx/sp/stores/index.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{AppNamingPolicyHelperStore:()=>C,CurrentTermToken:()=>T,SharePointTaxonomyGlossaryStore:()=>S,TermNavigationStore:()=>P,TermStore:()=>c});var s=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),i=r("97786ea9-4861-48bd-8a57-eae9bbdb4892"),a=r("5e618f4d-d014-414e-a681-89e34cbeda0f"),n=r("./client/fx/sp/services/termservice.js"),o=r("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830"),l=Object.defineProperty,p=Object.getOwnPropertyDescriptor,m=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?p(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&l(t,r,a),a};let c=class extends a.Store{constructor(){super(...arguments),this.termSets=this.state({}),this.termSetDefinitions=this.state({}),this.termGroupsWithTermSets=this.state(),this.termStoreWorkingLanguages=this.state([]),this.ensureTermGroupsPromise=null,this.ensureTermSetDefinitionPromises={},this.ensureTermSetDefinitionWithAllTermPromises={},this.ensureTermPromises={},this.ensureChildrenPromises={},this.ensureTermStoreWorkingLanguagesPromise=null,this.keywordTermSetPromise=null,this.inProgressTermIdsRequest=null,this.parentTermSetMapper={},this.getters={getTermStoreWorkingLanguages:()=>this.termStoreWorkingLanguages.state,getOmniaTenantLanguageNotWorkingInTermStore:()=>{const e=[],t=this.termStoreWorkingLanguages.state,r=this.multilingualStore.getters.languageSetting(s.MultilingualScopes.Tenant).availableLanguages;for(const s of r){t.find((e=>e.lcid==s.lcid))||e.push(s)}return e},getTermSetById:e=>{const t=e.toString().toLowerCase();return this.termSetDefinitions.state[t]},getAllTerms:(e,t)=>{const r=e.toString().toLowerCase(),s=[];return this.termSets.state[r]&&this.termSets.state[r].terms&&Object.keys(this.termSets.state[r].terms).forEach((e=>{let i=this.termSets.state[r].terms[e];i&&(i=this.parseTermDataWithLCID(i,t),s.push(i))})),s},getTermById:(e,t,r)=>{const s=e.toString().toLowerCase(),i=t.toString().toLowerCase();if(this.termSets.state[s]&&this.termSets.state[s].terms){let e=this.termSets.state[s].terms[i];if(e)return e=this.parseTermDataWithLCID(e,r),e}return null},getTermByIds:(e,t,r)=>{const s=e.toString().toLowerCase(),i=t.map((e=>e.toString().toLowerCase())),a=[],n=this.termSets.state[s];return n&&n.terms&&i.forEach((e=>{let t=n.terms[e];t&&(t=this.parseTermDataWithLCID(t,r),a.push(t))})),a},getPathOfTerm:(e,t,r)=>{let a="";const n=this.termSets.state[t.toString()];let o=n.terms[r.id.toString()];if(o){if(o.parentId.toString()==s.Guid.empty.toString())return"";for(;o.parentId.toString()!=t;){if(o=n.terms[o.parentId.toString()],!o)return"";a+=o.labels[e]+" / "}return a.length>0&&(a=a.slice(0,-3)),a}{let e="";const t=i.Utils.isNullOrEmpty(r.pathOfTerm)?"":r.pathOfTerm.split(";");if(t.length>1)for(let r=0,s=t.length-1;r<s;r++)e+=r==s-1?t[r]:t[r]+" / ";return e}},getChildrenTerms:(e,t,r)=>{const i=this.termSets.state[e.toString().toLowerCase()],a=[];if(i&&i.terms)if(null==t)Object.keys(i.terms).forEach((e=>{if(i.terms[e].parentId.toString()==s.Guid.empty){const t=this.parseTermDataWithLCID(i.terms[e]);a.push(t)}}));else{const e=t.toString().toLowerCase();Object.keys(i.terms).forEach((t=>{if(i.terms[t].parentId.toString().toLowerCase()==e){const e=this.parseTermDataWithLCID(i.terms[t]);a.push(e)}}))}return a},getDisplayTermByLanguage:(e,t,r)=>{const s=this.termSets.state[t.toString().toLowerCase()].terms[r.toString().toLowerCase()];return this.getTermTitleByLCID(s,e)},getTermDisplayTitle:(e,t,r)=>{let s="";return t||(t=this.getters.getDisplayLanguageName()),s=this.getTermTitleByLanguageName(e,t),s||(r||(r=this.getters.getDisplayLCID()),s=this.getTermTitleByLCID(e,r)),s||(s=e.name),s},getTermGroupsWithTermSets:e=>{const t=[];return this.termGroupsWithTermSets.state.forEach((r=>{const s={id:r.id,name:r.name,termSets:[],termStoreId:r.termStoreId};r.termSets.forEach((t=>{s.termSets.push(this.parseTermDataWithLCID(t,e))})),t.push(s)})),t},getDisplayLCID:()=>{let e=0;const t=this.multilingualStore.getters.languageSetting(s.MultilingualScopes.BusinessProfile);if(t.availableLanguages.length>0){const r=t.availableLanguages.find((e=>e.name==t.userPreferredLanguageTag.toLowerCase()));r&&(e=r.lcid)}return e},getDisplayLanguageName:()=>{const e=this.multilingualStore.getters.languageSetting(s.MultilingualScopes.BusinessProfile);return this.omniaContext?.language||(e.availableLanguages&&e.availableLanguages.length>0?e.availableLanguages[0].name:"en-us")}},this.mutations={addCreatedTerm:this.mutation((e=>{this.privateMutations.updateTerms([e],!0)}))},this.privateMutations={updateTermSet:e=>{if(e&&e.length>0){const t=Object.assign({},this.termSetDefinitions.state);e.forEach((e=>{const r=e.id.toString().toLowerCase();t[r]=e,this.ensureTermSetDefinitionPromises[r]||(this.ensureTermSetDefinitionPromises[r]=Promise.resolve(null))})),this.termSetDefinitions.mutate(t)}},updateTerms:(e,t=!1)=>{if(e&&e.length>0){const r=Object.assign({},this.termSets.state);e.forEach((e=>{const s=e.termSetId.toString().toLowerCase(),i=e.id.toString().toLowerCase(),a=e.parentId?e.parentId.toString().toLowerCase():"";r[s]||(r[s]={terms:{}}),t&&!r[s].terms[i]&&r[s].terms[a]&&(r[s].terms[a].termsCount+=1),r[s].terms[i]=e,this.ensureTermPromises[i]||(this.ensureTermPromises[i]=Promise.resolve(null))})),this.termSets.mutate(r)}}},this.actions={ensureTermStoreWorkingLanguages:this.action((()=>(this.ensureTermStoreWorkingLanguagesPromise||(this.ensureTermStoreWorkingLanguagesPromise=this.termService.getTermStoreWorkingLanguages().then((e=>(this.termStoreWorkingLanguages.mutate(e),null)))),this.ensureTermStoreWorkingLanguagesPromise))),ensurekeywordTermSet:this.action((()=>(this.keywordTermSetPromise||(this.keywordTermSetPromise=this.termService.getKeywordTermSet()),this.keywordTermSetPromise))),ensureTermSet:this.action((e=>{const t=e.toString().toLowerCase();let r=this.ensureTermGroupsPromise||this.ensureTermSetDefinitionPromises[t];return r||(this.ensureTermSetDefinitionPromises[t]=this.termService.getTermSetById(e).then((e=>(e&&this.privateMutations.updateTermSet([e]),null))),r=this.ensureTermSetDefinitionPromises[t]),r.then((()=>this.getters.getTermSetById(e)))})),ensureTermSetWithAllTerms:this.action((e=>{const t=e.toString().toLowerCase();let r=this.ensureTermSetDefinitionWithAllTermPromises[t];return r||(this.ensureTermSetDefinitionWithAllTermPromises[t]=this.termService.getTermSetWithTermsById(e).then((e=>{if(e){const t=e.terms.map(this.parseToTermData),r=Object.assign({},e,{terms:null});this.privateMutations.updateTermSet([r]),this.privateMutations.updateTerms(t)}return null})),r=this.ensureTermSetDefinitionWithAllTermPromises[t]),r})),ensureTermByIds:this.action(((e,t,r)=>{const a=e.toString().toLowerCase();t=t||[];const n=[],o=[],l=[];return this.ensureTermSetDefinitionWithAllTermPromises[a]?n.push(this.ensureTermSetDefinitionWithAllTermPromises[a]):t.forEach((e=>{const t=e.toString().toLowerCase();if(i.Utils.isValidGuid(t)){if(this.parentTermSetMapper[t]&&0!=this.parentTermSetMapper[t].length){if(this.parentTermSetMapper[t]&&this.parentTermSetMapper[t].length>0){const e=this.parentTermSetMapper[t].find((e=>e==a));i.Utils.isNullOrEmpty(e)&&this.parentTermSetMapper[t].push(a)}}else this.parentTermSetMapper[t]=[],this.parentTermSetMapper[t].push(a);this.ensureTermPromises[t]||(this.ensureTermPromises[t]=new Promise(((e,t)=>{o.push(e)})),l.push(e)),n.push(this.ensureTermPromises[t])}})),o.length>0&&(null==this.inProgressTermIdsRequest?this.inProgressTermIdsRequest={id:s.Guid.newGuid(),termIdsToResolve:l,resolvers:o}:(this.inProgressTermIdsRequest.termIdsToResolve=[...this.inProgressTermIdsRequest.termIdsToResolve,...l],this.inProgressTermIdsRequest.resolvers=[...this.inProgressTermIdsRequest.resolvers,...o]),i.Utils.timewatch(this.inProgressTermIdsRequest.id.toString(),(()=>{const e=this.inProgressTermIdsRequest;this.termService.getByIds(e.termIdsToResolve).then((t=>{if(t&&t.length>0){const e=[];t.forEach((t=>{if(t.isReused){this.parentTermSetMapper[t.id.toString().toLowerCase()].filter((e=>e!=t.termSetId.toString().toLowerCase())).forEach((r=>{const s=Object.assign({},t);s.termSetId=r,e.push(s)}))}}));const r=(t=[...t,...e]).map(this.parseToTermData);this.privateMutations.updateTerms(r)}e.resolvers.forEach((e=>e()))})),this.inProgressTermIdsRequest=null}),20)),Promise.all(n).then((()=>this.getters.getTermByIds(e,t,r)))})),addTerm:this.action(((e,t,r)=>this.termService.addTerm(e,t,r).then((e=>{if(e){const t=this.parseToTermData(e);this.mutations.addCreatedTerm.commit(t)}return this.getters.getTermById(e.termSetId,e.id)})))),searchTerm:this.action(((e,t,r)=>this.termService.searchTerm(e,t,r).then((e=>{let t=[];return e&&(t=e.map(this.parseToTermData),this.privateMutations.updateTerms(t)),t})))),ensureChildTerms:this.action(((e,t=null)=>{const r=e.toString().toLowerCase(),i=null!=t?t.toString().toLowerCase():"",a=i.length>0?i:r;let n=this.ensureChildrenPromises[a];return n&&null!=t||(this.ensureChildrenPromises[a]=this.termService.getChildTermsInTermSet(e,t).then((e=>{if(null==t&&null!=this.termSets.state[r]&&null!=this.termSets.state[r].terms){const e=this.termSets.state[r].terms;Object.keys(e).forEach((t=>{e[t].parentId.toString()==s.Guid.empty&&delete e[t]})),this.termSets.state[r]={terms:Object.assign({},e)}}if(e&&e.length>0){const t=e.map(this.parseToTermData);this.privateMutations.updateTerms(t)}return null})),n=this.ensureChildrenPromises[a]),n.then((()=>this.getters.getChildrenTerms(e,t)))})),ensureAllTermGroups:this.action((()=>(this.ensureTermGroupsPromise||(this.ensureTermGroupsPromise=this.termService.getAllTermGroupsWithTermSets().then((e=>{if(e){let t=[];return e.forEach((e=>{e.termSets&&(t=t.concat(e.termSets))})),this.termGroupsWithTermSets.mutate(e),this.privateMutations.updateTermSet(t),null}}))),this.ensureTermGroupsPromise))),addOrUpdateTermCustomProperties:this.action(((e,t)=>new Promise(((r,s)=>{this.termService.addOrUpdateTermCustomProperties(e,t).then((e=>{this.getters.getTermById(e.termSetId,e.id)&&this.privateMutations.updateTerms([this.parseToTermData(e)]),r()})).catch(s)})))),removeTermCustomProperties:this.action(((e,t)=>new Promise(((r,s)=>{this.termService.removeTermCustomProperties(e,t).then((e=>{this.getters.getTermById(e.termSetId,e.id)&&this.privateMutations.updateTerms([this.parseToTermData(e)]),r()})).catch(s)})))),getTermByQuery:this.action((e=>new Promise(((t,r)=>{this.termService.getTermByQuery(e).then((r=>{if(r){const t=[];r.current&&t.push(r.current),r.parents&&r.parents.forEach((e=>{t.push(e)})),r.childrens&&r.childrens.forEach((e=>{t.push(e)}));const s=[],i=e.termSetId.toString().toLowerCase();this.termSets.state[i]&&this.termSets.state[i].terms?t.forEach((e=>{this.termSets.state[i].terms[e.id.toString().toLowerCase()]||s.push(this.parseToTermData(e))})):t.forEach((e=>{s.push(this.parseToTermData(e))})),this.privateMutations.updateTerms(s)}t(r)})).catch(r)}))))}}onActivated(){}onDisposing(){}parseToTermData(e){if(e&&e.labels){const t=JSON.parse(JSON.stringify(e.labels));e.labels={},t&&t.length>0&&t.forEach((t=>{e.labels[t.lcid.toString()]||(e.labels[t.lcid.toString()]={lcid:t.lcid,label:t.label,name:t.name})}))}return e}parseTermDataWithLCID(e,t){return t?Object.assign({},e,{name:this.getTermTitleByLCID(e,t)}):e}getTermTitleByLCID(e,t){if(!e)return"";if(e.labels){const r=e.labels[t];return r&&r.label?r.label:e.name}return e.name}getTermTitleByLanguageName(e,t){let r="";if(e.labels){let s=null;for(const r of Object.keys(e.labels))if(e.labels[r].name==t){s=e.labels[r];break}s&&(r=s.label)}return r}};m([(0,i.Inject)(n.TermService)],c.prototype,"termService",2),m([(0,i.Inject)(a.MultilingualStore)],c.prototype,"multilingualStore",2),m([(0,i.Inject)(o.OmniaContext)],c.prototype,"omniaContext",2),c=m([(0,i.Injectable)({onStartup:e=>{a.Store.register(e,s.InstanceLifetimes.Singelton)}})],c);var d=r("bf86b3f8-7274-47e4-9e27-87ae1cf65a23"),h=r("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"),u=Object.defineProperty,g=Object.getOwnPropertyDescriptor,f=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?g(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&u(t,r,a),a};let S=class extends a.Store{constructor(){super(...arguments),this.message=new h.MessageBusTopicMediator({namespace:"omnia.fx.messagebus",name:"ontermglossaryselected"},{caching:{size:1}}),this.omniaEnterpriseGlossaryMappingPropertyPrefix="omniaEnterpriseGlossary",this.events={onTermGlossarySelected:()=>this.message},this.getters={getEnterpriseGlossaryTermMapping:(e,t)=>new d.EnterpriseGlossaryTermInformation(this.spTermStore.getters.getDisplayTermByLanguage(this.spTermStore.getters.getDisplayLCID(),e.termSetId,e.id),e,t,((e,t,r)=>this.actions.setMapping.dispatch(t,e,r))),getCustomGlossaryName:e=>`${this.omniaEnterpriseGlossaryMappingPropertyPrefix}${e}`,isTermMapped:e=>{const t=this.getters.enterpriseGlossaryTermData(e)?.mappingPropertyNames;return!!(t&&t.length>0)},enterpriseGlossaryTermData:e=>{const t=e.customProperties?.omniaEnterpriseGlossaryTermData;let r=null;if(t){const e=JSON.parse(t);this.tenantEnterpriseGlossaryPropertyBag?.ids&&this.tenantEnterpriseGlossaryPropertyBag?.ids.find((t=>t==e.enterpriseGlossaryInstanceId))&&(r=e)}return r},termMappingObject:e=>{const t={},r=this.getters.enterpriseGlossaryTermData(e);return r&&r.mappingPropertyNames&&r.mappingPropertyNames.forEach((r=>{const s=this.getMappingPropertyName(r);if(s){const i=e.customProperties[r];try{t[s]=JSON.parse(i)}catch(e){t[s]=i}}})),t}},this.mutations={},this.actions={setTermGlossarySelected:this.action((e=>new Promise(((t,r)=>{const s=this.getters.enterpriseGlossaryTermData(e);s&&this.enterpriseGlossaryStore.actions.ensureEnterpriseGlossary.dispatch(s.enterpriseGlossaryInstanceId).then((()=>{const i=this.enterpriseGlossaryStore.getters.enterpriseGlossary(s.enterpriseGlossaryInstanceId);i?this.enterpriseGlossaryStore.actions.triggerEnterpriseGlossaryInformation.dispatch(i,new d.EnterpriseGlossaryTermInformation(this.spTermStore.getters.getDisplayTermByLanguage(this.spTermStore.getters.getDisplayLCID(),e.termSetId,e.id),e,i,null)).then(t,r):(console.error(`Not found enterprise glossary instance with id ${s.enterpriseGlossaryInstanceId}`),t())}))})))),setMapping:this.action(((e,t,r)=>new Promise(((i,a)=>{const n={},o=[];Object.keys(t).forEach((e=>{const r=this.getTermCustomPropertyName(e);n[r]=t[e]?JSON.stringify(t[e]):"",o.push(r)}));const l=this.initTermDataIfNeeded(e,r);l.mappingPropertyNames=o,n.omniaEnterpriseGlossaryTermData=JSON.stringify(l),Promise.all([this.spTermStore.actions.addOrUpdateTermCustomProperties.dispatch(e.id,n),this.enterpriseGlossaryStore.actions.addOrUpdateEnterpriseGlossaryMapping.dispatch({id:e.id,name:e.name,enterpriseGlossaryId:r.id,value:Object.assign({},t,{displayManifestId:s.OmniaWebComponentManifests.FxSpTermGlossaryMapping,termSetId:e.termSetId})})]).then((()=>i())).catch(a)})))),removeMapping:this.action((e=>new Promise(((t,r)=>{const s=this.getters.enterpriseGlossaryTermData(e);s.mappingPropertyNames=[];const i=s.mappingPropertyNames,a=this.checkIfTermDataHasValue(s);a||i.push(this.getEnterpriseGlossaryTermDataPropertyName()),Promise.all([this.spTermStore.actions.removeTermCustomProperties.dispatch(e.id,i),this.enterpriseGlossaryStore.actions.removeEnterpriseGlossaryMappings.dispatch([e.id])]).then((()=>{a&&this.spTermStore.actions.addOrUpdateTermCustomProperties.dispatch(e.id,{omniaEnterpriseGlossaryTermData:JSON.stringify(s)}).then((()=>{t()})).catch(r)})).catch(r)})))),setUISettings:this.action(((e,t,r)=>new Promise(((s,i)=>{const a=this.initTermDataIfNeeded(e,r);a.uiSettings=t;const n={omniaEnterpriseGlossaryTermData:JSON.stringify(a)};this.spTermStore.actions.addOrUpdateTermCustomProperties.dispatch(e.id,n).then((()=>{s()})).catch(i)})))),removeUISettings:this.action((e=>new Promise(((t,r)=>{const s=this.getters.enterpriseGlossaryTermData(e);if(s){s.uiSettings=null;if(this.checkIfTermDataHasValue(s)){const i={omniaEnterpriseGlossaryTermData:JSON.stringify(s)};this.spTermStore.actions.addOrUpdateTermCustomProperties.dispatch(e.id,i).then((()=>{t()})).catch(r)}else this.spTermStore.actions.removeTermCustomProperties.dispatch(e.id,[this.getEnterpriseGlossaryTermDataPropertyName()]).then((()=>{t()})).catch(r)}else t()}))))}}onActivated(){this.tenantEnterpriseGlossaryPropertyBag=this.omniaContext.tenant.propertyBag.getModel(s.TenantEnterpriseGlossary)}onDisposing(){}getTermCustomPropertyName(e){return`${this.omniaEnterpriseGlossaryMappingPropertyPrefix}${e}`}getMappingPropertyName(e){const t=e.replace(this.omniaEnterpriseGlossaryMappingPropertyPrefix,"");return t.length!=e.length?t:null}initTermDataIfNeeded(e,t){let r=this.getters.enterpriseGlossaryTermData(e);return r&&r.enterpriseGlossaryInstanceId==t.id||(r={enterpriseGlossaryInstanceId:t.id,uiSettings:null,mappingPropertyNames:null}),r}getEnterpriseGlossaryTermDataPropertyName(){return Object.keys({omniaEnterpriseGlossaryTermData:null})[0]}checkIfTermDataHasValue(e){return e.enterpriseGlossaryInstanceId&&(e.mappingPropertyNames&&e.mappingPropertyNames.length>0||e.uiSettings)}};f([(0,h.Inject)(h.OmniaContext)],S.prototype,"omniaContext",2),f([(0,h.Inject)(a.EnterpriseGlossaryStore)],S.prototype,"enterpriseGlossaryStore",2),f([(0,h.Inject)(c)],S.prototype,"spTermStore",2),S=f([(0,h.Injectable)({onStartup:e=>{a.Store.register(e,s.InstanceLifetimes.Singelton)}})],S);var y=Object.defineProperty,b=Object.getOwnPropertyDescriptor;const T={id:"TermNavigation.CurrentTerm",title:"$Localize:Omnia.Ux.Common.CurrentTerm;"};let P=class extends a.Store{constructor(){super(...arguments),this.currentTerms=this.state({}),this.getters={currentTerms:()=>({value:this.currentTerms.state,onMutated:this.currentTerms.onMutated})},this.mutations={navigateToTerm:this.mutation((e=>{this.currentTerms.mutate((t=>{e.termSetId?t.state[e.termSetId.toString()]=e:t.state[e.id.toString()]=e}))})),removeSelectedTerm:this.mutation((e=>{this.currentTerms.mutate((t=>{e.termSetId?t.state[e.termSetId.toString()]===e.id&&delete t.state[e.termSetId.toString()]:delete t.state[e.id.toString()]}))}))}}onActivated(){}};P=((e,t,r,s)=>{for(var i,a=s>1?void 0:s?b(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&y(t,r,a),a})([(0,h.Injectable)({onStartup:e=>{a.Store.register(e,s.InstanceLifetimes.Singelton)}})],P);var v=Object.defineProperty,I=Object.getOwnPropertyDescriptor,x=(e,t,r,s)=>{for(var i,a=s>1?void 0:s?I(t,r):t,n=e.length-1;n>=0;n--)(i=e[n])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&v(t,r,a),a};let C=class extends a.Store{constructor(){super(...arguments),this.helperData={targetingPropertiesDictById:{},availablePropertiesDictByInternalName:{},userPropertyTerms:{}}}parseByPolicy(e,t,r,s){const i={prefix:t,suffix:r,value:e,existingBlockedWord:"",appliedAffix:!1};i.value.startsWith(t)?i.value=i.value.substr(t.length):i.appliedAffix=!0,i.value.endsWith(r)?i.value=i.value.substr(0,i.value.length-r.length):i.appliedAffix=!0;const a=i.prefix+i.value+i.suffix;return i.existingBlockedWord=this.getExistingBlockWord(a,s),i}getExistingBlockWord(e,t){e=e?.toLowerCase()||"";return t.find((t=>(t=t.toLowerCase(),!!(e===t||e.startsWith(t+" ")||e.endsWith(" "+t)||e.indexOf(" "+t+" ")>-1))))||null}getAppAffixDefinitionValues(e,t){const r={},i=[],a=[...t.definition.prefixes.filter((e=>e.type===s.AffixType.App)),...t.definition.suffixes.filter((e=>e.type===s.AffixType.App))];for(const t of a)if(!r[t.enterprisePropertyInternalName]){r[t.enterprisePropertyInternalName]=!0;const a=this.helperData.availablePropertiesDictByInternalName[t.enterprisePropertyInternalName];if(a.enterprisePropertyDataType.indexedType===s.PropertyIndexedType.Taxonomy||a.enterprisePropertyDataType.indexedType===s.PropertyIndexedType.EnterpriseKeywords){const r=a?.settings?.termSetId;if(r){let s=[];e[t.enterprisePropertyInternalName]&&(s=[...e[t.enterprisePropertyInternalName]]),i.push({type:a.enterprisePropertyDataType.indexedType,internalName:t.enterprisePropertyInternalName,label:a.multilingualTitle,termsetId:r,termIds:s})}}else a.enterprisePropertyDataType.indexedType===s.PropertyIndexedType.Number&&i.push({type:a.enterprisePropertyDataType.indexedType,internalName:t.enterprisePropertyInternalName,label:a.multilingualTitle,numberValue:null})}return i}getAffixes(e,t){const r=this.getTitleAndAliasAffixValue(e.definition.prefixes,t),s=this.getTitleAndAliasAffixValue(e.definition.suffixes,t);return{aliasPrefix:r.aliasAffix,aliasSuffix:s.aliasAffix,titlePrefix:r.titleAffix,titleSuffix:s.titleAffix}}getTitleAndAliasAffixValue(e,t){let r="",a="";const n=this.getLcid();return e.forEach((e=>{const i=this.getAffixValue(e,n,t);e.scope===s.AffixScope.TitleAndAlias&&(r+=i),a+=i})),a=i.Utils.makeFriendlyUrl(a,!1),{titleAffix:r,aliasAffix:a}}getAffixValue(e,t,r){let i="";if(e.type===s.AffixType.Fixed){i=e.value}else if(e.type===s.AffixType.App){const a=e,n=this.helperData.availablePropertiesDictByInternalName[a.enterprisePropertyInternalName];if(n.enterprisePropertyDataType.indexedType===s.PropertyIndexedType.Taxonomy||n.enterprisePropertyDataType.indexedType===s.PropertyIndexedType.EnterpriseKeywords){const e=r.find((e=>e.internalName===a.enterprisePropertyInternalName));if(e?.termIds.length>0){const r=n.settings.termSetId,s=e.termIds[0],a=this.termStore.getters.getTermById(r,s,t);a&&(i=a.name)}}else n.enterprisePropertyDataType.indexedType===s.PropertyIndexedType.Number&&(i=r.find((e=>e.internalName===a.enterprisePropertyInternalName))?.numberValue)}else{const t=e;t.targetingPropertyId&&(i=this.helperData.userPropertyTerms[t.targetingPropertyId.toString()])}return null==i?"":i}ensureReady(e){return new Promise(((t,r)=>{Promise.all([this.targetingPropertyStore.actions.ensureLoadData.dispatch(),this.targetingPropertyStore.actions.ensureUserTargetingResult.dispatch(),this.enterprisePropertyStore.actions.ensureLoadData.dispatch()]).then((()=>{const r=this.getLcid(),i={targetingPropertiesDictById:{},availablePropertiesDictByInternalName:{},userPropertyTerms:{}};this.targetingPropertyStore.getters.properties().forEach((e=>{i.targetingPropertiesDictById[e.id.toString()]=e}));const a=this.enterprisePropertyStore.getters.enterprisePropertyDefinitionsByIndexedTypes([s.PropertyIndexedType.Taxonomy,s.PropertyIndexedType.EnterpriseKeywords,s.PropertyIndexedType.Number]);i.availablePropertiesDictByInternalName={},a.forEach((e=>{i.availablePropertiesDictByInternalName[e.internalName]=e}));const n=[],o=this.targetingPropertyStore.targetingPropertyResult.state;Object.keys(o).forEach((e=>{const t=o[e].targetingPropertyValues;if(t){const s=o[e].internalName,a=i.availablePropertiesDictByInternalName[s];Object.keys(t).forEach((e=>{if(t[e]?.[0]?.id){const s=t[e][0].id,o=a.settings.termSetId;n.push(this.termStore.actions.ensureTermByIds.dispatch(o,[s],r).then((([t])=>{t&&(i.userPropertyTerms[e]=t.name)})))}}))}})),e&&Object.keys(e.enterpriseProperties).forEach((t=>{const s=i.availablePropertiesDictByInternalName[t],a=e.enterpriseProperties[t];if(s&&Array.isArray(a)&&a.length>0){const e=s.settings.termSetId;n.push(this.termStore.actions.ensureTermByIds.dispatch(e,a,r))}})),Promise.all(n).then((()=>{this.helperData=i,t()}))}))}))}getLcid(){let e=null;const t=this.multilingualStore.getters.languageSetting(s.MultilingualScopes.BusinessProfile);if(t.availableLanguages.length>0){const r=t.availableLanguages.find((e=>e.name==t.userPreferredLanguageTag.toLowerCase()));r&&(e=r.lcid)}return e}onActivated(){}};x([(0,i.Inject)(a.TargetingPropertyStore)],C.prototype,"targetingPropertyStore",2),x([(0,i.Inject)(a.EnterprisePropertyStore)],C.prototype,"enterprisePropertyStore",2),x([(0,i.Inject)(c)],C.prototype,"termStore",2),x([(0,i.Inject)(a.MultilingualStore)],C.prototype,"multilingualStore",2),C=x([(0,h.Injectable)({onStartup:e=>{a.Store.register(e,s.InstanceLifetimes.Scoped)}})],C)},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,r)=>{e.exports=r("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5326a8ef-4e3c-49d6-b415-1ddf7fdcc830":(e,t,r)=>{e.exports=r("dll-reference md8")("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,r)=>{e.exports=r("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"85942510-7199-4382-9e25-082d1ebc7ab0":(e,t,r)=>{e.exports=r("dll-reference md19")("85942510-7199-4382-9e25-082d1ebc7ab0")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,r)=>{e.exports=r("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"bf86b3f8-7274-47e4-9e27-87ae1cf65a23":(e,t,r)=>{e.exports=r("dll-reference md19")("bf86b3f8-7274-47e4-9e27-87ae1cf65a23")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,r)=>{e.exports=r("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,r)=>{e.exports=r("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md19":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["93b0c582-b7e3-4b47-9b22-4412bd7df9e5"]},"dll-reference md8":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a1602121-3070-4304-b4d8-0859e50c482b"]},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"])throw new Error("Error, already loaded manifest fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"]=r;var t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r("eff19cad-5557-434b-a477-1e1e2a70a2a0"),r("./client/fx/sp/stores/index.js"),r("./client/fx/sp/services/index.js"),r("./client/fx/sp/services/listsservice.js"),r("./client/fx/sp/services/principalservice.js"),r("./client/fx/sp/services/siteservice.js"),r("./client/fx/sp/services/termservice.js");r("./client/fx/sp/services/userservice.js")})()};