if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["8000658f-9650-4040-b619-4f7e887665a7"])throw new Error("Error, already loaded manifest 8000658f-9650-4040-b619-4f7e887665a7 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["8000658f-9650-4040-b619-4f7e887665a7"]=function(){(()=>{var e={"./client/fx/sp/ux/queryfilterbuilder/queryfilterbuilder.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{QueryFilterBuilder:()=>I});var a,o=r("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),i=r("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),n=r("./node_modules/vue-property-decorator/lib/vue-property-decorator.js");(a||(a={})).namespace="Omnia.Ux.QueryFilterBuilder";var s=r("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),l=r("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","8000658f-9650-4040-b619-4f7e887665a7"),d=r("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","8000658f-9650-4040-b619-4f7e887665a7"),p=r("5e618f4d-d014-414e-a681-89e34cbeda0f"),b=r("eff19cad-5557-434b-a477-1e1e2a70a2a0"),u=Object.defineProperty,c=Object.getOwnPropertyDescriptor,y=(e,t,r,a)=>{for(var o,i=a>1?void 0:a?c(t,r):t,n=e.length-1;n>=0;n--)(o=e[n])&&(i=(a?o(t,r,i):o(i))||i);return a&&i&&u(t,r,i),i};const h="7667bdd4-7995-4536-b3e9-bacb829d6f5e",m="a7ad0d68-0fec-44ab-b468-028e718dbffc",f="f27cdaac-fd29-4552-bd56-72cd2f6fb3f1",v="8a96e2a9-963d-47fe-b0d8-851fbf948e33",T="786bfddc-df08-4441-b1ce-ec0730af8113",g="c65cc969-4f63-41bf-9956-f6e2c843b196";let I=class extends l.VueComponentBase{constructor(){super(...arguments),this.taxonomyPropertySettings={},this.internalQueryFilters=[],this.booleanFilterOptions=[{title:this.loc.BooleanFilterOption.Yes,value:"true"},{title:this.loc.BooleanFilterOption.No,value:"false"}],this.keywordTermSetId="",this.availableDataTypeIds=[h,f,g,T,v,m],this.availableProperties=[],this.modelJson=""}onValueBindChanged(){const e=this.valueBind?JSON.stringify(this.valueBind):"";e!==this.modelJson&&(this.modelJson=e,this.init())}mounted(){d.WebComponentBootstrapper.registerElementInstance(this,this.$el)}created(){this.modelJson=this.valueBind?JSON.stringify(this.valueBind):"",this.init()}init(){this.termStore.actions.ensurekeywordTermSet.dispatch().then((e=>{this.keywordTermSetId=e.id.toString()})),this.propertyStore.actions.ensureLoadData.dispatch().then((()=>{this.propertyStore.getters.enterprisePropertyDefinitionsByIndexedTypes([s.PropertyIndexedType.Taxonomy]).forEach((e=>{this.$set(this.taxonomyPropertySettings,e.internalName,e.settings)})),this.availableProperties=this.propertyStore.getters.enterprisePropertyDefinitions().filter((e=>{const t=e.enterprisePropertyDataTypeId.toString();return this.availableDataTypeIds.indexOf(t)>=0})),this.ensureInternalQueryFilters()})),this.dialogTheme=this.themeStore.getters.getThemingByTargetIdWithFallback(s.Constants.ux.themeTargetIds.editor)}ensureInternalQueryFilters(){this.internalQueryFilters=[],this.valueBind&&this.valueBind.forEach((e=>{const t=this.availableProperties.find((t=>t.internalName===e.propertyName));if(t){const r=d.Utils.clone(e);r.uniqueId=d.Utils.generateGuid(),r.dataTypeId=t.enterprisePropertyDataTypeId.toString(),t.enterprisePropertyDataTypeId===h?r.inputValue=e.propertyValues&&e.propertyValues[0]||"":t.enterprisePropertyDataTypeId===m?r.inputValue=e.propertyValues&&!1===isNaN(e.propertyValues[0])?parseInt(e.propertyValues[0]):0:t.enterprisePropertyDataTypeId===T||t.enterprisePropertyDataTypeId===g||t.enterprisePropertyDataTypeId===v?r.inputValue=e.propertyValues||[]:t.enterprisePropertyDataTypeId===f&&(r.inputValue=e.propertyValues&&e.propertyValues[0]||"false"),this.internalQueryFilters.push(r)}}))}onInternalQueryChanged(){const e=[];this.internalQueryFilters.forEach((t=>{if(t.propertyName){const r={logicalOperator:t.logicalOperator,operator:t.operator,propertyName:t.propertyName,propertyValues:[]};t.dataTypeId===h||t.dataTypeId===m?r.propertyValues=[t.inputValue]:t.dataTypeId===T||t.dataTypeId===g||t.dataTypeId===v?r.propertyValues=d.Utils.clone(t.inputValue):t.dataTypeId===f&&(r.propertyValues=[t.inputValue]),e.push(r)}})),this.modelJson=JSON.stringify(e),this.onValueChanged(e)}showNewQueryFilter(){this.internalQueryFilters.filter((e=>!e.propertyName))[0]||this.internalQueryFilters.push({uniqueId:d.Utils.generateGuid(),propertyName:"",logicalOperator:s.FilterLogicalOperator.And,propertyValues:[],operator:s.FilterOperator.Eq,inputValue:null,dataTypeId:""})}setDefaultInputValue(e){const t=this.availableProperties.find((t=>t.internalName===e.propertyName));e.dataTypeId=t.enterprisePropertyDataTypeId.toString(),t.enterprisePropertyDataTypeId===h?(e.inputValue="",e.operator=s.FilterOperator.Eq):t.enterprisePropertyDataTypeId===m?(e.inputValue=0,e.operator=s.FilterOperator.Eq):t.enterprisePropertyDataTypeId===T||t.enterprisePropertyDataTypeId===g||t.enterprisePropertyDataTypeId===v?(e.inputValue=[],e.operator=s.FilterOperator.In):t.enterprisePropertyDataTypeId===f&&(e.inputValue="false",e.operator=s.FilterOperator.Eq)}removeQueryFilter(e){this.internalQueryFilters=this.internalQueryFilters.filter((t=>t!==e)),this.onInternalQueryChanged()}renderTextFilter(e){return[(0,o.h)("v-col",{attrs:{cols:"1"},class:"text-center"},[(0,o.h)("span",["="])]),(0,o.h)("v-col",{attrs:{cols:"5"}},[(0,o.h)("v-text-field",{attrs:{"hide-details":!0,filled:!0,type:"text"},on:{change:t=>{e.inputValue=t,this.onInternalQueryChanged()}},model:{value:e.inputValue,callback:t=>{this.$set(e,"inputValue",t)}}})])]}renderNumberFilter(e){return[(0,o.h)("v-col",{attrs:{cols:"1"},class:"text-center"},[(0,o.h)("span",["="])]),(0,o.h)("v-col",{attrs:{cols:"5"}},[(0,o.h)("v-text-field",{attrs:{"hide-details":!0,filled:!0,type:"number"},on:{change:t=>{e.inputValue=t?parseInt(t):0,this.onInternalQueryChanged()}},model:{value:e.inputValue,callback:t=>{this.$set(e,"inputValue",t)}}})])]}renderBooleanFilter(e){return[(0,o.h)("v-col",{attrs:{cols:"1"},class:"text-center"},[(0,o.h)("span",["="])]),(0,o.h)("v-col",{attrs:{cols:"5"}},[(0,o.h)("v-select",{attrs:{"hide-details":!0,filled:!0,clearable:!0,"item-value":"value","item-text":"title",items:this.booleanFilterOptions},on:{change:t=>{e.inputValue=t,this.onInternalQueryChanged()}},model:{value:e.inputValue,callback:t=>{this.$set(e,"inputValue",t)}}})])]}renderPersonFilter(e){return[(0,o.h)("v-col",{attrs:{cols:"1"},class:"text-center"},[(0,o.h)("span",["="])]),(0,o.h)("v-col",{attrs:{cols:"5"}},[(0,o.h)("omfx-people-picker",{attrs:{multiple:!0,label:" ",hideDetails:!0},domProps:{principalType:s.AzureAdObjectPrincipalTypes.MemberAndGuest,valueBind:e.inputValue,onValueChanged:t=>{e.inputValue=t,this.onInternalQueryChanged()}}})])]}renderTaxonomyFilter(e){let t="";if(e.dataTypeId===g)t=this.keywordTermSetId;else{t=this.taxonomyPropertySettings[e.propertyName].termSetId}return[(0,o.h)("v-col",{attrs:{cols:"1"},class:"text-center"},[(0,o.h)("span",["="])]),(0,o.h)("v-col",{attrs:{cols:"5"}},[(0,o.h)("omfx-term-picker",{attrs:{hideDetails:!0,multi:!0,includeDeprecated:!0},domProps:{termSetId:t,preSelectedTermIds:e.inputValue,onTermsSelected:t=>{e.inputValue=t,this.onInternalQueryChanged()}}})])]}renderDeleteButton(e){return(0,o.h)("v-col",{attrs:{cols:"1"}},[(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.removeQueryFilter(e)},preset:l.ButtonPresets.base.smallIcon,icon:{iconType:new s.FontAwesomeIcon("delete")}},attrs:{dark:this.theming.body.bg.dark}})])}renderPropertySelection(e){return[(0,o.h)("omfx-enterpriseproperty-picker",{attrs:{hideDetails:!0,filled:!0,label:this.loc.Common.SelectProperty,dark:this.dialogTheme.body.bg.dark},domProps:{propertyItems:this.availableProperties,preSelectedPropertyInternalName:e.propertyName,onChange:t=>{e.propertyName=t,this.setDefaultInputValue(e)}}})]}renderFilterByType(e){return e.dataTypeId===h?this.renderTextFilter(e):e.dataTypeId===m?this.renderNumberFilter(e):e.dataTypeId===f?this.renderBooleanFilter(e):e.dataTypeId===v?this.renderPersonFilter(e):e.dataTypeId===T||e.dataTypeId===g?this.renderTaxonomyFilter(e):null}render(){return(0,o.h)("v-container",{attrs:{fluid:!0},class:"pa-0"},[this.internalQueryFilters.map((e=>(0,o.h)("v-row",{attrs:{dense:!0,align:"center"}},[(0,o.h)("v-col",{attrs:{cols:"5"}},[this.renderPropertySelection(e)]),e.propertyName?[this.renderFilterByType(e),this.renderDeleteButton(e)]:null]))),(0,o.h)("v-row",[(0,o.h)("v-col",[(0,o.h)("omfx-button",{domProps:{onClick:()=>{this.showNewQueryFilter()},styles:{bgColor:this.dialogTheme.body.fg.color.base,textColor:this.dialogTheme.body.fg.text.color.base},mode:s.ButtonModes.raised},attrs:{dark:this.dialogTheme.body.bg.dark,text:this.loc.Button.Add}})])])])}};y([(0,n.Prop)()],I.prototype,"valueBind",2),y([(0,n.Prop)()],I.prototype,"onValueChanged",2),y([(0,d.Inject)(l.ThemeStore)],I.prototype,"themeStore",2),y([(0,d.Inject)(p.EnterprisePropertyStore)],I.prototype,"propertyStore",2),y([(0,d.Inject)(b.TermStore)],I.prototype,"termStore",2),y([(0,d.Localize)(a.namespace)],I.prototype,"loc",2),y([(0,n.Watch)("valueBind",{deep:!0})],I.prototype,"onValueBindChanged",1),I=y([i.default],I),d.WebComponentBootstrapper.registerElement((e=>{(0,d.vueCustomElement)(e.elementName,I)}))},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,r)=>{e.exports=r("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,r)=>{e.exports=r("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,r)=>{e.exports=r("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,r)=>{e.exports=r("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,r)=>{e.exports=r("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"eff19cad-5557-434b-a477-1e1e2a70a2a0":(e,t,r)=>{e.exports=r("dll-reference md20")("eff19cad-5557-434b-a477-1e1e2a70a2a0")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]},"dll-reference md20":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["fa502cf2-bcf9-4dc0-b4f9-13dc63c04bfc"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["8000658f-9650-4040-b619-4f7e887665a7"])throw new Error("Error, already loaded manifest 8000658f-9650-4040-b619-4f7e887665a7 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["8000658f-9650-4040-b619-4f7e887665a7"]=r;var t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};r("./client/fx/sp/ux/queryfilterbuilder/queryfilterbuilder.tsx")})()};