if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88"])throw new Error("Error, already loaded manifest aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88 with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88"]=function(){(()=>{var e={"./client/fx/ux/profilecard/aboutuser/aboutuser.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AboutUserComponent:()=>v});var o,r=s("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs"),a=s("14a8d443-2e58-450b-a462-258bdaf69b49").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88"),i=s("./node_modules/vue-class-component/dist/vue-class-component.esm.js"),n=s("d7327742-5647-4075-b7ab-4f9ca852addb").setCurrentManifest("bb000000-0000-bbbb-0000-0000000000bb","aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88"),l=s("./node_modules/vue-property-decorator/lib/vue-property-decorator.js"),b=s("d0a145a7-d1ef-4217-aa6f-85dd18c4231d");(o||(o={})).namespace="Omnia.Ux.AboutUser";var d=s("./node_modules/csx/lib.es2015/index.js");n.StyleFlow.define(n.AboutUserStyles,{itemHeader:{fontSize:"12px",color:"rgba(0,0,0,.54)"},item:{fontSize:"12px",fontWeight:500,color:"rgba(0, 0, 0, 0.87)"},orgStructureItem:(e="0")=>({fontSize:"12px",fontWeight:500,lineHeight:1.4,display:"block",paddingLeft:e,color:"rgba(0, 0, 0, 0.87)"}),aboutMeHeader:{fontSize:(0,d.important)("16px"),color:"rgba(0,0,0,0.87)"},aboutMeText:{color:"rgba(0, 0, 0, 0.87)",fontSize:(0,d.important)("14px")},lastSectionHeader:{color:"rgba(0,0,0,.54)",paddingLeft:"5px"},hover:{$nest:{"&:hover":{backgroundColor:"rgba(0,0,0,0.1)"}}}});var c=s("5e618f4d-d014-414e-a681-89e34cbeda0f"),p=s("./node_modules/dayjs/dayjs.min.js"),h=s.n(p),m=s("eebfcd2f-b987-4725-8165-2955befcf8e1"),u=s("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac"),f=Object.defineProperty,y=Object.getOwnPropertyDescriptor,g=(e,t,s,o)=>{for(var r,a=o>1?void 0:o?y(t,s):t,i=e.length-1;i>=0;i--)(r=e[i])&&(a=(o?r(t,s,a):r(a))||a);return o&&a&&f(t,s,a),a};let v=class extends n.VueComponentBase{constructor(){super(...arguments),this.aboutUserStyles=n.StyleFlow.use(n.AboutUserStyles),this.currentUserBirthday=null,this.isLoading=!1,this.userLoginInternal=null}loginWatch(e){this.userLoginInternal!==this.userName&&this.initComponent()}created(){this.initComponent()}beforeDestroy(){}mounted(){a.WebComponentBootstrapper.registerElementInstance(this,this.$el)}initComponent(){this.isLoading=!1,this.userLoginInternal=this.userName,this.userLoginInternal&&(this.isLoading=!0,Promise.all([this.profileCardStore.actions.loadUserProperties.dispatch(this.userLoginInternal),this.azureAdService.getCurrentUserBirthday(this.userLoginInternal)]).then((e=>{this.currentUserBirthday=e[1],this.isLoading=!1})))}sendMessageInTeams(e,t){t&&this.executeDeeplink(e,b.Constants.microsoftTeamsDeepLinkApi.chatBaseUrl+encodeURIComponent(t.userName))}callUserInTeams(e,t){t&&this.executeDeeplink(e,b.Constants.microsoftTeamsDeepLinkApi.makeAudioCallBaseUrl+encodeURIComponent(t.userName))}executeDeeplink(e,t){m.MicrosoftTeamsSdkLoader.runningInMicrosoftTeams()&&(e.stopPropagation(),e.preventDefault(),m.MicrosoftTeamsSdkLoader.getApi().then((e=>{e.initialize(),e.executeDeepLink(t)})))}getContactProperties(e){const t=[];return e&&(e.workEmail&&t.push({icon:"ms-Icon ms-Icon--Mail",propertyTitle:this.loc.emailLabel,propertyValueRenderer:()=>(0,r.h)("a",{attrs:{href:this.getMailToLink(e)},class:[this.aboutUserStyles.item,"pt-2",this.theming.body.text.csslighter3]},[e.workEmail])}),e.sipAddress?t.push({icon:"ms-Icon ms-Icon--Chat",propertyTitle:this.loc.chatLabel,propertyValueRenderer:()=>(0,r.h)("a",{attrs:{href:this.getChatLink(e)},on:{click:t=>{this.sendMessageInTeams(t,e)}},class:[this.aboutUserStyles.item,"pt-2",this.theming.body.text.csslighter3]},[e.sipAddress])}):e.workEmail&&t.push({icon:"ms-Icon ms-Icon--Chat",propertyTitle:this.loc.chatLabel,propertyValueRenderer:()=>(0,r.h)("a",{attrs:{href:this.getChatLink(e)},on:{click:t=>{this.sendMessageInTeams(t,e)}},class:[this.aboutUserStyles.item,"pt-2",this.theming.body.text.csslighter3]},[e.workEmail])}),e.workPhone&&t.push({icon:"ms-Icon ms-Icon--Phone",propertyTitle:this.loc.workPhoneLabel,propertyValueRenderer:()=>(0,r.h)("a",{attrs:{href:this.getTelLink(e)},on:{click:t=>{this.callUserInTeams(t,e)}},class:[this.aboutUserStyles.item,"pt-2",this.theming.body.text.csslighter3]},[e.workPhone])}),e.cellPhone&&t.push({icon:"ms-Icon ms-Icon--Phone",propertyTitle:this.loc.cellPhoneLabel,propertyValueRenderer:()=>(0,r.h)("a",{attrs:{href:this.getTelLinkCell(e)},on:{click:t=>{this.callUserInTeams(t,e)}},class:[this.aboutUserStyles.item,"pt-2",this.theming.body.text.csslighter3]},[e.cellPhone])}),e.office&&t.push({icon:"ms-Icon ms-Icon--POI",propertyTitle:this.loc.officeLocationlabel,propertyValueRenderer:()=>(0,r.h)("span",{class:[this.aboutUserStyles.item,"pt-2"]},[e.office])}),e.jobTitle&&t.push({icon:"ms-Icon ms-Icon--Contact",propertyTitle:this.loc.jobTitleLabel,propertyValueRenderer:()=>(0,r.h)("span",{class:[this.aboutUserStyles.item,"pt-2"]},[e.jobTitle])}),e.department&&t.push({icon:"ms-Icon ms-Icon--Group",propertyTitle:this.loc.DepartmentLabel,propertyValueRenderer:()=>(0,r.h)("span",{class:[this.aboutUserStyles.item,"pt-2"]},[e.department])}),(e.birthday||this.currentUserBirthday)&&(this.currentUserBirthday?t.push({icon:"ms-Icon ms-Icon--Balloons",propertyTitle:this.loc.BirthdayLabel,propertyValueRenderer:()=>(0,r.h)("span",{class:[this.aboutUserStyles.item,"pt-2"]},[this.getBirthDay(this.currentUserBirthday)])}):t.push({icon:"ms-Icon ms-Icon--Balloons",propertyTitle:this.loc.BirthdayLabel,propertyValueRenderer:()=>(0,r.h)("span",{class:[this.aboutUserStyles.item,"pt-2"]},[this.getBirthDay(e.birthday)])}))),t}getUserExperienceItems(e){const t=[];return e.pastProjects&&e.pastProjects.length>0&&t.push({title:this.loc.PastProjects,value:e.pastProjects}),e.schools&&e.schools.length>0&&t.push({title:this.loc.Schools,value:e.schools}),e.skills&&e.skills.length>0&&t.push({title:this.loc.SkillLabel,value:e.skills}),e.interests&&e.interests.length>0&&t.push({title:this.loc.Interests,value:e.interests}),t}getMailToLink(e){return"mailto:"+e.workEmail}getTelLink(e){return"tel:"+e.workPhone}getTelLinkCell(e){return"tel:"+e.cellPhone}getChatLink(e){return"sip:"+(e.sipAddress||e.workEmail)}getBirthDay(e){return e?h()(e).format("MMM DD"):""}render(){if(this.isLoading)return(0,r.h)("v-skeleton-loader",{class:"mx-auto",attrs:{type:"list-item-three-line"}});const e=this.profileCardStore.getters.getUserProperties(this.userLoginInternal),t=this.getContactProperties(e),s=this.getUserExperienceItems(e);return(0,r.h)("div",{class:"about-user-wrapper"},[e&&(0,r.h)("v-container",{class:"pa-0"},[t&&t.length>0&&(0,r.h)("v-row",{attrs:{"no-gutters":!0}},[t.map((e=>(0,r.h)("v-col",{attrs:{cols:"12",md:"4"},class:"pt-2"},[(0,r.h)("v-list-tile",{class:[this.aboutUserStyles.hover,"px-3"]},[(0,r.h)("omfx-icon",{domProps:{valueBind:new b.FabricIcon(e.icon),iconAttrs:{small:!0}}}),(0,r.h)("v-list-tile-content",{class:"ml-3"},[(0,r.h)("span",{class:this.aboutUserStyles.itemHeader},[e.propertyTitle]),e.propertyValueRenderer()])])])))]),e.aboutMe&&(0,r.h)("v-row",{attrs:{"no-gutters":!0},class:"pt-4"},[(0,r.h)("v-col",{attrs:{cols:"12"}},[(0,r.h)("h3",{class:[this.aboutUserStyles.aboutMeHeader,"pb-2"]},[this.loc.aboutMeLabel]),(0,r.h)("div",{class:this.aboutUserStyles.aboutMeText,domProps:{innerHTML:e.aboutMe}})])]),s&&s.length>0&&(0,r.h)("v-row",{attrs:{"no-gutters":!0}},[s.map((e=>(0,r.h)("v-col",{attrs:{cols:"12",md:"4"},class:"pt-2"},[(0,r.h)("span",{class:this.aboutUserStyles.itemHeader},[e.title]),(0,r.h)("ul",{class:"pt-1"},[e.value.map((e=>e&&(0,r.h)("li",{class:this.aboutUserStyles.item},[e])))])])))])])])}};g([(0,l.Prop)()],v.prototype,"userName",2),g([(0,a.Inject)(n.OmniaTheming)],v.prototype,"omniaTheming",2),g([(0,a.Localize)(o.namespace)],v.prototype,"loc",2),g([(0,a.Inject)(c.ProfileCardStore)],v.prototype,"profileCardStore",2),g([(0,a.Inject)(u.AzureAdService)],v.prototype,"azureAdService",2),g([(0,l.Watch)("userName")],v.prototype,"loginWatch",1),v=g([i.default],v),a.WebComponentBootstrapper.registerElement((e=>{(0,a.vueCustomElement)(e.elementName,v,{destroyTimeout:200})}))},"./node_modules/@vue/composition-api/dist/vue-composition-api.mjs":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/@vue/composition-api/dist/vue-composition-api.mjs")},"./node_modules/csx/lib.es2015/index.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/csx/lib.es2015/index.js")},"./node_modules/dayjs/dayjs.min.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/dayjs/dayjs.min.js")},"./node_modules/vue-class-component/dist/vue-class-component.esm.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-class-component/dist/vue-class-component.esm.js")},"./node_modules/vue-property-decorator/lib/vue-property-decorator.js":(e,t,s)=>{e.exports=s("dll-reference md2")("./node_modules/vue-property-decorator/lib/vue-property-decorator.js")},"14a8d443-2e58-450b-a462-258bdaf69b49":(e,t,s)=>{e.exports=s("dll-reference md10")("14a8d443-2e58-450b-a462-258bdaf69b49")},"5e618f4d-d014-414e-a681-89e34cbeda0f":(e,t,s)=>{e.exports=s("dll-reference md10")("5e618f4d-d014-414e-a681-89e34cbeda0f")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,s)=>{e.exports=s("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"d7327742-5647-4075-b7ab-4f9ca852addb":(e,t,s)=>{e.exports=s("dll-reference md66")("d7327742-5647-4075-b7ab-4f9ca852addb")},"e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac":(e,t,s)=>{e.exports=s("dll-reference md10")("e25b9dd8-6dd7-4437-8ddd-0b9fadba73ac")},"eebfcd2f-b987-4725-8165-2955befcf8e1":(e,t,s)=>{e.exports=s("dll-reference md13")("eebfcd2f-b987-4725-8165-2955befcf8e1")},"dll-reference md2":e=>{"use strict";e.exports=omniaVendor},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]},"dll-reference md10":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a5a89056-b5f5-475d-8518-a1f55090379d"]},"dll-reference md66":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["dee030cc-4ab3-4158-bb06-8049f5c67542"]},"dll-reference md13":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["ee16aba9-229e-43f0-8559-d913b3aa85d4"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88"])throw new Error("Error, already loaded manifest aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88 with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["aff8c3b6-8cbe-4d28-9f2f-1e5a079b2a88"]=s;var t={};function s(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,s),a.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};s("./client/fx/ux/profilecard/aboutuser/aboutuser.tsx")})()};