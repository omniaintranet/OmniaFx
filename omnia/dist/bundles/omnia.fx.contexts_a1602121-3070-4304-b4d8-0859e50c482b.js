if("undefined"==typeof omniaLoader&&(globalThis.omniaLoader={}),omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]=omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]||{},omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["a1602121-3070-4304-b4d8-0859e50c482b"])throw new Error("Error, already loaded manifest a1602121-3070-4304-b4d8-0859e50c482b with service id bb000000-0000-bbbb-0000-0000000000bb");omniaLoader["bb000000-0000-bbbb-0000-0000000000bb"]["a1602121-3070-4304-b4d8-0859e50c482b"]=function(){(()=>{var e={"./client/fx/contexts/contextprovidercollection.js":(e,t,n)=>{"use strict";n.r(t),n.d(t,{ContextProviderCollection:()=>r});const i=class{static get instance(){return i._Instance}};let r=i;r.registeredProviders=[],r._Instance=new class{constructor(e){this.registeredProviders=e,this.getContextHttpHeaders=()=>{const e=[];for(const t of this.registeredProviders)e.push(t.getContextHttpHeaders());return this.mergeHeaders(e)},this.getHttpHeaders=()=>{const e=[];for(const t of this.registeredProviders)e.push(t.getHttpHeaders());return this.mergeHeaders(e)},this.getSerializedContextRepresentation=()=>{const e={};for(const t of this.registeredProviders){const n=t.getProviderUniqueId();if(null!=e[n])throw new Error("Context provider id: "+n+" is not unique.");e[n]=t.getSerializeableContextRepresentation()}return new Promise(((t,n)=>{const i=[];for(const t in e)i.push(e[t]);Promise.all(i).then((i=>{const r={providerContextMap:{}};for(const t in e)e[t].then((e=>{r.providerContextMap[t]=e}));try{const e=JSON.stringify(r);t(e)}catch(e){n("Failed to serialize contexts: "+e.toString())}})).catch(n)}))},this.createFromContextRepresentation=e=>{const t=JSON.parse(e);if(!t.providerContextMap)throw new Error("Can't create context from json: "+e+", doesn't seems to have been produced by: getSerializedContextRepresentation");for(const e in t.providerContextMap){const n=this.getProviderById(e);if(null!=n)try{n.createFromContextRepresentation(t.providerContextMap[e])}catch(t){throw new Error("ContextProvider with id: "+e+" failed to createFromContextRepresentation")}}},this.shouldRetryHttpRequest=e=>new Promise(((t,n)=>{const i=[];for(const t of this.registeredProviders)i.push(t.shouldRetryHttpRequest(e));Promise.all(i).then((e=>{for(const n of e)if(!0===n){t(!0);break}t(!1)})).catch(n)})),this.getProviderById=e=>{let t=null;for(const n of this.registeredProviders)if(n.getProviderUniqueId()===e){t=n;break}return t}}mergeHeaders(e){return new Promise(((t,n)=>{const i={};Promise.all(e).then((e=>{for(const t of e)for(const e in t)null==i[e]?i[e]=t[e]:i[e]!==t[e]&&n("Two context providers are supplying header key: "+e+" with different values: "+i[e]+" and : "+t[e]);t(i)})).catch(n)}))}}(i.registeredProviders),r.registerProvider=e=>{null===i.getProviderById(e.getProviderUniqueId())&&i.registeredProviders.push(e)},r.getProviderById=e=>{let t=null;for(const n of i.registeredProviders)if(n.getProviderUniqueId()===e){t=n;break}return t}},"./client/fx/contexts/internalhttpplugins.js":(e,t,n)=>{"use strict";n.r(t);var i=n("./client/fx/contexts/contextprovidercollection.js"),r=n("b8d937e0-3fc3-4412-a469-92941b829cdb");r.HttpContextConfigPlugin.registerContextProviders(i.ContextProviderCollection.instance),r.HttpRetryPlugIn.registerRetryPlugin(new class{constructor(){this.checkResponse=(e,t)=>new Promise(((n,i)=>{r.HttpContextConfigPlugin.instance?r.HttpContextConfigPlugin.instance.shouldRetryHttpRequest(t).then((t=>{t?r.HttpContextConfigPlugin.instance.getHttpHeaders().then((t=>{Object.assign(e.params,t),r.HttpContextConfigPlugin.instance.getContextHttpHeaders().then((t=>{n(e)})).catch(i)})).catch(i):n(null)})).catch((e=>{i(e)})):n(e)}))}})},"5326a8ef-4e3c-49d6-b415-1ddf7fdcc830":(e,t,n)=>{"use strict";n.r(t),n.d(t,{ContextProviderCollection:()=>o.ContextProviderCollection,OmniaContext:()=>x,OmniaContextProvider:()=>f});var i=n("d0a145a7-d1ef-4217-aa6f-85dd18c4231d"),r=n("97786ea9-4861-48bd-8a57-eae9bbdb4892"),s=n("9a75501c-254b-46d1-9010-7b13681e06f4"),o=n("./client/fx/contexts/contextprovidercollection.js"),a=n("10407664-c0c5-438b-94b2-507d58d190af"),l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u=(e,t,n,i)=>{for(var r,s=i>1?void 0:i?c(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&l(t,n,s),s};const d=class{static ensureOmniaToken(){if(null!==this._ensureTokenPromise)return this._ensureTokenPromise;let e=!0;if(window.omnia?.enviroment?.backendRuntime===i.OmniaBackendRuntimes.M365)try{!_spPageContextInfo||_spPageContextInfo.aadUserId&&""!=_spPageContextInfo.aadUserId?_spPageContextInfo&&""!=_spPageContextInfo.aadUserId&&console.log(`Azure Ad user with id ${_spPageContextInfo.aadUserId}`):e=!1}catch{}return e||(console.log("User has empty '_spPageContextInfo.aadUserId' -> Skip ensureOmniaToken. All Omnia requests will be blocked"),this._ensureTokenPromise=new s.Future(((e,t)=>{}))),null!==this._ensureTokenPromise||(this._ensureTokenPromise=new s.Future(((e,t)=>{const n=window.omnia;if(n&&n.enviroment&&n.enviroment.isOmniaApp)e(null);else{const n=r.Cookies.get("OmniaTokenKey"),i=r.WebUtils.getQs("tempToken");i?d.getOmniaTokenKeyWithTempToken(i).then((e=>{r.Cookies.set("OmniaTokenKey",e,{expires:{days:1}}),window.location.href=r.WebUtils.removeParam("tempToken")})).catch((e=>{t(e)})):d.validateToken(e,t,n)}}))),this._ensureTokenPromise}static getOmniaTokenKeyWithTempToken(e){return new Promise(((t,n)=>{Zepto.ajax({url:r.ServiceLocator.getUrl(i.OmniaService.Id)+`/api/auth/token/otp/${e}`,type:"GET",success:e=>{e.success&&e.data?t(e.data):(r.Console.logError("Cannot get omnia token key: "+e.errorMessage),n("Cannot get omnia token key: "+e.errorMessage))},error:(e,t,i)=>{r.Console.logError("Cannot get omnia token key: "+(i?i.message:"")),n("Cannot get omnia token key: "+(i?i.message:""))}})}))}static validateToken(e,t,n=null){Zepto.ajax({url:r.ServiceLocator.getUrl(i.OmniaService.Id)+`/api/auth/validation/token?redirectUrl=${encodeURIComponent(window.location.href)}`,type:"GET",headers:n?{OmniaTokenKey:n}:null,xhrFields:{withCredentials:!n},success:n=>{try{if(n.success&&n.data)switch(n.data.token&&r.Cookies.set("OmniaTokenKey",r.Encoder.base64Encode(JSON.stringify(n.data.token)),{expires:{days:1}}),n.data.status){case i.AuthenticationValidationStatuses.Valid:r.Cookies.remove(d._disableAuthRedirectCookie),e();break;case i.AuthenticationValidationStatuses.NeedAuthentication:case i.AuthenticationValidationStatuses.TokenKeyRefreshed:if(n.data.authenticationUrl){const e=r.Cookies.get(d._disableAuthRedirectCookie);e&&e==n.data.status.toString()?t("Error processing token response: Redirect loop"):(r.Cookies.set(d._disableAuthRedirectCookie,n.data.status.toString(),{expires:{seconds:3600}}),window.location.href=n.data.authenticationUrl)}}else r.Console.logError(n.errorMessage),t("Error when validating token: "+n.errorMessage)}catch(e){t("Error processing token response: "+JSON.stringify(e))}},error:(e,n,i)=>{r.Console.logError("Error when validating token: "+(i?i.message:"")),t("Error when validating token: "+(i?i.message:""))}})}};let h=d;h._disableAuthRedirectCookie="OmniaDisableAuthRedirect",h._ensureTokenPromise=null,h.ensureOmniaToken();let p=null;class g{constructor(){this.env=null,this.tenantContext=null,this.userPromise=null,this.tokenContext=null,this.omniaTokenPromise=null,this.currentBusinessProfile=null,this.currentAppRoute=null,this.currentActivatedFeatures=[],this.contextChangedPublishSubscriber=null,this._theming=null,this.forceUpdateTheme=!1,this.onContextChanged=()=>new r.MessageBusExposeOnlySubscription(this.contextChangedPublishSubscriber),this.getMutableContext=()=>this,this.getContext=()=>this,this.businessProfileCreation=null,this.appRouteCreation=null,this.tenantCreation=null,this.getProviderUniqueId=()=>"7a0e194c-9f5e-4920-995a-5286dca5a8b6",this.getSerializeableContextRepresentation=()=>new Promise((e=>{this.tokens.omniaToken.then((()=>{e(this.getContext())}))})),this.createFromContextRepresentation=e=>{},this.getContextHttpHeaders=()=>new Promise(((e,t)=>{this.tokens.omniaToken.then((()=>{const n={},r=[];if(r.push(this.user),n.omniaLanguage=this.language,this.businessProfile)n[i.Parameters.BusinessProfileId]=this.businessProfile.id.toString();else{const e=new RegExp("/@businessprofile/[0-9a-fA-F]{8}[-]?([0-9a-fA-F]{4}[-]?){3}[0-9a-fA-F]{12}","i");if(e.test(location.pathname)){const t=e.exec(location.pathname)[0].substr("/@businessprofile/".length);n[i.Parameters.BusinessProfileId]=t}}this.appRoute&&this.appRoute.appInstance&&(n[i.Parameters.AppInstanceId]=this.appRoute.appInstance.id.toString()),Promise.all(r).then((t=>{e(n)})).catch(t)}))})),this.getHttpHeaders=()=>new Promise(((e,t)=>{this.tokens.omniaToken.then((()=>{const t={Lang:this.language};e(t)})).catch(t)})),this.shouldRetryHttpRequest=e=>new Promise((t=>{e||t(!1);(JSON.stringify(e)||"").toLowerCase().indexOf("error when creating omnia context")>-1?(this.clearOmniaTokenPromise(),t(!0)):t(!1)})),this.getOmniaState.businessProfile&&(this.currentBusinessProfile=this.getOmniaState.businessProfile),this.getOmniaState.appRoute&&(this.currentAppRoute=this.getOmniaState.appRoute),this.currentActivatedFeatures=this.getOmniaState.activatedFeatures||[];this.contextChangedPublishSubscriber=new r.MessageBusTopicMediator({namespace:"omnia.fx.contexts",name:"omniacontextchanged"}),a.InternalTopics.businessProfileUpdate.subscribe((e=>{const t=r.Utils.isNull(this.currentBusinessProfile)?null:JSON.stringify(this.currentBusinessProfile),n=r.Utils.isNull(e)?null:JSON.stringify(e);this.currentBusinessProfile?.id!==e?.id&&(this.currentAppRoute=null),n!==t&&(this.currentBusinessProfile=e,this.forceUpdateTheme=!0,r.Console.logDebug("Omnia context received new business profile: "+n+" old value: "+t),this.contextChangedPublishSubscriber.publish(this.getContext()))})),a.InternalTopics.appRouteUpdate.subscribe((e=>{const t=r.Utils.isNull(this.currentAppRoute)?null:JSON.stringify(this.currentAppRoute);(r.Utils.isNull(e)?null:JSON.stringify(e))!==t&&(this.currentAppRoute=e,this.contextChangedPublishSubscriber.publish(this.getContext()))})),a.InternalTopics.activatedFeaturesUpdate.subscribe((e=>{const t=r.Utils.isNull(this.currentActivatedFeatures)?[]:JSON.stringify(this.currentActivatedFeatures);(r.Utils.isNull(e)?[]:JSON.stringify(e))!==t&&(this.currentActivatedFeatures=e||[],this.contextChangedPublishSubscriber.publish(this.getContext()))}))}resolveOmniaToken(){this.ensureOmniaTokenPromise(),this.omniaTokenPromise.resolve(null)}get businessProfile(){let e=null;return this.currentBusinessProfile?(null!==this.businessProfileCreation&&this.businessProfileCreation.initialValue===this.currentBusinessProfile||(this.businessProfileCreation={initialValue:this.currentBusinessProfile,instance:r.IBusinessProfileFactory.create(this.currentBusinessProfile)}),e=this.businessProfileCreation.instance):this.businessProfileCreation=null,e}get appRoute(){let e=null;return this.currentAppRoute?(null!==this.appRouteCreation&&this.appRouteCreation.initialValue===this.currentAppRoute||(this.appRouteCreation={initialValue:this.currentAppRoute,instance:r.IAppRouteFactory.create(this.currentAppRoute)}),e=this.appRouteCreation.instance):this.appRouteCreation=null,e}get tenant(){return this.getOmniaState.tenant&&null===this.tenantCreation&&(this.tenantCreation={instance:r.ITenantFactory.create(this.getOmniaState.tenant)}),this.tenantCreation?this.tenantCreation.instance:null}get activatedFeatures(){return this.currentActivatedFeatures}get environment(){if(null==this.env){const e=window.omnia;this.env={get isOmniaApp(){return!!e.enviroment.isOmniaApp||e.enviroment.clientRuntime==i.OmniaClientRuntimes.OmniaApp},backendRuntime:e.enviroment.backendRuntime,clientRuntime:e.enviroment.clientRuntime}}return this.env}get theming(){if(null===this._theming||this.forceUpdateTheme){if(this._theming=null,this.currentBusinessProfile&&this.currentBusinessProfile.properties){const e=new i.BusinessProfileTheme,t=this.currentBusinessProfile.properties.find((t=>t.omniaServiceId.toString()===e.omniaServiceId.toString()&&t.uniqueModelName===e.uniqueModelName));t&&(this._theming={type:t.type,primary:t.primary,secondary:t.secondary,corporatecolors:null!=t.corporatecolors?t.corporatecolors:[]})}else if(this.businessProfile){const e=this.businessProfile.propertyBag.getModel(i.BusinessProfileTheme);e&&(this._theming={type:e.type,primary:e.primary,secondary:e.secondary,corporatecolors:null!=e.corporatecolors?e.corporatecolors:[]})}this.forceUpdateTheme=!1}const e=this._theming||{primary:"#1976D2",secondary:"#424242",corporatecolors:[],type:i.ThemeType.LightWithColorContrast};return e.primary=e.primary||"#1976D2",e.secondary=e.secondary||"#424242",e}get user(){return null==this.userPromise&&(this.userPromise=new Promise((e=>{if(this.getOmniaState.user&&(this.getOmniaState.user.uid||this.getOmniaState.user.userPrincipalName||this.getOmniaState.user.mailboxSettings)){const t=this.getOmniaState.user,n=t;n.propertyBag=r.UserPropertyBagFactory.create(t),e(n)}else e({uid:"anonymous",preferredLanguage:i.LanguageTags.EnUs,type:i.UserTypes.Anonymous,propertyBag:null,mail:"",displayName:""})}))),this.userPromise}get language(){return this.getOmniaState.language||"en-us"}get tokens(){return this.ensureOmniaTokenPromise(),{omniaToken:h.ensureOmniaToken()}}get customDomain(){return p.customDomain||null}get defaultDomain(){return p.defaultDomain}get routePrefixes(){return p.routePrefixes}clearOmniaTokenPromise(){this.omniaTokenPromise,this.ensureOmniaTokenPromise()}ensureOmniaTokenPromise(){null===this.omniaTokenPromise&&(this.omniaTokenPromise=new s.Future((e=>{})),this.tokenContext={omniaToken:this.omniaTokenPromise})}get getOmniaState(){return null!==p||(p=window.omnia),p}}const b=class{static get instance(){return null===b._instance&&(b._instance=new g),b._instance}};let m=b;m._instance=null,o.ContextProviderCollection.registerProvider(m.instance);let f=class{constructor(){this._fallbackProvider=m.instance,this._appRoute=null,this.onContextChanged=()=>this._fallbackProvider.onContextChanged(),this.getMutableContext=()=>this._fallbackProvider.getMutableContext(),this.getProviderUniqueId=()=>this._fallbackProvider.getProviderUniqueId(),this.getSerializeableContextRepresentation=()=>this._fallbackProvider.getSerializeableContextRepresentation(),this.createFromContextRepresentation=e=>{this._fallbackProvider.createFromContextRepresentation(e)},this.getContext=()=>this,this.getContextHttpHeaders=()=>new Promise(((e,t)=>{this._fallbackProvider.getContextHttpHeaders().then((t=>{this._appRoute?e(Object.assign({},t,{[i.Parameters.AppInstanceId]:this._appRoute.appInstance?this._appRoute.appInstance.id.toString():i.Guid.empty.toString()})):e(t)}))})),this.getHttpHeaders=()=>this._fallbackProvider.getHttpHeaders(),this.shouldRetryHttpRequest=e=>this._fallbackProvider.shouldRetryHttpRequest(e),this.updateAppContext=e=>{this._appRoute=r.IAppRouteFactory.create(e.appRouteWithProperties),this._activatedFeatures=e.activatedFeatures,a.InternalTopics.activatedFeaturesToLoadResource.publish(e.activatedFeatures)},this.id=r.Utils.generateGuid(),this.httpContextProviderCollection.registerProvider(this)}dispose(){}get language(){return this._fallbackProvider.language}get environment(){return this._fallbackProvider.environment}get businessProfile(){return this._fallbackProvider.businessProfile}get appRoute(){return this._appRoute||this._fallbackProvider.appRoute}get tenant(){return this._fallbackProvider.tenant}get theming(){return this._fallbackProvider.theming}get user(){return this._fallbackProvider.user}get tokens(){return this._fallbackProvider.tokens}get activatedFeatures(){return this._activatedFeatures||this._fallbackProvider.activatedFeatures}get customDomain(){return this._fallbackProvider.customDomain}get defaultDomain(){return this._fallbackProvider.defaultDomain}get routePrefixes(){return this._fallbackProvider.routePrefixes}};u([(0,r.Inject)(r.HttpContextProviderCollection)],f.prototype,"httpContextProviderCollection",2),f=u([(0,r.Injectable)({lifetime:i.InstanceLifetimes.Scoped,onDisposing:e=>e.dispose()})],f);var P=Object.defineProperty,v=Object.getOwnPropertyDescriptor,C=(e,t,n,i)=>{for(var r,s=i>1?void 0:i?v(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&P(t,n,s),s};let x=class{constructor(){this.ensureReflectRealInstance=()=>{},this.id=r.Utils.generateGuid()}dispose(){}get providerId(){return this.ensureReflectRealInstance(),this.provider.getProviderUniqueId()}onContextChanged(){return this.ensureReflectRealInstance(),this.provider.getMutableContext().onContextChanged()}get businessProfile(){return this.ensureReflectRealInstance(),this.provider.getContext().businessProfile}get appRoute(){return this.ensureReflectRealInstance(),this.provider.getContext().appRoute}get language(){return this.ensureReflectRealInstance(),this.provider.getContext().language}get environment(){return this.ensureReflectRealInstance(),this.provider.getContext().environment}get theming(){return this.ensureReflectRealInstance(),this.provider.getContext().theming}get user(){return this.ensureReflectRealInstance(),this.provider.getContext().user}get tokens(){return this.ensureReflectRealInstance(),this.provider.getContext().tokens}get tenant(){return this.ensureReflectRealInstance(),this.provider.getContext().tenant}get activatedFeatures(){return this.ensureReflectRealInstance(),this.provider.getContext().activatedFeatures}get customDomain(){return this.ensureReflectRealInstance(),this.provider.getContext().customDomain||null}get defaultDomain(){return this.ensureReflectRealInstance(),this.provider.getContext().defaultDomain}get routePrefixes(){return this.ensureReflectRealInstance(),this.provider.getContext().routePrefixes}};C([(0,r.Inject)(f)],x.prototype,"provider",2),x=C([(0,r.Injectable)({lifetime:i.InstanceLifetimes.Scoped,onDisposing:e=>e.dispose()})],x)}
//! <omnia-transform-resource path="5326a8ef-4e3c-49d6-b415-1ddf7fdcc830" />
,"10407664-c0c5-438b-94b2-507d58d190af":(e,t,n)=>{e.exports=n("dll-reference md9")("10407664-c0c5-438b-94b2-507d58d190af")},"97786ea9-4861-48bd-8a57-eae9bbdb4892":(e,t,n)=>{e.exports=n("dll-reference md9")("97786ea9-4861-48bd-8a57-eae9bbdb4892")},"9a75501c-254b-46d1-9010-7b13681e06f4":(e,t,n)=>{e.exports=n("dll-reference md18")("9a75501c-254b-46d1-9010-7b13681e06f4")},"b8d937e0-3fc3-4412-a469-92941b829cdb":(e,t,n)=>{e.exports=n("dll-reference md9")("b8d937e0-3fc3-4412-a469-92941b829cdb")},"d0a145a7-d1ef-4217-aa6f-85dd18c4231d":(e,t,n)=>{e.exports=n("dll-reference md9")("d0a145a7-d1ef-4217-aa6f-85dd18c4231d")},"dll-reference md18":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["6972ceca-544d-49c0-b575-67b1a5294812"]},"dll-reference md9":e=>{"use strict";e.exports=omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a2892051-fd9f-4056-ae8d-30d16d48417d"]}};if("undefined"==typeof omniaWebpackJsonp&&(globalThis.omniaWebpackJsonp={}),globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]=globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]||{},globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a1602121-3070-4304-b4d8-0859e50c482b"])throw new Error("Error, already loaded manifest a1602121-3070-4304-b4d8-0859e50c482b with service id bb000000-0000-bbbb-0000-0000000000bb");globalThis.omniaWebpackJsonp["bb000000-0000-bbbb-0000-0000000000bb"]["a1602121-3070-4304-b4d8-0859e50c482b"]=n;var t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n("5326a8ef-4e3c-49d6-b415-1ddf7fdcc830");n("./client/fx/contexts/internalhttpplugins.js")})()};