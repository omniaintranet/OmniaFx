import{_ as n,g as s}from"./app.a39ec552.js";const a={},t=s(`<h1 id="teamwork-app" tabindex="-1"><a class="header-anchor" href="#teamwork-app" aria-hidden="true">#</a> Teamwork App</h1><p>Install <code>Omnia.Workplace.Fx</code> nuget.</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">Omnia<span class="token punctuation">.</span>Fx<span class="token punctuation">.</span>Apps</span><span class="token punctuation">;</span>

<span class="token comment">//Inject IAppService </span>
<span class="token class-name">IAppService</span> AppService<span class="token punctuation">;</span>

<span class="token comment">//Then it is able to</span>

<span class="token comment">//- get a Teamwork by SharePoint site url</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetTeamworkAppAsync

<span class="token comment">//- create a new Teamwork and attach an existing SharePoint site to it.</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">AttachO365GroupAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">AttachSharePointTeamSiteAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">AttachSharePointCommunicationSiteAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">AttachYammerGroupAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AttachMicrosoftTeamAsync

<span class="token comment">//- create a new Teamwork </span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">CreateFacebookWorkplaceGroupAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">CreateYammerGroupAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">CreateMicrosoftTeamAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">CreateO365GroupAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">CreateSharePointTeamSiteAsync</span>
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CreateSharePointCommunicationSiteAsync


<span class="token comment">//To create a new Teamwork with its default enterprise properties, you can initialize the properties with EnterprisePropertyDictionary. For example:</span>
<span class="token class-name"><span class="token keyword">var</span></span> enterpriseProperties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EnterprisePropertyDictionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
enterpriseProperties
    <span class="token punctuation">.</span><span class="token function">AddOrUpdatePerson</span><span class="token punctuation">(</span>personProperty<span class="token punctuation">,</span> <span class="token string">&quot;user1@tenant.com&quot;</span> <span class="token punctuation">,</span> <span class="token string">&quot;user2@tenant.com&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateBoolean</span><span class="token punctuation">(</span>booleanProperty<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateDateTime</span><span class="token punctuation">(</span>dateTimeProperty<span class="token punctuation">,</span> DateTime<span class="token punctuation">.</span>UtcNow<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateEnterpriseKeywords</span><span class="token punctuation">(</span>keyWordProperty<span class="token punctuation">,</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateTaxonomy</span><span class="token punctuation">(</span>taxonomyProperty<span class="token punctuation">,</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateNumber</span><span class="token punctuation">(</span>numberProperty<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateTags</span><span class="token punctuation">(</span>tagProperty<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tag</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;TagA&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tag</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;TagB&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateText</span><span class="token punctuation">(</span>textProperty<span class="token punctuation">,</span> <span class="token string">&quot;Lorem ipsum dolor sit amet&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateRichText</span><span class="token punctuation">(</span>richTextProperty<span class="token punctuation">,</span> <span class="token string">&quot;&lt;p&gt;Lorem ipsum dolor sit amet&lt;/p&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//Or use the property internal name directly</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdatePerson</span><span class="token punctuation">(</span><span class="token string">&quot;personPropertyInternalName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user1@tenant.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user2@tenant.com&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateBoolean</span><span class="token punctuation">(</span><span class="token string">&quot;booleanPropertyInternalName&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateDateTime</span><span class="token punctuation">(</span><span class="token string">&quot;dateTimePropertyInternalName&quot;</span><span class="token punctuation">,</span> DateTime<span class="token punctuation">.</span>UtcNow<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateEnterpriseKeywords</span><span class="token punctuation">(</span><span class="token string">&quot;keywordPropertyInternalName&quot;</span><span class="token punctuation">,</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateTaxonomy</span><span class="token punctuation">(</span><span class="token string">&quot;taxonomyPropertyInternalName&quot;</span><span class="token punctuation">,</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateNumber</span><span class="token punctuation">(</span><span class="token string">&quot;numberPropertyInternalName&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateTags</span><span class="token punctuation">(</span><span class="token string">&quot;tagPropertyInternalName&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tag</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;TagA&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tag</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;TagB&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateText</span><span class="token punctuation">(</span><span class="token string">&quot;textPropertyInternalName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Lorem ipsum dolor sit amet&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddOrUpdateRichText</span><span class="token punctuation">(</span><span class="token string">&quot;richTextPropertyInternalName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Lorem ipsum dolor sit amet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">CreateO365GroupAsync</span><span class="token punctuation">(</span>
    <span class="token named-parameter punctuation">enterpriseProperties</span><span class="token punctuation">:</span> enterpriseProperties
<span class="token punctuation">)</span>
 
AppService<span class="token punctuation">.</span><span class="token function">WorkWithTeamwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AttachO365GroupAsync</span><span class="token punctuation">(</span>
    <span class="token named-parameter punctuation">enterpriseProperties</span><span class="token punctuation">:</span> enterpriseProperties
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="app-context-issues" tabindex="-1"><a class="header-anchor" href="#app-context-issues" aria-hidden="true">#</a> App Context issues</h2><ul><li><p>It is not supported to create O365 Group for now.</p></li><li><p>If your tenant is using System Account mode, make sure that the System Account&#39;s user is not used in teamwork&#39;s app instance admin. Otherwise, it might cause unexpected issues.</p></li></ul>`,5);function p(e,o){return t}var u=n(a,[["render",p],["__file","index.html.vue"]]);export{u as default};
